<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
  <head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet"  type="text/css" href="_ejs_library/css/ejss.css" />
    <script src="_ejs_library/scripts/common_script.js"></script>
    <script src="_ejs_library/scripts/textresizedetector.js"></script>
<script type="text/javascript"><!--//--><![CDATA[//><!--
function Matrix(){var e=Array.prototype.concat.apply([],arguments);e.length||(e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this.m=hasFloat32Array?new Float32Array(e):e}function Vector(e,t,r){"object"==typeof e?(this.x=e[0]||0,this.y=e[1]||0,this.z=e[2]||0):(this.x=e||0,this.y=t||0,this.z=r||0)}var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.AnalyticCurve={},EJSS_DRAWING2D.analyticCurve=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Arrow={NONE:0,ANGLE:1,CIRCLE:2,RECTANGLE:3,LINE:4,CURVE:5,TRIANGLE:6,DIAMOND:7,WEDGE:8,POINTED:9,INVANGLE:10,INVTRIANGLE:11,copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),t.setMarkEnd(e.getMarkEnd()),t.setMarkStart(e.getMarkStart())},registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Offset",e.setRelativePosition,e.getRelativePosition),t.registerProperty("MarkEnd",e.setMarkEnd),t.registerProperty("MarkEndWidth",e.setMarkEndWidth),t.registerProperty("MarkEndHeight",e.setMarkEndHeight),t.registerProperty("MarkEndDiameter",e.setMarkEndDiameter),t.registerProperty("MarkEndColor",e.setMarkEndColor),t.registerProperty("MarkEndStroke",e.setMarkEndStroke),t.registerProperty("MarkEndOrient",e.setMarkEndOrient),t.registerProperty("MarkStart",e.setMarkStart),t.registerProperty("MarkStartWidth",e.setMarkStartWidth),t.registerProperty("MarkStartHeight",e.setMarkStartHeight),t.registerProperty("MarkStartDiameter",e.setMarkStartDiameter),t.registerProperty("MarkStartColor",e.setMarkStartColor),t.registerProperty("MarkStartStroke",e.setMarkStartStroke),t.registerProperty("MarkStartOrient",e.setMarkStartOrient),t.registerProperty("MarkMiddle",e.setMarkMiddle),t.registerProperty("MarkMiddleWidth",e.setMarkMiddleWidth),t.registerProperty("MarkMiddleHeight",e.setMarkMiddleHeight),t.registerProperty("MarkMiddleDiameter",e.setMarkMiddleDiameter),t.registerProperty("MarkMiddleColor",e.setMarkMiddleColor),t.registerProperty("MarkMiddleColorSnd",e.setMarkMiddleColorSnd),t.registerProperty("MarkMiddleStroke",e.setMarkMiddleStroke),t.registerProperty("MarkMiddleOrient",e.setMarkMiddleOrient),t.registerProperty("MarkProportion",e.setMarkProportion)}},EJSS_DRAWING2D.arrow=function(e){var t=EJSS_DRAWING2D.element(e),r=.5,n=EJSS_DRAWING2D.Arrow.NONE,i="none",o=12,a=10,s=-1,l="auto",u=EJSS_DRAWING2D.Arrow.ANGLE,g="none",c=12,S=12,d=-1,f="auto",E=EJSS_DRAWING2D.Arrow.NONE,p="none",h="none",m=12,A=10,y=-1,v="auto";return t._23=function(){return"ElementArrow"},t.setMarkProportion=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getMarkProportion=function(){return r},t.setMarkStart=function(e){n="string"==typeof e?EJSS_DRAWING2D.Arrow[e.toUpperCase()]:e},t.getMarkStart=function(){return n},t.setMarkStartColor=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=i&&(i=e,t.setChanged(!0)),t},t.getMarkStartColor=function(){return i},t.setMarkStartStroke=function(e){s!=e&&(s=e,t.setChanged(!0))},t.getMarkStartStroke=function(){return s},t.setMarkStartWidth=function(e){o!=e&&(o=e,t.setChanged(!0))},t.getMarkStartWidth=function(){return o},t.setMarkStartHeight=function(e){a!=e&&(a=e,t.setChanged(!0))},t.getMarkStartHeight=function(){return a},t.setMarkStartDiameter=function(e){a==e&&o==e||(a=e,o=e,t.setChanged(!0))},t.getMarkStartOrient=function(){return l},t.setMarkStartOrient=function(e){l!=e&&(l=e,t.setChanged(!0))},t.setMarkEnd=function(e){u="string"==typeof e?EJSS_DRAWING2D.Arrow[e.toUpperCase()]:e},t.getMarkEnd=function(){return u},t.setMarkEndColor=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=g&&(g=e,t.setChanged(!0)),t},t.getMarkEndColor=function(){return g},t.setMarkEndStroke=function(e){d!=e&&(d=e,t.setChanged(!0))},t.getMarkEndStroke=function(){return d},t.setMarkEndWidth=function(e){c!=e&&(c=e,t.setChanged(!0))},t.getMarkEndWidth=function(){return c},t.setMarkEndHeight=function(e){S!=e&&(S=e,t.setChanged(!0))},t.getMarkEndHeight=function(){return S},t.setMarkEndDiameter=function(e){S==e&&c==e||(S=e,c=e,t.setChanged(!0))},t.getMarkEndOrient=function(){return f},t.setMarkEndOrient=function(e){f!=e&&(f=e,t.setChanged(!0))},t.setMarkMiddle=function(e){E="string"==typeof e?EJSS_DRAWING2D.Arrow[e.toUpperCase()]:e},t.getMarkMiddle=function(){return E},t.setMarkMiddleColor=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=p&&(p=e,t.setChanged(!0)),t},t.getMarkMiddleColor=function(){return p},t.setMarkMiddleStroke=function(e){y!=e&&(y=e,t.setChanged(!0))},t.getMarkMiddleStroke=function(){return y},t.setMarkMiddleColorSnd=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=h&&(h=e,t.setChanged(!0)),t},t.getMarkMiddleColorSnd=function(){return h},t.setMarkMiddleWidth=function(e){m!=e&&(m=e,t.setChanged(!0))},t.getMarkMiddleWidth=function(){return m},t.setMarkMiddleHeight=function(e){A!=e&&(A=e,t.setChanged(!0))},t.getMarkMiddleHeight=function(){return A},t.setMarkMiddleDiameter=function(e){A==e&&m==e||(A=e,m=e,t.setChanged(!0))},t.getMarkMiddleOrient=function(){return v},t.setMarkMiddleOrient=function(e){v!=e&&(v=e,t.setChanged(!0))},t.registerProperties=function(e){EJSS_DRAWING2D.Arrow.registerProperties(t,e)},t.copyTo=function(e){EJSS_DRAWING2D.Arrow.copyTo(t,e)},t.setSize([.1,.1]),t.setRelativePosition("SOUTH_WEST"),t},EJSS_DRAWING2D.ArrowSet={},EJSS_DRAWING2D.arrowSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Axis={AXIS_VERTICAL:0,AXIS_HORIZONTAL:1,TICKS_UP:2,TICKS_DOWN:3,SCALE_NUM:0,SCALE_LOG:1,registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Step",e.setStep,e.getStep),t.registerProperty("TickStep",e.setTickStep,e.getTickStep),t.registerProperty("Ticks",e.setTicks,e.getTicks),t.registerProperty("AutoTicks",e.setAutoTicks,e.getAutoTicks),t.registerProperty("FixedTick",e.setFixedTick,e.getFixedTick),t.registerProperty("Orient",e.setOrient,e.getOrient),t.registerProperty("Scale",e.setScale,e.getScale),t.registerProperty("TicksMode",e.setTicksMode,e.getTicksMode),t.registerProperty("TicksSize",e.setTicksSize,e.getTicksSize),t.registerProperty("AutoStepMin",e.setAutoStepMin,e.getAutoStepMin),t.registerProperty("AutoTicksRange",e.setAutoTicksRange,e.getAutoTicksRange),t.registerProperty("TextPosition",e.setTextPosition,e.getTextPosition),t.registerProperty("ScalePrecision",e.setScalePrecision,e.getScalePrecision),t.registerProperty("Font",e.getFont().setFont),t.registerProperty("FontFamily",e.getFont().setFontFamily),t.registerProperty("FontSize",e.getFont().setFontSize),t.registerProperty("LetterSpacing",e.getFont().setLetterSpacing),t.registerProperty("FontOutlineColor",e.getFont().setOutlineColor),t.registerProperty("FontWeight",e.getFont().setFontWeight),t.registerProperty("FontFillColor",e.getFont().setFillColor),t.registerProperty("Show",e.setShow,e.getShow)}},EJSS_DRAWING2D.axis=function(e){var t=EJSS_DRAWING2D.segment(e),r=!0,n=0,i=20,o=0,a=Number.NaN,s=EJSS_DRAWING2D.Axis.AXIS_VERTICAL,l=[-1,1],u=!1,g=EJSS_DRAWING2D.Axis.SCALE_NUM,c=EJSS_DRAWING2D.Axis.TICKS_UP,S=10,d=1,f=EJSS_DRAWING2D.font(e),E=40,p=[5,10,20],h=!0;return t._23=function(){return"ElementAxis"},t.setShow=function(e){h!=e&&(h=e,t.setChanged(!0))},t.getShow=function(){return h},t.getFont=function(){return f},t.setAutoTicksRange=function(e){p!=e&&(p=e,t.setChanged(!0))},t.getAutoTicksRange=function(){return p},t.setAutoStepMin=function(e){E!=e&&(E=e,t.setChanged(!0))},t.getAutoStepMin=function(){return E},t.setFixedTick=function(e){a!=e&&(a=e,t.setChanged(!0))},t.getFixedTick=function(){return a},t.setAutoTicks=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getAutoTicks=function(){return r},t.setStep=function(e){i!=e&&(i=e,t.setChanged(!0))},t.getStep=function(){return i},t.setTickStep=function(e){o!=e&&(o=e,t.setChanged(!0))},t.getTickStep=function(){return o},t.setTicks=function(e){n!=e&&(n=e,t.setChanged(!0))},t.getTicks=function(){return n},t.setTicksMode=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Grid[e.toUpperCase()]),g!=e&&(g=e,t.setChanged(!0))},t.getTicksMode=function(){return g},t.setTextPosition=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Axis[e.toUpperCase()]),c!=e&&(c=e,t.setChanged(!0))},t.getTextPosition=function(){return c},t.setOrient=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Axis[e.toUpperCase()]),s!=e&&(s=e,t.setChanged(!0))},t.getOrient=function(){return s},t.setScale=function(e){l!=e&&(l=e,t.setChanged(!0))},t.getScale=function(){return l},t.setScalePrecision=function(e){d!=e&&(d=e,t.setChanged(!0))},t.getScalePrecision=function(){return d},t.setTicksSize=function(e){S!=e&&(S=e,t.setChanged(!0))},t.getTicksSize=function(){return S},t.setInvertedScaleY=function(e){u!=e&&(u=e,t.setChanged(!0))},t.getInvertedScaleY=function(){return u},t.registerProperties=function(e){EJSS_DRAWING2D.Axis.registerProperties(t,e)},f.setChangeListener(function(e){t.setChanged(!0)}),t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.ByteRaster={},EJSS_DRAWING2D.byteRaster=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.CellLattice={},EJSS_DRAWING2D.cellLattice=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Cursor={},EJSS_DRAWING2D.cursor=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Custom={},EJSS_DRAWING2D.custom=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.DrawingPanel={MOUSE_ENTERED:0,MOUSE_EXITED:1,MOUSE_PRESSED:2,MOUSE_DRAGGED:3,MOUSE_RELEASED:4,GRAPHICS2D_SVG:0,GRAPHICS2D_CANVAS:1,SCALE_NUM:0,SCALE_LOG:1,registerProperties:function(e,t){e.setController(t),t.registerProperty("AutoScale",e.setAutoScale,e.getAutoScale),t.registerProperty("AutoScaleX",e.setAutoScaleX,e.getAutoScaleX),t.registerProperty("AutoScaleY",e.setAutoScaleY,e.getAutoScaleY),t.registerProperty("InvertedScaleY",e.setInvertedScaleY,e.getInvertedScaleY),t.registerProperty("MinimumX",e.setWorldXMin,e.getWorldXMin),t.registerProperty("MaximumX",e.setWorldXMax,e.getWorldXMax),t.registerProperty("MinimumY",e.setWorldYMin,e.getWorldYMin),t.registerProperty("MaximumY",e.setWorldYMax,e.getWorldYMax),t.registerProperty("Bounds",e.setWorldCoordinates,e.getWorldCoordinates),t.registerProperty("ScaleXType",function(t){e.setTypeScaleX(t),e.scale()},e.getTypeScaleX),t.registerProperty("ScaleYType",function(t){e.setTypeScaleY(t),e.scale()},e.getTypeScaleY),t.registerProperty("MarginX",e.setMarginX,e.getMarginX),t.registerProperty("MarginY",e.setMarginY,e.getMarginY),t.registerProperty("Parent",e.getGraphics().setParent,e.getGraphics().getParent),t.registerProperty("ClassName",e.getGraphics().setClassName),t.registerProperty("Width",function(t){e.getGraphics().setWidth(t)&&e.scale()},e.getGraphics().getBox().width),t.registerProperty("Height",function(t){e.getGraphics().setHeight(t)&&e.scale()},e.getGraphics().getBox().height),t.registerProperty("SquareAspect",e.setSquareAspect),t.registerProperty("GraphicsMode",e.setGraphicsMode),t.registerProperty("Enabled",e.getPanelInteraction().setEnabled),t.registerProperty("StopMoveEvents",e.getPanelInteraction().setStopMoveEvents),t.registerProperty("StopGestures",e.getPanelInteraction().setStopGestures),t.registerProperty("Gutters",e._25),t.registerProperty("GuttersLineColor",e.getGuttersStyle().setLineColor),t.registerProperty("GuttersLineWidth",e.getGuttersStyle().setLineWidth),t.registerProperty("GuttersDrawLines",e.getGuttersStyle().setDrawLines),t.registerProperty("GuttersColor",e.getGuttersStyle().setFillColor),t.registerProperty("GuttersFill",e.getGuttersStyle().setDrawFill),t.registerProperty("GuttersRendering",e.getStyle().setShapeRendering),t.registerProperty("Background",e.getStyle().setFillColor),t.registerProperty("Foreground",e.getStyle().setLineColor),t.registerProperty("LineColor",e.getStyle().setLineColor),t.registerProperty("LineWidth",e.getStyle().setLineWidth),t.registerProperty("DrawLines",e.getStyle().setDrawLines),t.registerProperty("FillColor",e.getStyle().setFillColor),t.registerProperty("DrawFill",e.getStyle().setDrawFill),t.registerProperty("ShapeRendering",e.getStyle().setShapeRendering),t.registerProperty("Visibility",e.getGraphics().getStyle().setVisibility),t.registerProperty("Display",e.getGraphics().getStyle().setDisplay),t.registerProperty("CSS",e.getGraphics().getStyle().setCSS),t.registerProperty("TRMessage",e.getMessageDecoration("TR").setText),t.registerProperty("TLMessage",e.getMessageDecoration("TL").setText),t.registerProperty("BRMessage",e.getMessageDecoration("BR").setText),t.registerProperty("BLMessage",e.getMessageDecoration("BL").setText),t.registerProperty("CoordinatesFormat",e.getCoordinates().setFormat),t.registerProperty("ShowCoordinates",e.setShowCoordinates),t.registerProperty("ShowAreaRectangle",e.setShowAreaRectangle),t.registerProperty("CursorTypeForMove",e.getInteraction().setCursorTypeForMove),t.registerAction("OnDoubleClick",e.getInteraction().getInteractionPoint),t.registerAction("OnMove",e.getInteraction().getInteractionPoint,e.getOnMoveHandler),t.registerAction("OnPress",e.getInteraction().getInteractionPoint,e.getOnPressHandler),t.registerAction("OnDrag",e.getInteraction().getInteractionPoint,e.getOnDragHandler),t.registerAction("OnRelease",e.getInteraction().getInteractionBounds,e.getOnReleaseHandler),t.registerAction("OnResize",e.getInteraction().getInteractionBounds,e.scale),t.registerAction("OnOrientationChange",e.getInteraction().getOrientation,e.scale)}},EJSS_DRAWING2D.drawingPanel=function(e,t){var r,n={},i=EJSS_DRAWING2D.style(e),o=[],a=[],s=!1,l=!1,u=!1,g=!1,c=0,S=0,d=[],f=!0,E=!0,p=[],h=-1,m=1,A=-1,y=1,v={xminPreferred:NaN,xmaxPreferred:NaN,yminPreferred:NaN,ymaxPreferred:NaN,xminMeasured:NaN,xmaxMeasured:NaN,yminMeasured:NaN,ymaxMeasured:NaN,xmargin:0,ymargin:0,xmin:-1,xmax:1,ymin:-1,ymax:1,squareAspect:!1,xorigin:0,yorigin:0,xscale:1,yscale:1},P={left:0,right:0,top:0,bottom:0,visible:!1},D=EJSS_DRAWING2D.style(e+" gutters"),I=!0,_=!0,C={propertiesChanged:function(){},invokeAction:function(){}};n.getName=function(){return e},n.getGraphics=function(){return r},n.importGraphics=function(e){return r.importSVG?r.importSVG(e):null},n.getStyle=function(){return i},n.getGraphicsMode=function(){return t},n.getGraphicsModeName=function(){switch(t){case EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_CANVAS:return"CANVAS";default:case EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_SVG:return"SVG"}},n.setGraphicsMode=function(n){if("string"==typeof n?(0!=n.indexOf("GRAPHICS2D_")&&(n="GRAPHICS2D_"+n),n=EJSS_DRAWING2D.DrawingPanel[n.toUpperCase()]|EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_SVG):"undefined"==typeof n&&(n=EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_SVG),n!=t){t=n;var i="undefined"!=typeof r;if(i){var o=r.getParent(),a=r.getWidth(),l=r.getHeight(),u=r.getEventContext().getAttribute("style"),g=document.getElementById(e);g.parentNode.removeChild(g)}n==EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_SVG?r=EJSS_GRAPHICS.svgGraphics(e):n==EJSS_DRAWING2D.DrawingPanel.GRAPHICS2D_CANVAS?r=EJSS_GRAPHICS.canvasGraphics(e):console.log("WARNING: setGraphics() - Graphics not supported"),i&&(r.setParent(o),r.setWidth(a),r.setHeight(l),r.getEventContext().setAttribute("style",u),s=!0,G.reload())}},n.getAutoScale=function(){return l||u},n.setAutoScale=function(e){n.setAutoScaleX(e),n.setAutoScaleY(e)},n.setAutoScaleX=function(e){l=e},n.getAutoScaleX=function(){return l},n.setAutoScaleY=function(e){u=e},n.getAutoScaleY=function(){return u},n.setInvertedScaleY=function(e){if(g!=e){g=e,g&&(S=EJSS_DRAWING2D.DrawingPanel.SCALE_NUM);var t=n.reportDecorations("bounds");t&&(I=!0)}},n.getInvertedScaleY=function(){return g},n.setTypeScaleX=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.DrawingPanel[e.toUpperCase()]),c=e},n.getTypeScaleX=function(){return c},n.setTypeScaleY=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.DrawingPanel[e.toUpperCase()]),S=e,S==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG&&(g=!1)},n.getTypeScaleY=function(){return S},n.setWorldXMin=function(e){e!==v.xminPreferred&&(v.xminPreferred=e)},n.getWorldXMin=function(){return v.xminPreferred},n.setWorldXMax=function(e){e!==v.xmaxPreferred&&(v.xmaxPreferred=e)},n.getWorldXMax=function(){return v.xmaxPreferred},n.setWorldYMin=function(e){e!==v.yminPreferred&&(v.yminPreferred=e)},n.getWorldYMin=function(){return v.yminPreferred},n.setWorldYMax=function(e){e!==v.ymaxPreferred&&(v.ymaxPreferred=e)},n.getWorldYMax=function(){return v.ymaxPreferred},n.setWorldCoordinates=function(e){n.setWorldXMin(e[0]),n.setWorldXMax(e[1]),n.setWorldYMin(e[2]),n.setWorldYMax(e[3])},n.getWorldCoordinates=function(){return[n.getWorldXMin(),n.getWorldXMax(),n.getWorldYMin(),n.getWorldYMax()]},n.getRealWorldCoordinates=function(){return[v.xmin,v.xmax,v.ymin,v.ymax]},n.getRealWorldXMin=function(){return v.xmin},n.getRealWorldXMax=function(){return v.xmax},n.getRealWorldYMin=function(){return v.ymin},n.getRealWorldYMax=function(){return v.ymax},n.setSquareAspect=function(e){e!==v.squareAspect&&(v.squareAspect=e,_=!0)},n.setMarginX=function(e){v.xmargin!=e&&(v.xmargin=e,_=!0)},n.getMarginX=function(){return v.xmargin},n.setMarginY=function(e){v.ymargin!=e&&(v.ymargin=e,_=!0)},n.getMarginY=function(){return v.ymargin},n.setShowCoordinates=function(e){f=e},n.setShowAreaRectangle=function(e){E=e},n.addDecoration=function(e,t,r){return r?EJSS_TOOLS.addToArray(d,e,t):EJSS_TOOLS.addToArray(o,e,t),e.setPanel&&e.setPanel(n),n},n.removeDecoration=function(e){return EJSS_TOOLS.removeFromArray(o,e),EJSS_TOOLS.removeFromArray(d,e),e.setPanel&&e.setPanel(null),n},n.addElement=function(e,t){if("undefined"==typeof t)EJSS_TOOLS.addToArray(a,e);else if("object"==typeof t){var r=EJSS_TOOLS.arrayObjectIndexOf(a,t);EJSS_TOOLS.addToArray(a,e,r)}else EJSS_TOOLS.addToArray(a,e,t);e.setPanel(n),e.dataCollected&&p.push(e),s=!0},n.removeElement=function(e){EJSS_TOOLS.removeFromArray(a,e),e.setPanel(null),e.dataCollected&&EJSS_TOOLS.removeFromArray(p,e),s=!0},n.getElements=function(){return a},n.indexOfElement=function(e){return a.indexOf(e)},n._25=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=!1;t!==P.left&&(P.left=t,o=!0),r!==P.top&&(P.top=r,o=!0),n!==P.right&&(P.right=n,o=!0),i!==P.bottom&&(P.bottom=i,o=!0),o&&(P.visible=P.left>0||P.top>0||P.right>0||P.bottom>0,I=!0,_=!0)},n.getGutters=function(){return P},n.getGuttersStyle=function(){return D},n.toPixelAxisY=function(e){return v.yorigin-e-v.yscale*v.ymin},n.toPixelAxisX=function(e){return v.xorigin+e-v.xscale*v.xmin},n._26=function(e,t){var r="undefined"!=typeof t?t:c,i="undefined"!=typeof t?t:S,o=[];return r==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG?o[0]=n.toPixelLogScale(e[0],v.xorigin,v.xmin,v.xmax,v.xscale):o[0]=v.xorigin+v.xscale*(e[0]-v.xmin),i==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG?o[1]=n.toPixelLogScale(e[1],v.yorigin,v.ymin,v.ymax,v.yscale):g?o[1]=P.top+v.yscale*(v.ymin-e[1]):o[1]=v.yorigin+v.yscale*(e[1]-v.ymin),o},n.toPixelMod=function(e){var t=[];return t[0]=e[0]*v.xscale,t[1]=e[1]*v.yscale,t},n.toPanelPosition=function(e,t){var r="undefined"!=typeof t?t:c,i="undefined"!=typeof t?t:S,o=[];return r==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG?o[0]=n.toPanelLogScale(e[0],v.xorigin,v.xmin,v.xmax,v.xscale):o[0]=v.xmin+(e[0]-v.xorigin)/v.xscale,i==EJSS_DRAWING2D.DrawingPanel.SCALE_LOG?o[1]=n.toPanelLogScale(e[1],v.yorigin,v.ymin,v.ymax,v.yscale):g?o[1]=v.ymin-(e[1]-P.top)/v.yscale:o[1]=v.ymin+(e[1]-v.yorigin)/v.yscale,o},n.toPanelMod=function(e){var t=[];return t[0]=0==v.xscale?0:e[0]/v.xscale,t[1]=0==v.yscale?0:e[1]/v.yscale,t},n.toPixelLogScale=function(e,t,r,n,i){var o=r<=0?1:Math.log(r)/Math.log(10),a=n<=0?1:Math.log(n)/Math.log(10),s=(n-r)*i,l=a-o,u=s/l,g=e<=0?0:Math.log(e)/Math.log(10);return t+u*(g-o)},n.toPanelLogScale=function(e,t,r,n,i){var o=r<0?0:Math.log(r)/Math.log(10),a=n<0?0:Math.log(n)/Math.log(10),s=(n-r)*i,l=a-o,u=s/l;return Math.pow(10,o+(e-t)/u)},n.getPixelPositionWorldOrigin=function(){return[v.xorigin,v.yorigin]},n.getInnerRect=function(){var e=n.getRealWorldCoordinates();if(n.getInvertedScaleY())var t=n._26([e[0],e[2]]);else var t=n._26([e[0],e[3]]);var r=n.toPixelMod([e[1]-e[0],e[3]-e[2]]);return{x:t[0],width:Math.abs(r[0]),y:t[1],height:Math.abs(r[1])}},n.scale=function(){_=!0,s=!0},n.touch=function(){_=!0,s=!0;for(var e=0,t=a.length;e<t;e++)a[e].setChanged(!0)},n._27=function(){var e,t,i=!1,o=(v.xmaxMeasured-v.xminMeasured)/2,s=(v.ymaxMeasured-v.yminMeasured)/2,l=v.xminMeasured-Math.abs(o*v.xmargin/100),u=v.xmaxMeasured+Math.abs(o*v.xmargin/100),g=v.yminMeasured-Math.abs(s*v.ymargin/100),c=v.ymaxMeasured+Math.abs(s*v.ymargin/100),S=r.getBox(),d=S.width-(P.left+P.right),f=S.height-(P.bottom+P.top),E=d/(u-l),p=f/(c-g);if(v.squareAspect&&(e=Math.abs(E/p),e>=1?(e=Math.min(e,d),t=(u-l)*(e-1)/2,l-=t,u+=t,E=d/(u-l)):(e=Math.max(e,1/f),t=(c-g)*(1/e-1)/2,g-=t,c+=t,p=f/(c-g))),i=v.xscale!=E||v.yscale!=-p,v.xscale=E,v.yscale=-p,v.xorigin=P.left+.5,v.yorigin=f+P.top+.5,_=!1,v.xmin!==l||v.xmax!==u||v.ymin!==g||v.ymax!==c){v.xmin=l,v.xmax=u,v.ymin=g,v.ymax=c;var h=n.reportDecorations("bounds");h&&(I=!0),i=!0}if(i)for(var m=0,A=a.length;m<A;m++)a[m].setMustProject(!0)},n.reportDecorations=function(e){var t,r,n=!1;for(t=0,r=o.length;t<r;t++)n|=o[t].panelChangeListener&&o[t].panelChangeListener("bounds");for(t=0,r=d.length;t<r;t++)d[t].panelChangeListener&&d[t].panelChangeListener("bounds");return n},n._28=function(){var e=Number.MAX_VALUE,t=-Number.MAX_VALUE,r=Number.MAX_VALUE,i=-Number.MAX_VALUE;if(n.getAutoScaleY()||n.getAutoScaleX())for(var o=0,s=a.length;o<s;o++)if(a[o].isMeasured()&&!a[o].isGroup()&&(null==a[o].getGroup()||a[o].getGroup().isMeasured()))if(a[o].isPixelSize()){var l=a[o].getPosition();e=Math.min(e,l[0]),t=Math.max(t,l[0]),r=Math.min(r,l[1]),i=Math.max(i,l[1])}else{var u=a[o].getAbsoluteBounds();e=Math.min(e,u.left),
t=Math.max(t,u.right),r=Math.min(r,u.bottom),i=Math.max(i,u.top)}var g=!1;n.getAutoScaleX()?(isNaN(v.xminPreferred)||(e=Math.min(e,v.xminPreferred)),isNaN(v.xmaxPreferred)||(t=Math.max(t,v.xmaxPreferred)),t<=e?(g=v.xminMeasured!=h||v.xmaxMeasured!=m,v.xminMeasured=h,v.xmaxMeasured=m):(g=v.xminMeasured!=e||v.xmaxMeasured!=t,v.xminMeasured=e,v.xmaxMeasured=t)):isNaN(v.xminPreferred)||isNaN(v.xmaxPreferred)?(g=v.xminMeasured!=h||v.xmaxMeasured!=m,v.xminMeasured=h,v.xmaxMeasured=m):(g=v.xminMeasured!=v.xminPreferred||v.xmaxMeasured!=v.xmaxPreferred,v.xminMeasured=v.xminPreferred,v.xmaxMeasured=v.xmaxPreferred);var c=!1;return n.getAutoScaleY()?(isNaN(v.yminPreferred)||(r=Math.min(r,v.yminPreferred)),isNaN(v.ymaxPreferred)||(i=Math.max(i,v.ymaxPreferred)),i<=r?(c=v.yminMeasured!=A||v.ymaxMeasured!=y,v.yminMeasured=A,v.ymaxMeasured=y):(c=v.yminMeasured!=r||v.ymaxMeasured!=i,v.yminMeasured=r,v.ymaxMeasured=i)):isNaN(v.yminPreferred)||isNaN(v.ymaxPreferred)?(c=v.yminMeasured!=A||v.ymaxMeasured!=y,v.yminMeasured=A,v.ymaxMeasured=y):(c=v.yminMeasured!=v.yminPreferred||v.ymaxMeasured!=v.ymaxPreferred,v.yminMeasured=v.yminPreferred,v.ymaxMeasured=v.ymaxPreferred),g||c},n.reset=function(){r.reset()},n.render=function(){var e=!1;(r.setImageData||s)&&(r.reset(),e=!0,s=!1);for(var t=0,i=p.length;t<i;t++)p[t].dataCollected();var l=n._28();(_||l)&&n._27(),(I||e)&&(r.drawPanel(n),r.draw(o)),r.draw(a,e),(I||e)&&r._24(n),r.draw(d),I=!1;for(var t=0,i=a.length;t<i;t++)a[t].setChanged(!1)},n.getPanelInteraction=function(){return G},n.getController=function(){return C},n.setController=function(e){C=e},n.getOnMoveHandler=null,n.getOnPressHandler=function(){if(f){var e=G.getInteractionPoint(),t=n.getRealWorldCoordinates();t[0]<e[0]&&t[1]>e[0]&&t[3]>e[1]&&t[2]<e[1]&&(b.setText(e),b.setVisible(!0),b.getController().propertiesChanged("Visible","Text"))}},n.getOnDragHandler=function(){if(f){var e=G.getInteractionPoint(),t=n.getRealWorldCoordinates();t[0]<e[0]&&t[1]>e[0]&&t[3]>e[1]&&t[2]<e[1]&&(b.setText(e),b.setVisible(!0),b.getController().propertiesChanged("Visible","Text"))}if(E){var r=G.getInteractionBounds();r.length>0&&c==EJSS_DRAWING2D.DrawingPanel.SCALE_NUM&&S==EJSS_DRAWING2D.DrawingPanel.SCALE_NUM?(R.setBounds(r),R.setVisible(!0),R.getController().propertiesChanged("Position","X","Y","Size","SizeX","SizeY","Visible")):(R.setVisible(!1),R.getController().propertiesChanged("Visible"))}},n.getOnReleaseHandler=function(){f&&(b.setVisible(!1),b.getController().propertiesChanged("Visible")),E&&(R.setVisible(!1),R.getController().propertiesChanged("Visible"))},n.getMessageDecoration=function(e){switch(e){case"TL":return T;case"BR":return O;case"BL":return N}return M},n.getCoordinates=function(){return b},n.getInteraction=function(){return G},n.registerProperties=function(e){EJSS_DRAWING2D.DrawingPanel.registerProperties(n,e)},n.serialize=function(){return{mStyle:i.serialize(),mTopDecorations:d,mBottomDecorations:o,mElements:a,mCollectersList:p,mAutoScaleX:l,mAutoScaleY:u,mInvertedScaleY:g,mTypeScaleX:c,mTypeScaleY:S,mShowCoordinates:f,xmindef:h,xmaxdef:m,ymindef:A,ymaxdef:y,mWorld:v,mGutters:P,mGuttersStyle:D.serialize()}},n.unserialize=function(e){i.unserialize(e.mStyle),l=e.mAutoScaleX,u=e.mAutoScaleY,g=e.mInvertedScaleY,c=e.mTypeScaleX,S=e.mTypeScaleY,f=e.mShowCoordinates,h=e.xmindef,m=e.xmaxdef,A=e.ymindef,y=e.ymaxdef,v=e.mWorld,P=e.mGutters,D.unserialize(e.mGuttersStyle),I=!0},n.setGraphicsMode(t),i.setLineColor("black"),i.setFillColor("rgb(239,239,255)"),i.setChangeListener(function(e){I=!0}),D.setChangeListener(function(e){I=!0});var R=EJSS_DRAWING2D.shape(e+"__cursorBox__");R.setShapeType(EJSS_DRAWING2D.Shape.RECTANGLE),R.getStyle().setDrawFill(!1),R.getStyle().setLineColor("black"),R.setRelativePosition("CENTER"),R.setVisible(!1),n.addDecoration(R,0,!0);var T=EJSS_DRAWING2D.text(e+"__tlmessage__");T.setRelativePosition("NORTH_WEST"),T.getStyle().setDrawLines(!0),T.getStyle().setDrawFill(!0),T.getStyle().setFillColor("yellow"),T.getStyle().setLineColor("black"),T.getFont().setFontSize(12),T.setPosition([v.xmin,v.ymax]),T.setFramed(!0),T.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?T.setPosition([v.xmin,v.ymin]):T.setPosition([v.xmin,v.ymax]))},n.addDecoration(T,0,!0);var N=EJSS_DRAWING2D.text(e+"__blmessage__");N.setRelativePosition("SOUTH_WEST"),N.getStyle().setDrawLines(!0),N.getStyle().setDrawFill(!0),N.getStyle().setFillColor("yellow"),N.getStyle().setLineColor("black"),N.getFont().setFontSize(12),N.setPosition([v.xmin,v.ymin]),N.setFramed(!0),N.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?N.setPosition([v.xmin,v.ymax]):N.setPosition([v.xmin,v.ymin]))},n.addDecoration(N,0,!0);var O=EJSS_DRAWING2D.text(e+"__brmessage__");O.setRelativePosition("SOUTH_EAST"),O.getStyle().setDrawLines(!0),O.getStyle().setDrawFill(!0),O.getStyle().setFillColor("yellow"),O.getStyle().setLineColor("black"),O.getFont().setFontSize(12),O.setPosition([v.xmax,v.ymin]),O.setFramed(!0),O.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?O.setPosition([v.xmax,v.ymax]):O.setPosition([v.xmax,v.ymin]))},n.addDecoration(O,0,!0);var M=EJSS_DRAWING2D.text(e+"__trmessage__");M.setRelativePosition("NORTH_EAST"),M.getStyle().setDrawLines(!0),M.getStyle().setDrawFill(!0),M.getStyle().setFillColor("yellow"),M.getStyle().setLineColor("black"),M.getFont().setFontSize(12),M.setPosition([v.xmax,v.ymax]),M.setFramed(!0),M.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?M.setPosition([v.xmax,v.ymin]):M.setPosition([v.xmax,v.ymax]))},n.addDecoration(M,0,!0);var b=EJSS_DRAWING2D.infoText(e+"__coor__");b.setRelativePosition("SOUTH_WEST"),b.getFont().setFontSize(12),b.getStyle().setFillColor("yellow"),b.setPosition([v.xmin,v.ymin]),b.setFormat("x:0.##,y:0.##"),b.setFramed(!0),b.setVisible(!1),b.panelChangeListener=function(e){"bounds"==e&&(n.getInvertedScaleY()?b.setPosition([v.xmin,v.ymax]):b.setPosition([v.xmin,v.ymin]))},n.addDecoration(b,0,!0),n.getGuttersStyle().setLineColor("black"),n.getGuttersStyle().setFillColor("rgb(239,239,255)"),n.getGuttersStyle().setShapeRendering("RENDER_CRISPEDGES");var G=EJSS_DRAWING2D.panelInteraction(n);return r.getEventContext().addEventListener("dblclick",function(e){return e.preventDefault(),e.stopPropagation(),!1},!0),n};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Element={CENTER:0,NORTH:1,SOUTH:2,EAST:3,WEST:4,NORTH_EAST:5,NORTH_WEST:6,SOUTH_EAST:7,SOUTH_WEST:8,registerProperties:function(e,t){var r=EJSS_DRAWING2D.PanelInteraction.TARGET_POSITION,n=EJSS_DRAWING2D.PanelInteraction.TARGET_SIZE,i=e.getStyle();e.setController(t),t.registerProperty("Parent",e.setParent,e.getParent),t.registerProperty("X",e.setX,e.getX),t.registerProperty("Y",e.setY,e.getY),t.registerProperty("Position",e.setPosition,e.getPosition),t.registerProperty("PixelPosition",e.setPixelPosition,e.getPixelPosition),t.registerProperty("Diameter",function(t){e.setSize([t,t])}),t.registerProperty("Radius",function(t){e.setSize([2*t,2*t])}),t.registerProperty("SizeX",e.setSizeX,e.getSizeX),t.registerProperty("SizeY",e.setSizeY,e.getSizeY),t.registerProperty("Size",e.setSize,e.getSize),t.registerProperty("PixelSize",e.setPixelSize,e.getPixelSize),t.registerProperty("Bounds",e.setBounds,e.getBounds),t.registerProperty("RelativePosition",e.setRelativePosition,e.getRelativePosition),t.registerProperty("Visibility",e.setVisible,e.isVisible),t.registerProperty("Measured",e.setMeasured,e.isMeasured),t.registerProperty("Transformation",e.setTransformation),t.registerProperty("LineColor",i.setLineColor,i.getLineColor),t.registerProperty("LineWidth",i.setLineWidth,i.getLineWidth),t.registerProperty("DrawLines",i.setDrawLines,i.getDrawLines),t.registerProperty("FillColor",i.setFillColor,i.getFillColor),t.registerProperty("DrawFill",i.setDrawFill,i.getDrawFill),t.registerProperty("ShapeRendering",i.setShapeRendering,i.getShapeRendering),t.registerProperty("Attributes",i.setAttributes,i.getAttributes),t.registerProperty("EnabledPosition",function(t){e.getInteractionTarget(r).setMotionEnabled(t)}),t.registerProperty("MovesGroup",function(t){e.getInteractionTarget(r).setAffectsGroup(t)}),t.registerProperty("EnabledSize",function(t){e.getInteractionTarget(n).setMotionEnabled(t)}),t.registerProperty("ResizesGroup",function(t){e.getInteractionTarget(n).setAffectsGroup(t)}),t.registerProperty("Sensitivity",function(t){e.getInteractionTarget(r).setSensitivity(t),e.getInteractionTarget(n).setSensitivity(t)}),t.registerAction("OnEnter",e.getPosition),t.registerAction("OnExit",e.getPosition),t.registerAction("OnPress",e.getPosition),t.registerAction("OnDrag",e.getPosition),t.registerAction("OnRelease",e.getPosition)},copyTo:function(e,t){var r=EJSS_DRAWING2D.InteractionTarget,n=EJSS_DRAWING2D.PanelInteraction.TARGET_POSITION,i=EJSS_DRAWING2D.PanelInteraction.TARGET_SIZE;EJSS_DRAWING2D.Style.copyTo(e.getStyle(),t.getStyle()),t.setVisible(e.isVisible()),t.setMeasured(e.isMeasured()),t.setPosition(e.getPosition()),t.setPixelPosition(e.isPixelPosition()),t.setSize(e.getSize()),t.setPixelSize(e.isPixelSize()),t.setTransformation(e.getTransformation()),t.setRelativePosition(e.getRelativePosition()),r.copyTo(e.getInteractionTarget(n),t.getInteractionTarget(n)),r.copyTo(e.getInteractionTarget(i),t.getInteractionTarget(i)),t.setParent(e.getParent(),e)},getRelativePositionOffset:function(e,t,r,n){var i=0,o=0;switch(e){default:case EJSS_DRAWING2D.Element.CENTER:i=0,o=0;break;case EJSS_DRAWING2D.Element.NORTH:i=0,o=-(r/2);break;case EJSS_DRAWING2D.Element.SOUTH:i=0,o=r/2;break;case EJSS_DRAWING2D.Element.EAST:i=-(t/2),o=0;break;case EJSS_DRAWING2D.Element.WEST:i=t/2,o=0;break;case EJSS_DRAWING2D.Element.NORTH_EAST:i=-(t/2),o=-(r/2);break;case EJSS_DRAWING2D.Element.NORTH_WEST:i=t/2,o=-(r/2);break;case EJSS_DRAWING2D.Element.SOUTH_EAST:i=-(t/2),o=r/2;break;case EJSS_DRAWING2D.Element.SOUTH_WEST:i=t/2,o=r/2}return"undefined"!=typeof n&&n&&(o=-o),[i,o]},getSWRelativePositionOffset:function(e,t,r,n){var i=0,o=0;switch(e){default:case EJSS_DRAWING2D.Element.CENTER:i=-(t/2),o=r/2;break;case EJSS_DRAWING2D.Element.NORTH:i=-(t/2),o=r;break;case EJSS_DRAWING2D.Element.SOUTH:i=-(t/2),o=0;break;case EJSS_DRAWING2D.Element.EAST:i=-t,o=r/2;break;case EJSS_DRAWING2D.Element.WEST:i=0,o=r/2;break;case EJSS_DRAWING2D.Element.NORTH_EAST:i=-t,o=r;break;case EJSS_DRAWING2D.Element.NORTH_WEST:i=0,o=r;break;case EJSS_DRAWING2D.Element.SOUTH_EAST:i=-t,o=0;break;case EJSS_DRAWING2D.Element.SOUTH_WEST:i=0,o=0}return"undefined"!=typeof n&&n&&(o=-o),[i,o]}},EJSS_DRAWING2D.element=function(e){var t={},r=EJSS_DRAWING2D.Element,n=EJSS_DRAWING2D.PanelInteraction,i=EJSS_DRAWING2D.style(e),o=!0,a=!0,s=r.CENTER,l=0,u=0,g=!1,c=1,S=1,d=!1,f=0,E={positionTarget:EJSS_DRAWING2D.interactionTarget(t,n.TARGET_POSITION,r.CENTER),sizeTarget:EJSS_DRAWING2D.interactionTarget(t,n.TARGET_SIZE,r.NORTH_EAST)},p=null,h=null,m=null,A=-1,y=[],v=[],P=!0,D=!0,I={propertiesChanged:function(){},invokeAction:function(){}};return t.getName=function(){return e},t.setParent=function(e,r){e.render?(t.setGroup(null),e.addElement(t),t.setPanel(e)):"ElementGroup"==e._23()?(t.setGroup(e),t.getGroupPanel().addElement(t,r),t.setPanel(t.getGroupPanel())):console.log("WARNING: setParent() - Parent not valid : "+e.getName())},t.getParent=function(){var e;return e=null!==h?t.getGroup():t.getPanel()},t.isGroup=function(){return!1},t.getStyle=function(){return i},t.setX=function(e,t){l!=e&&(l=e,D=!0)},t.getX=function(){return l},t.setY=function(e){u!=e&&(u=e,D=!0)},t.getY=function(){return u},t.setPosition=function(e){t.setX(e[0]),t.setY(e[1])},t.getPosition=function(){return[l,u]},t.setPixelPosition=function(e){g!=e&&(g=e,D=!0)},t.isPixelPosition=function(){return g},t.setSizeX=function(e){c!=e&&(c=e,D=!0)},t.getSizeX=function(){return c},t.setSizeY=function(e){S!=e&&(S=e,D=!0)},t.getSizeY=function(){return S},t.setSize=function(e){t.setSizeX(e[0]),t.setSizeY(e[1])},t.getSize=function(){return[t.getSizeX(),t.getSizeY()]},t.setPixelSize=function(e){d!=e&&(d=e,D=!0)},t.isPixelSize=function(){return d},t.setBounds=function(e){var r,n,i,o;e.left?(r=e.left,n=e.right,i=e.top,o=e.bottom):(r=e[0],n=e[1],i=e[2],o=e[3]);var a=n-r,s=o-i,l=t.getRelativePositionOffset(a,s),u=a/2,g=s/2,c=r+u-l[0],S=i+g-l[1];t.setX(c),t.setY(S),t.setSizeX(a),t.setSizeY(s)},t.getBounds=function(){var e=d?p.toPanelMod([c,-S]):[c,S],r=e[0]/2,n=e[1]/2,i=t.getRelativePositionOffset(e[0],e[1]);return{left:l+i[0]-r,right:l+i[0]+r,top:u+i[1]+n,bottom:u+i[1]-n}},t.getAbsoluteBounds=function(){var e=t.getBounds(),r=t.toGroupSpace([e.left,e.top]),n=t.toGroupSpace([e.right,e.bottom]);return{left:r[0],top:r[1],right:n[0],bottom:n[1]}},t.setRelativePosition=function(e){"string"==typeof e&&(e=r[e.toUpperCase()]),s!=e&&(s=e,D=!0)},t.getRelativePosition=function(){return s},t.getRelativePositionOffset=function(e,t){var n,i;Array.isArray(e)?(n=e[0],i=e[1]):(n=e,i=t);var o=!!p.getInvertedScaleY&&p.getInvertedScaleY();return r.getRelativePositionOffset(s,n,i,o)},t.setVisible=function(e){e!=o&&(o=e,D=!0)},t.isVisible=function(){return o},t.isGroupVisible=function(){for(var e=h;"undefined"!=typeof e&&null!==e;){if(!e.isVisible())return!1;e=e.getGroup()}return o},t.setMeasured=function(e){a=e},t.isMeasured=function(){return a},t.setTransformation=function(e){"undefined"==typeof e||null===e?f=0:Array.isArray(e)&&e.length>5?EJSS_TOOLS.compareArrays(f,e)||(f=e,D=!0):f!=e&&(f=e,D=!0)},t.getTransformation=function(){return f},t.getInfo=function(){var e="x="+l.toFixed(2)+" y="+u.toFixed(2);return e},t.setPanel=function(e){p=e,P=!0},t.getPanel=function(){return p},t.getGroupPanel=function(){for(var e=t;e.getGroup();)e=e.getGroup();return e.getPanel()},t.setGroup=function(e){h=e,D=!0},t.getGroup=function(){return h},t.setSet=function(e,t){m=e,A=t},t.getSet=function(){return m},t.getSetIndex=function(){return A},t.isChanged=function(){return D},t.setChanged=function(e){D=e},t.isGroupChanged=function(){for(var e=t.getGroup();"undefined"!=typeof e&&null!==e;){if(e.isChanged())return!0;e=e.getGroup()}return!1},t.setMustProject=function(e){P=e},t.isMustProject=function(){return P},t.getPixelPosition=function(){return(t.isChanged()||t.isGroupChanged()||t.isMustProject())&&(y=t.getPixelPositionOf(l,u),v=t.getPixelSizeOf(c,S),t.setMustProject(!1)),y},t.getPixelSizes=function(){return(t.isChanged()||t.isGroupChanged()||t.isMustProject())&&(y=t.getPixelPositionOf(l,u),v=t.getPixelSizeOf(c,S),t.setMustProject(!1)),v},t.getAbsoluteSize=function(){var e=d?p.toPanelMod([c,-S]):[c,S];return t.toGroupSpaceMod(e)},t.getAbsolutePosition=function(){var e;return e=g?null===h?p.toPanelPosition([l,u]):p.toPanelPosition([l,u],EJSS_DRAWING2D.DrawingPanel.SCALE_NUM):[l,u],t.toGroupSpace(e)},t.getPixelSizeOf=function(e,r){return d?[e,-r]:t.getGroupPanel().toPixelMod(t.toGroupSpaceMod([e,r]))},t.getPixelPositionOf=function(e,r){var n;return n=g?[t.getGroupPanel().toPixelAxisX(e),t.getGroupPanel().toPixelAxisY(r)]:null===h?t.getGroupPanel()._26(t.toGroupSpace([e,r])):t.getGroupPanel()._26(t.toGroupSpace([e,r]),EJSS_DRAWING2D.DrawingPanel.SCALE_NUM)},t.toGroupSpaceMod=function(e){for(var t=h;"undefined"!=typeof t&&null!==t;)e[0]*=t.getSizeX(),e[1]*=t.getSizeY(),t=t.getGroup();return e},t.toGroupSpace=function(e){for(var t=h;"undefined"!=typeof t&&null!==t;)e[0]*=t.getSizeX(),e[1]*=t.getSizeY(),e[0]+=t.getX(),e[1]+=t.getY(),t=t.getGroup();return e},t.getController=function(){return I},t.setController=function(e){I=e},t.getInteractionTarget=function(e){switch(e){case n.TARGET_POSITION:return E.positionTarget;case n.TARGET_SIZE:return E.sizeTarget}return null},t.getInteractionTargets=function(){return[E.positionTarget,E.sizeTarget]},t.registerProperties=function(e){EJSS_DRAWING2D.Element.registerProperties(t,e)},t.copyTo=function(e){EJSS_DRAWING2D.Element.copyTo(t,e)},t.serialize=function(){return{mStyle:i.serialize(),mVisible:o,mMeasured:a,mRelativePosition:s,mX:l,mY:u,mPixelPosition:g,mSizeX:c,mSizeY:S,mPixelSize:d,mTransformation:f,mInteraction:{},mPanel:p?p.getName():p,mGroup:h?h.getName():h,mSet:m?m.getName():m,mIndexInSet:A,mProjectedPosition:y,mProjectedSize:v}},t.unserialize=function(e){i.unserialize(e.mStyle),o=e.mVisible,a=e.mMeasured,s=e.mRelativePosition,l=e.mX,u=e.mY,g=e.mPixelPosition,c=e.mSizeX,S=e.mSizeY,d=e.mPixelSize,f=e.mTransformation,A=e.mIndexInSet,y=e.mProjectedPosition,v=e.mProjectedSize,D=!0},i.setChangeListener(function(e){D=!0}),t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.ElementSet={},EJSS_DRAWING2D.elementSet=function(e,t){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Grid={SCALE_NUM:0,SCALE_LOG:1,registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("StepX",e.setStepX,e.getStepX),t.registerProperty("StepY",e.setStepY,e.getStepY),t.registerProperty("TicksX",e.setTicksX,e.getTicksX),t.registerProperty("TicksY",e.setTicksY,e.getTicksY),t.registerProperty("TickStepX",e.setTickStepX,e.getTickStepX),t.registerProperty("TickStepY",e.setTickStepY,e.getTickStepY),t.registerProperty("TicksXMode",e.setTicksXMode,e.getTicksXMode),t.registerProperty("TicksYMode",e.setTicksYMode,e.getTicksYMode),t.registerProperty("ShowX",e.setShowX,e.getShowX),t.registerProperty("ShowY",e.setShowY,e.getShowY),t.registerProperty("FixedTickX",e.setFixedTickX,e.getFixedTickX),t.registerProperty("FixedTickY",e.setFixedTickY,e.getFixedTickY),t.registerProperty("ScaleX",e.setScaleX,e.getScaleX),t.registerProperty("ScaleY",e.setScaleY,e.getScaleY),t.registerProperty("ScalePrecisionX",e.setScalePrecisionX,e.getScalePrecisionX),t.registerProperty("ScalePrecisionY",e.setScalePrecisionY,e.getScalePrecisionY),t.registerProperty("AutoTicksX",e.setAutoTicksX,e.getAutoTicksX),t.registerProperty("AutoTicksY",e.setAutoTicksY,e.getAutoTicksY),t.registerProperty("AutoStepXMin",e.setAutoStepXMin,e.getAutoStepXMin),t.registerProperty("AutoStepYMin",e.setAutoStepYMin,e.getAutoStepYMin),t.registerProperty("AutoTicksXRange",e.setAutoTicksXRange,e.getAutoTicksXRange),t.registerProperty("AutoTicksYRange",e.setAutoTicksYRange,e.getAutoTicksYRange),t.registerProperty("LineColorX",e.setLineColorX,e.getLineColorX),t.registerProperty("LineWidthX",e.setLineWidthX,e.getLineWidthX),t.registerProperty("ShapeRenderingX",e.setShapeRenderingX,e.getShapeRenderingX),t.registerProperty("LineColorY",e.setLineColorY,e.getLineColorY),t.registerProperty("LineWidthY",e.setLineWidthY,e.getLineWidthY),t.registerProperty("ShapeRenderingY",e.setShapeRenderingY,e.getShapeRenderingY)}},EJSS_DRAWING2D.grid=function(e){var t=EJSS_DRAWING2D.element(e),r=!0,n=!0,i=0,o=0,a=0,s=0,l=0,u=0,g=!0,c=!0,S=Number.NaN,d=Number.NaN,f=[-1,1],E=[-1,1],p=1,h=1,m=EJSS_DRAWING2D.Grid.SCALE_NUM,A=EJSS_DRAWING2D.Grid.SCALE_NUM,y=40,v=40,P=[5,10,20],D=[5,10,20],I="black",_=.5,C=EJSS_DRAWING2D.Style.RENDER_AUTO,R="black",T=.5,N=EJSS_DRAWING2D.Style.RENDER_AUTO;return t._23=function(){return"ElementGrid"},t.setAutoTicksRangeY=function(e){D!=e&&(D=e,t.setChanged(!0))},t.getAutoTicksRangeY=function(){return D},t.setAutoTicksRangeX=function(e){P!=e&&(P=e,t.setChanged(!0))},t.getAutoTicksRangeX=function(){return P},t.setAutoStepYMin=function(e){v!=e&&(v=e,t.setChanged(!0))},t.getAutoStepYMin=function(){return v},t.setAutoStepXMin=function(e){y!=e&&(y=e,t.setChanged(!0))},t.getAutoStepXMin=function(){return y},t.setScaleY=function(e){E!=e&&(E=e,t.setChanged(!0))},t.getScaleY=function(){return E},t.setScaleX=function(e){f!=e&&(f=e,t.setChanged(!0))},t.getScaleX=function(){return f},t.setScalePrecisionX=function(e){p!=e&&(p=e,t.setChanged(!0))},t.getScalePrecisionX=function(){return p},t.setScalePrecisionY=function(e){h!=e&&(h=e,t.setChanged(!0))},t.getScalePrecisionY=function(){return h},t.setFixedTickX=function(e){S!=e&&(S=e,t.setChanged(!0))},t.getFixedTickX=function(){return S},t.setFixedTickY=function(e){d!=e&&(d=e,t.setChanged(!0))},t.getFixedTickY=function(){return d},t.setAutoTicksX=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getAutoTicksX=function(){return r},t.setAutoTicksY=function(e){n!=e&&(n=e,t.setChanged(!0))},t.getAutoTicksY=function(){return n},t.setStepX=function(e){a!=e&&(a=e,t.setChanged(!0))},t.getStepX=function(){return a},t.setStepY=function(e){s!=e&&(s=e,t.setChanged(!0))},t.getStepY=function(){return s},t.setTickStepX=function(e){l!=e&&(l=e,t.setChanged(!0))},t.getTickStepX=function(){return l},t.setTickStepY=function(e){u!=e&&(u=e,t.setChanged(!0))},t.getTickStepY=function(){return u},t.setTicksX=function(e){i!=e&&(i=e,t.setChanged(!0))},t.getTicksX=function(){return i},t.setTicksY=function(e){o!=e&&(o=e,t.setChanged(!0))},t.getTicksY=function(){return o},t.setTicksXMode=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Grid[e.toUpperCase()]),m!=e&&(m=e,t.setChanged(!0))},t.getTicksXMode=function(){return m},t.setTicksYMode=function(e){"string"==typeof e&&(ticksXMode=EJSS_DRAWING2D.Grid[e.toUpperCase()]),A!=e&&(A=e,t.setChanged(!0))},t.setShowX=function(e){g!=e&&(g=e,t.setChanged(!0))},t.getShowX=function(){return g},t.setShowY=function(e){c!=e&&(c=e,t.setChanged(!0))},t.getShowY=function(){return c},t.getTicksYMode=function(){return A},t.setLineColorX=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=I&&(I=e,t.setChanged(!0)),t},t.getLineColorX=function(){return I},t.setLineWidthX=function(e){e!=_&&(_=e,t.setChanged(!0))},t.getLineWidthX=function(){return _},t.setShapeRenderingX=function(e){"RENDER"==e.substring(0,6)&&(e=EJSS_DRAWING2D.Style[e.toUpperCase()]),C!=e&&(C=e,t.setChanged(!0))},t.getShapeRenderingX=function(){return C},t.setLineColorY=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=R&&(R=e,t.setChanged(!0)),t},t.getLineColorY=function(){return R},t.setLineWidthY=function(e){e!=T&&(T=e,t.setChanged(!0))},t.getLineWidthY=function(){return T},t.setShapeRenderingY=function(e){"RENDER"==e.substring(0,6)&&(e=EJSS_DRAWING2D.Style[e.toUpperCase()]),N!=e&&(N=e,t.setChanged(!0))},t.getShapeRenderingY=function(){return N},t.registerProperties=function(e){EJSS_DRAWING2D.Grid.registerProperties(t,e)},t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Group={},EJSS_DRAWING2D.group=function(e){var t=EJSS_DRAWING2D.element(e);return t._23=function(){return"ElementGroup"},t.isGroup=function(){return!0},t},EJSS_DRAWING2D.GroupSet={},EJSS_DRAWING2D.groupSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Histogram={},EJSS_DRAWING2D.histogram=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Image={},EJSS_DRAWING2D.image=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.ImageSet={},EJSS_DRAWING2D.imageSet=function(e){};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.analyticCurve=function(e,t){function r(t,r,n,i,o){e.beginPath();for(var a=0;a<t.length;a++){var s=t[a],l=r+s[0]*i,u=n+s[1]*o,g=s[2];0==a||0==g?e.moveTo(l,u):e.lineTo(l,u)}}var n,i,o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1],g=a[0]/2,c=a[1]/2,S=t.getNumPoints(),d=t.getMinimun(),f=t.getMaximun(),E="undefined"==typeof d||null===d?t.getPanel().getRealWorldXMin():d,p="undefined"==typeof f||null===f?t.getPanel().getRealWorldXMax():f,h=t.getVariable(),m=t.getFunctionX(),A=t.getFunctionY(),y=EJSS_DRAWING2D.functionsParser(),v=!1;try{n=y.parse(m)}catch(e){console.log("Analytic curve error parsing FunctionX: "+m),v=!0}if(!v)try{i=y.parse(A)}catch(e){console.log("Analytic curve error parsing FunctionY: "+A),v=!0}if(v)return void t.getController().invokeAction("OnError");var P=(p-E)/(S-1),D=[],I={},_=t.getParameters();for(var C in _)I[C]=_[C];try{for(var R=0,T=E;T<=p;T+=P){I[h]=T;var N=n.evaluate(I),O=i.evaluate(I);isNaN(N)||isNaN(O)||(D[R]=[],D[R][0]=N,D[R++][1]=O)}}catch(e){t.getController().invokeAction("OnError")}r(D,l-g,u-c,a[0],a[1]);var M=t.getStyle();M.getDrawFill()&&"none"!=M.getFillColor()&&(e.fillStyle=M.getFillColor(),e.fill()),M.getDrawLines()&&(e.lineWidth=M.getLineWidth(),e.strokeStyle=M.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.arrow=function(e,t){function r(t,r,i,o,a,s,l,u,g){e.save(),o/=2,a/=2;var c=0==u?Math.PI/2:Math.atan(g/u);switch(c+=u<0?-Math.PI/2:Math.PI/2,i){case n.TRIANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,a/2),e.lineTo(o,a/2),e.lineTo(0,-a/2),e.lineTo(-o,a/2),e.closePath();break;case n.ANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(o,a),e.lineTo(0,0),e.lineTo(-o,a);break;case n.LINE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(o,0),e.lineTo(-o,0);break;case n.RECTANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,-a),e.lineTo(o,-a),e.lineTo(o,a),e.lineTo(-o,a),e.lineTo(-o,-a),e.closePath();break;case n.POINTED:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,a/4),e.lineTo(o,a),e.lineTo(0,-a/4),e.lineTo(-o,a),e.closePath();break;case n.CIRCLE:var S=o<a?o:a;e.beginPath(),e.translate(t,r),e.arc(0,0,S,0,2*Math.PI,!1);break;case n.DIAMOND:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,-a),e.lineTo(o,0),e.lineTo(0,a),e.lineTo(-o,0),e.closePath();break;case n.INVTRIANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(0,-a/2),e.lineTo(-o,-a/2),e.lineTo(0,a/2),e.lineTo(o,-a/2),e.closePath();break;case n.INVANGLE:e.beginPath(),e.translate(t,r),e.rotate(c),e.moveTo(-o,-a),e.lineTo(0,0),e.lineTo(o,-a);break;case n.WEDGE:case n.CURVE:console.log("Type of Arrow: not supported")}"none"!=l&&(i!=n.ANGLE&&i!=n.INVANGLE&&(e.fillStyle=l,e.fill()),i!=n.POINTED&&(e.lineWidth=s,e.strokeStyle=l,e.stroke())),e.restore()}var n=EJSS_DRAWING2D.Arrow,i=t.getPixelPosition(),o=t.getPixelSizes(),a=t.getRelativePositionOffset(o),s=i[0]+a[0],l=i[1]+a[1],u=o[0]/2,g=o[1]/2;if(0!=o[0]||0!=o[1]){e.beginPath(),e.moveTo(s-u,l-g),e.lineTo(s+u,l+g);var c=t.getStyle();if(c.getDrawFill()&&"none"!=c.getFillColor()&&(e.fillStyle=c.getFillColor(),e.fill()),c.getDrawLines()&&(e.lineWidth=c.getLineWidth(),e.strokeStyle=c.getLineColor(),e.stroke()),t.getMarkEnd()!=n.NONE){var S=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([o[0],o[1]]),d=0!=S&&S<t.getMarkEndWidth()?S:t.getMarkEndWidth(),f=0!=S&&S<t.getMarkEndHeight()?S:t.getMarkEndHeight(),E="none"==t.getMarkEndColor()?t.getStyle().getLineColor():t.getMarkEndColor(),p=t.getMarkEndStroke()<0?t.getStyle().getLineWidth():t.getMarkEndStroke();r(s+u,l+g,t.getMarkEnd(),d,f,p,E,u,g)}if(t.getMarkMiddle()!=n.NONE){var h=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([o[0],o[1]]),m=0!=h&&h<t.getMarkMiddleWidth()?h:t.getMarkMiddleWidth(),A=0!=h&&h<t.getMarkMiddleHeight()?h:t.getMarkMiddleHeight(),E="none"==t.getMarkMiddleColor()?t.getStyle().getLineColor():t.getMarkMiddleColor(),p=t.getMarkMiddleStroke()<0?t.getStyle().getLineWidth():t.getMarkMiddleStroke();r(s,l,t.getMarkMiddle(),m,A,p,E,u,g)}if(t.getMarkStart()!=n.NONE){var y=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([o[0],o[1]]),v=0!=y&&y<t.getMarkStartWidth()?y:t.getMarkStartWidth(),P=0!=y&&y<t.getMarkStartHeight()?y:t.getMarkStartHeight(),E="none"==t.getMarkStartColor()?t.getStyle().getLineColor():t.getMarkStartColor(),p=t.getMarkStartStroke()<0?t.getStyle().getLineWidth():t.getMarkStartStroke();r(s-u,l-g,t.getMarkStart(),v,P,p,E,u,g)}}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.axis=function(e,t){function r(t,r,n,i,o,a){o==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?(a&&(i=-i,r=-r),e.moveTo(t,r-i),e.lineTo(t,r+i)):(e.moveTo(t-n,r),e.lineTo(t+n,r))}function n(t,r,n,i){i==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?(e.moveTo(t-n/2,r),e.lineTo(t+n/2,r)):(e.moveTo(t,r-n/2),e.lineTo(t,r+n/2))}function i(r,n,i,o,a){e.save();var o=t.getFont(),s="";s+="none"!=o.getFontStyle()?o.getFontStyle()+" ":"",s+="none"!=o.getFontWeight()?o.getFontWeight()+" ":"",s+=o.getFontSizeString()+"px ",s+=o.getFontFamily(),e.font=s,e.fillStyle=o.getFillColor(),a?r-=e.measureText(i).width/2+.5:n+=o.getFontSize()/2,e.fillText(i,r,n),e.restore()}if(t.getShow()){var o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1],g=a[0]/2,c=a[1]/2,S=t.getStyle(),d=t.getOrient(),f=t.getInvertedScaleY();e.beginPath(),r(l,u,g,c,d,f);var E=d==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?Math.abs(a[1]):Math.abs(a[0]),p=t.getTicksMode();if(p==EJSS_DRAWING2D.Axis.SCALE_LOG){var h=t.getScale();if(h[0]>0&&h[1]>0){var m=t.getTicks(),A=t.getScalePrecision(),y=t.getTicksSize();EJSS_GRAPHICS.GraphicsUtils.drawLogTicks(l,u,g,c,E,y,h,m,d,n);var v=t.getFont(),P=t.getTextPosition();EJSS_GRAPHICS.GraphicsUtils.drawLogTicksText(l,u,g,c,m,y,h,A,v,P,d,i)}}else if(p==EJSS_DRAWING2D.Axis.SCALE_NUM){var D=0,I=0;if(t.getAutoTicks())for(var _=t.getAutoStepMin(),C=t.getAutoTicksRange(),R=C.length-1;R>=0&&(D=Math.abs(E/C[R]),!(1.001*D>=_));R--);else{var m=t.getTicks();0!=m?D=E/m:(D=t.getStep(),I=t.getTickStep())}var A=t.getScalePrecision(),h=t.getScale();if(0==I)var T=Math.abs((h[1]-h[0])*D/E);else{var T=I;D=Math.abs(T*E/(h[1]-h[0]))}var N=Math.pow(10,A),O=Math.round(T*N)/N;O>0&&(T=O,D=Math.abs(O*E/(h[1]-h[0])));var M=t.getFixedTick(),b=h[1];isNaN(M)||(b=M<h[0]?M+(Math.floor((h[0]-M)/T)+1)*T:M>h[1]?M-(Math.floor((M-h[1])/T)+1)*T:M);var G=Math.abs((h[0]-b)%T),x=Math.abs(G-T);(G<.001||x<.001)&&(G=0);var L=E*G/Math.abs(h[1]-h[0]),y=t.getTicksSize();EJSS_GRAPHICS.GraphicsUtils.drawDecTicks(l,u,g,c,y,D,L,d,f,n);var v=t.getFont(),P=t.getTextPosition();EJSS_GRAPHICS.GraphicsUtils.drawDecTicksText(l,u,g,c,y,D,L,h,A,T,G,v,P,d,f,i)}var S=t.getStyle();S.getDrawFill()&&"none"!=S.getFillColor()&&(e.fillStyle=S.getFillColor(),e.fill()),S.getDrawLines()&&(e.lineWidth=S.getLineWidth(),e.strokeStyle=S.getLineColor(),e.stroke())}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.byteRaster=function(e,t){if(t.getDataChanged()){var r=t.getData(),n=t.getColorMapper().getColors(),i=r.length,o=r[0].length,a=t.getColorMapper().getNumberOfColors(),s=t.getPixelPosition(),l=t.getPixelSizes(),u=t.getRelativePositionOffset(l),g=s[0]+u[0],c=s[1]+u[1],S=Math.abs(l[0]/2),d=Math.abs(l[1]/2),f=e.canvas.id;EJSS_SVGGRAPHICS.Utils.ImageDataCanvas(i,o,a,r,n,function(t){var r=document.getElementById(f);e=r.getContext("2d"),e.putImageData(t,g-S,c-d)}),t.setDataChanged(!1)}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.cellLattice=function(e,t){function r(t,r,n,i,o,a){e.beginPath(),0==o&&(o=Math.abs(n-t));for(var s=t;s<=n;s+=o)e.moveTo(s,r),e.lineTo(s,i);0==a&&(a=Math.abs(r-i));for(var s=i;s>=r;s-=a)e.moveTo(t,s),e.lineTo(n,s)}function n(t,r,n,i,o){e.beginPath();var a=n/2,s=i/2;e.moveTo(t-a,r+s),e.lineTo(t+a,r+s),e.lineTo(t+a,r-s),e.lineTo(t-a,r-s),e.lineTo(t-a,r+s),e.fillStyle=o,e.fill(),e.lineWidth=1,e.strokeStyle=o,e.stroke()}function i(t,n,i,o,a,s,l){var u=i/2,g=o/2,c=t-u,S=t+u,d=n+g,f=n-g;r(c,d,S,f,a,s),l.getDrawFill()&&"none"!=l.getFillColor()&&(e.fillStyle=l.getFillColor(),e.fill()),l.getDrawLines()&&(e.lineWidth=l.getLineWidth(),e.strokeStyle=l.getLineColor(),e.stroke())}for(var o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1],g=a[0]/2,c=a[1]/2,S=t.getStyle(),d=t.getData(),f=t.getColorMapper().getColors(),E=d.length,p=d[0].length,h=Math.abs(a[0]/E),m=Math.abs(a[1]/p),A=l-g+h/2,y=u-c-m/2,v=0;v<p;v++)for(var P=0;P<E;P++)n(A+h*P,y-m*v,h,m,f[d[P][v]]);var D=t.getShowGrid();D&&i(l,u,a[0],a[1],h,m,S)};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.cursor=function(e,t){var r=t.getPixelPosition(),n=t.getCursorType(),i=t.getGroupPanel(),o=i.getRealWorldCoordinates(),a=i._26([o[0],o[2]]),s=i._26([o[1],o[3]]);if(e.beginPath(),n!=EJSS_DRAWING2D.Cursor.VERTICAL){var l=a[0],u=s[0],g=r[1];g>a[1]?g=a[1]:g<s[1]&&(g=s[1]),e.moveTo(l,g),e.lineTo(u,g)}if(n!=EJSS_DRAWING2D.Cursor.HORIZONTAL){var c=r[0],S=a[1],d=s[1];c<a[0]?c=a[0]:c>s[0]&&(c=s[0]),e.moveTo(c,S),e.lineTo(c,d)}var f=t.getStyle();f.getDrawFill()&&"none"!=f.getFillColor()&&(e.fillStyle=f.getFillColor(),e.fill()),f.getDrawLines()&&(e.lineWidth=f.getLineWidth(),e.strokeStyle=f.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.ellipse=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=Math.abs(n[0]),l=Math.abs(n[1]),u=.5522848,g=o-s/2,c=a-l/2;ox=s/2*u,oy=l/2*u,xe=g+s,ye=c+l,e.beginPath(),e.moveTo(g,a),e.bezierCurveTo(g,a-oy,o-ox,c,o,c),e.bezierCurveTo(o+ox,c,xe,a-oy,xe,a),e.bezierCurveTo(xe,a+oy,o+ox,ye,o,ye),e.bezierCurveTo(o-ox,ye,g,a+oy,g,a);var S=t.getStyle();S.getDrawFill()&&"none"!=S.getFillColor()&&(e.fillStyle=S.getFillColor(),e.fill()),S.getDrawLines()&&(e.lineWidth=S.getLineWidth(),e.strokeStyle=S.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.grid=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2,u=t.getShowX(),g=t.getShowY();if(u){e.beginPath();var c=t.getTicksXMode();if(c==EJSS_DRAWING2D.Grid.SCALE_LOG){var S=t.getScaleX();if(S[0]>0&&S[1]>0){var d=t.getTicksX(),f=o-s,E=o+s,p=a+l,h=a-l;EJSS_GRAPHICS.GraphicsUtils.drawLogGrid(f,p,E,h,d,S,1,function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)})}}else if(c==EJSS_DRAWING2D.Grid.SCALE_NUM){var m=0,A=0;if(t.getAutoTicksX())for(var y=t.getAutoStepXMin(),v=t.getAutoTicksRangeX(),P=v.length-1;P>=0&&(m=Math.abs(n[0]/v[P]),!(m>=y));P--);else{var d=t.getTicksX();0!=d?m=Math.abs(n[0]/d):(m=t.getStepX(),A=t.getTickStepX())}var D=t.getScalePrecisionX(),S=t.getScaleX();if(0==A)var I=Math.abs((S[1]-S[0])*m/n[0]);else{var I=A;m=Math.abs(I*n[0]/(S[1]-S[0]))}var _=Math.pow(10,D),C=Math.round(I*_)/_;C>0&&(I=C,m=Math.abs(C*n[0]/(S[1]-S[0])));var R=t.getFixedTickX(),T=S[1];isNaN(R)||(T=R<S[0]?R+(Math.floor((S[0]-R)/I)+1)*I:R>S[1]?R-(Math.floor((R-S[1])/I)+1)*I:R);var N=Math.abs((S[0]-T)%I),O=Math.abs(N-I);(N<.001||O<.001)&&(N=0);var M=Math.abs(n[0]*N/(S[1]-S[0])),f=o-s,E=o+s,p=a+l,h=a-l;EJSS_GRAPHICS.GraphicsUtils.drawDecGrid(f,p,E,h,M,m,1,function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)})}e.lineWidth=t.getLineWidthX(),e.strokeStyle=t.getLineColorX(),e.stroke()}if(g){e.beginPath();var b=t.getTicksYMode();if(b==EJSS_DRAWING2D.Grid.SCALE_LOG){var G=t.getScaleY();if(G[0]>0&&G[1]>0){var x=t.getTicksY(),f=o-s,E=o+s,p=a+l,h=a-l;EJSS_GRAPHICS.GraphicsUtils.drawLogGrid(f,p,E,h,x,G,-1,function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)})}}else if(b==EJSS_DRAWING2D.Grid.SCALE_NUM){var L=0,J=0;if(t.getAutoTicksY())for(var w=t.getAutoStepYMin(),W=t.getAutoTicksRangeY(),P=W.length-1;P>=0&&(L=Math.abs(n[1]/W[P]),!(L>=w));P--);else{var x=t.getTicksY();0!=x?L=Math.abs(n[1]/x):(L=t.getStepY(),J=t.getTickStepY())}var k=t.getScalePrecisionY(),G=t.getScaleY();if(0==J)var F=Math.abs((G[1]-G[0])*L/n[1]);else{var F=J;L=Math.abs(F*n[1]/(G[1]-G[0]))}var V=Math.pow(10,k),B=Math.round(F*V)/V;B>0&&(F=B,L=Math.abs(B*n[1]/(G[1]-G[0])));var R=t.getFixedTickY(),T=G[1];isNaN(R)||(T=R<G[0]?R+(Math.floor((G[0]-R)/F)+1)*F:R>G[1]?R-(Math.floor((R-G[1])/F)+1)*F:R);var N=Math.abs((G[0]-T)%F),O=Math.abs(N-F);(N<.001||O<.001)&&(N=0);var H=Math.abs(n[1]*N/(G[1]-G[0])),f=o-s,E=o+s,p=a+l,h=a-l;EJSS_GRAPHICS.GraphicsUtils.drawDecGrid(f,p,E,h,H,L,-1,function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)})}e.lineWidth=t.getLineWidthY(),e.strokeStyle=t.getLineColorY(),e.stroke()}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.histogram=function(e,t){function r(t,r,n,i,o){e.beginPath(),e.moveTo(t,i),e.lineTo(t,n),e.lineTo(r,n),e.lineTo(r,i),o.getDrawFill()&&"none"!=o.getFillColor()&&(e.fillStyle=o.getFillColor(),e.fill()),o.getDrawLines()&&(e.lineWidth=o.getLineWidth(),e.strokeStyle=o.getLineColor(),e.stroke())}for(var n=t.getPixelPosition(),i=t.getPixelSizes(),o=t.getRelativePositionOffset(i),a=n[0]+o[0],s=n[1]+o[1],l=i[0]/2,u=i[1]/2,g=t.getStyle(),c=t.getDiscrete(),S=t.getBinWidth()/2,d=t.getBars(),f=t.getGroupPanel().getPixelPositionWorldOrigin()[1],E=0;E<d.length;E++){var p,h,m=d[E][0];c?p=h=a-l+m*i[0]:(p=a-l+(m-S)*i[0],h=a-l+(m+S)*i[0]);var A=s-u+d[E][1]*i[1];r(p,h,A,f,g)}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.image=function(e,t,r){var n=t.getPixelPosition(),i=t.getPixelSizes(),o=t.getRelativePositionOffset(i),a=n[0]+o[0],s=n[1]+o[1],l=Math.abs(i[0]/2),u=Math.abs(i[1]/2),g=new Image;g.onload=function(){e.save(),r(t),e.drawImage(g,a-l,s-u,Math.abs(i[0]),Math.abs(i[1])),e.restore()};var c=t.getEncode();c.length>0?g.src="data:png;base64,"+c:g.src=t.getImageUrl(),t.setChangedImage(!1)};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.mesh=function(e,t){function r(t,r,n,i,o){e.beginPath();for(var a=0;a<n;a++)0==a?e.moveTo(t[0],r[0]):e.lineTo(t[a],r[a]);e.lineTo(t[0],r[0]);var s=i.indexToColor(o);e.fillStyle=s,e.fill(),e.lineWidth=1.25,e.strokeStyle=s,e.stroke()}function n(t,r,n,i){e.beginPath();for(var o=t.length,a=0;a<o;a++)0==a?e.moveTo(t[0],r[0]):e.lineTo(t[a],r[a]);e.lineTo(t[0],r[0]),n&&i.getDrawFill()&&"none"!=i.getFillColor()&&(e.fillStyle=i.getFillColor(),e.fill()),i.getDrawLines()&&(e.lineWidth=i.getLineWidth(),e.strokeStyle=i.getLineColor(),e.stroke())}function i(t,r,n,i){e.beginPath();for(var o=t.length,a=0;a<o;a++)0==a?e.moveTo(t[0],r[0]):e.lineTo(t[a],r[a]);e.lineTo(t[0],r[0]),e.lineWidth=i+.5,e.strokeStyle=n,e.stroke()}function o(t,r,n,i){for(var o=0;o<t.length;o++){var a=t[o],s=r[o],l=n[o][0],u=n[o][1],g=EJSS_TOOLS.Mathematics.norm([l,u]),c=l*i/g,S=u*i/g;if(0!=c||0!=S){var d=.3*EJSS_TOOLS.Mathematics.norm([c,S]),E=0!=d&&d<12?d:12,h=Math.atan2(c,S);e.beginPath(),e.moveTo(a,s),e.lineTo(a+c-E*Math.cos(h),s+S-E*Math.sin(h)),e.lineTo(a+c-E*Math.cos(h-Math.PI/6),s+S-E*Math.sin(h-Math.PI/6)),e.lineTo(a+c,f+p),e.lineTo(a+c-E*Math.cos(h+Math.PI/6),s+S-E*Math.sin(h+Math.PI/6)),e.lineTo(a+c-E*Math.cos(h),s+S-E*Math.sin(h)),e.lineWidth=1,e.strokeStyle="black",e.stroke()}}}var a,s,l,u,g=t.getPixelPosition(),c=t.getPixelSizes(),S=t.getRelativePositionOffset(c),d=g[0]+S[0],f=g[1]+S[1],E=c[0]/2,p=c[1]/2,h=t.getPoints();if(null!=h){var m=h.length;a=new Array(m),s=new Array(m);for(var A=0;A<m;A++)a[A]=d-E+h[A][0]*c[0],s[A]=f-p+h[A][1]*c[1];var y=t.getCells(),v=t.getFieldAtPoints();if(v?l=EJSS_GRAPHICS.GraphicsUtils.buildCells(a,s,y,v,!1):(v=t.getFieldAtCells(),l=EJSS_GRAPHICS.GraphicsUtils.buildCells(a,s,y,v,!0)),null!=y){var P=t.getStyle();if(null!=v){var D=t.getColorCoded();EJSS_GRAPHICS.GraphicsUtils.drawPolygons(l,D,function(e,t){n(e,t,!1,P)},function(e,t,n,i,o){r(e,t,n,i,o)})}else EJSS_GRAPHICS.GraphicsUtils.drawPolygons(l,D,function(e,t){n(e,t,!0,P)},function(e,t,r,n,i){})}var I=t.getBoundary();if(t.getDrawBoundary()&&null!=I){var _=t.getBoundaryLabels(),C=t.getBoundaryColors(),R=t.getBoundaryLineWidth();u=EJSS_GRAPHICS.GraphicsUtils.buildBoundary(a,s,I),EJSS_GRAPHICS.GraphicsUtils.drawBoundary(u,_,C,function(e,t,r){i(e,t,r,R)})}if(t.getDataType()>=4&&null!=v)for(var T=t.getVectorLength()*c[0],A=0,N=y.length;A<N;A++)o(mCellA[A],mCellB[A],v[A],T)}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.pipe=function(e,t){var r=t.getPoints();if(r&&!(r.length<=0)){var n=t.getPixelPosition(),i=t.getPixelSizes(),o=t.getRelativePositionOffset(i),a=n[0]+o[0],s=n[1]+o[1],l=Math.abs(i[0]),u=Math.abs(i[1]),g=a-l/2,c=s+u/2,S=t.getStyle();e.beginPath(),e.moveTo(g,c);for(var a=g,s=c,d=0,f=r.length;d<f;d++){var E=r[d];a+=Math.round(E[0]*l),s+=Math.round(-E[1]*u),e.lineTo(a,s)}S.getDrawLines()&&(e.lineWidth=2*S.getLineWidth()+t.getPipeWidth(),e.strokeStyle=S.getLineColor(),e.stroke()),e.beginPath(),e.moveTo(g,c);for(var a=g,s=c,d=0,f=r.length;d<f;d++){var E=r[d];a+=Math.round(E[0]*l),s+=Math.round(-E[1]*u),e.lineTo(a,s)}S.getDrawLines()&&(e.lineWidth=t.getPipeWidth(),e.strokeStyle=S.getFillColor(),e.stroke())}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.point=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1];e.beginPath(),e.arc(o,a,2,0,2*Math.PI);var s=t.getStyle();e.fillStyle=s.getFillColor(),e.fill()};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.polygon=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2;e.beginPath();for(var u=t.getPoints(),g=0;g<u.length;g++){var c=u[g],S=o-s+c[0]*n[0],d=a-l+c[1]*n[1];0==g?e.moveTo(S,d):e.lineTo(S,d)}var f=t.getStyle();f.getDrawFill()&&"none"!=f.getFillColor()&&(e.fillStyle=f.getFillColor(),e.fill()),f.getDrawLines()&&(e.lineWidth=f.getLineWidth(),e.strokeStyle=f.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.rectangle=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2;e.beginPath(),e.moveTo(o-s,a+l),e.lineTo(o+s,a+l),e.lineTo(o+s,a-l),e.lineTo(o-s,a-l),e.lineTo(o-s,a+l);var u=t.getStyle();u.getDrawFill()&&"none"!=u.getFillColor()&&(e.fillStyle=u.getFillColor(),e.fill()),u.getDrawLines()&&(e.lineWidth=u.getLineWidth(),e.strokeStyle=u.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.roundRectangle=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=Math.abs(n[0]),l=Math.abs(n[1]),u=o-s/2,g=a-l/2,c=Math.abs(t.getCornerRadius());e.beginPath(),e.moveTo(u+c,g),e.lineTo(u+s-c,g),e.quadraticCurveTo(u+s,g,u+s,g+c),e.lineTo(u+s,g+l-c),e.quadraticCurveTo(u+s,g+l,u+s-c,g+l),e.lineTo(u+c,g+l),e.quadraticCurveTo(u,g+l,u,g+l-c),e.lineTo(u,g+c),e.quadraticCurveTo(u,g,u+c,g),e.closePath();var S=t.getStyle();S.getDrawFill()&&"none"!=S.getFillColor()&&(e.fillStyle=S.getFillColor(),e.fill()),S.getDrawLines()&&(e.lineWidth=S.getLineWidth(),e.strokeStyle=S.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.segment=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2;e.beginPath(),e.moveTo(o-s,a-l),e.lineTo(o+s,a+l);var u=t.getStyle();u.getDrawFill()&&"none"!=u.getFillColor()&&(e.fillStyle=u.getFillColor(),e.fill()),u.getDrawLines()&&(e.lineWidth=u.getLineWidth(),e.strokeStyle=u.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.spring=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=n[0]/2,l=n[1]/2,u=t.getGroupPanel().toPixelMod([t.getRadius(),0])[0];e.beginPath(),EJSS_GRAPHICS.GraphicsUtils.drawSpring(t.getLoops(),t.getPointsPerLoop(),u,t.getSolenoid(),t.getThinExtremes(),o-s,a-l,n[0],n[1],function(t,r){e.moveTo(t,r)},function(t,r){e.lineTo(t,r)});var g=t.getStyle();g.getDrawFill()&&"none"!=g.getFillColor()&&(e.fillStyle=g.getFillColor(),e.fill()),g.getDrawLines()&&(e.lineWidth=g.getLineWidth(),e.strokeStyle=g.getLineColor(),e.stroke())};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.tank=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=Math.abs(n[0]/2),l=Math.abs(n[1]/2),u=t.getPixelSizeOf(0,t.getLevel()),g=o-s,c=o+s,S=a+l,d=a-l,f=S+u[1],E=t.getStyle();e.beginPath(),e.moveTo(g+u[0],f),e.lineTo(g,S),e.lineTo(c,S),e.lineTo(c+u[0],f),e.fillStyle=t.getLevelColor(),e.fill(),e.beginPath(),e.moveTo(g,d),e.lineTo(g,S),e.lineTo(c,S),e.lineTo(c,d),E.getDrawFill()&&"none"!=E.getFillColor()&&(e.fillStyle=E.getFillColor(),e.fill()),e.lineWidth=E.getLineWidth(),e.strokeStyle=E.getLineColor(),e.stroke()};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.text=function(e,t){var r=t.getFont(),n="";n+="none"!=r.getFontStyle()?r.getFontStyle()+" ":"",n+="none"!=r.getFontWeight()?r.getFontWeight()+" ":"",n+=r.getFontSizeString()+(r.getFontSizeString().toString().indexOf("px")>-1?" ":"px "),n+=r.getFontFamily(),e.font=n;var i=t.getText(),o=t.getPixelPosition(),a=t.getFramed()?4:0,s=[e.measureText(i).width+2*a,r.getFontSize()+2*a],l=EJSS_DRAWING2D.Element.getSWRelativePositionOffset(t.getRelativePosition(),s[0],s[1]),u=t.getMarginX(),g=t.getMarginY(),c=o[0]+l[0]+u+a,S=o[1]+l[1]+g-a;if(t.getFramed()){var d=a,f=a,E=s[0]-2*a,p=s[1]-2*a;if(E>0){var h=S+d,m=S-p-d,A=c-f,y=c+E+d;e.save(),e.beginPath(),e.moveTo(A,h),e.lineTo(y,h),e.lineTo(y,m),e.lineTo(A,m),e.lineTo(A,h);var v=t.getStyle();v.getDrawFill()&&"none"!=v.getFillColor()&&(e.fillStyle=v.getFillColor(),e.fill()),v.getDrawLines()&&(e.lineWidth=v.getLineWidth(),e.strokeStyle=v.getLineColor(),e.stroke()),e.restore()}}var P=0;switch(t.getWritingMode()){case EJSS_DRAWING2D.Text.MODE_TOPDOWN:P=Math.PI/2;break;case EJSS_DRAWING2D.Text.MODE_RIGTHLEFT:P=Math.PI;break;case EJSS_DRAWING2D.Text.MODE_DOWNTOP:P=3*Math.PI/2;break;case EJSS_DRAWING2D.Text.MODE_LEFTRIGHT:P=0}e.translate(o[0]+u,o[1]+g),e.rotate(P),e.translate(-(o[0]+u),-(o[1]+g)),e.fillStyle=r.getFillColor(),e.fillText(t.getText(),c,S)};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.trace=function(e,t){function r(t,r,n,i,o){e.beginPath();for(var a=0;a<t.length;a++){var s=t[a],l=r+s[0]*i,u=n+s[1]*o,g=s[2];0==a||0==g?e.moveTo(l,u):e.lineTo(l,u)}}function n(t,r,n,i){var o=t,a=r,s=Math.abs(n[0]),l=Math.abs(n[1]),u=.5522848,g=o-s/2,c=a-l/2;ox=s/2*u,oy=l/2*u,xe=g+s,ye=c+l,e.beginPath(),e.moveTo(g,a),e.bezierCurveTo(g,a-oy,o-ox,c,o,c),e.bezierCurveTo(o+ox,c,xe,a-oy,xe,a),e.bezierCurveTo(xe,a+oy,o+ox,ye,o,ye),e.bezierCurveTo(o-ox,ye,g,a+oy,g,a),i.getDrawFill()&&"none"!=i.getFillColor()&&(e.fillStyle=i.getFillColor(),e.fill()),i.getDrawLines()&&(e.lineWidth=i.getLineWidth(),e.strokeStyle=i.getLineColor(),e.stroke())}function i(t,r,n,i){var o=t,a=r,s=Math.abs(n[0]),l=Math.abs(n[1]);e.beginPath(),e.rect(o-s/2,a-l/2,s,l),i.getDrawFill()&&"none"!=i.getFillColor()&&(e.fillStyle=i.getFillColor(),e.fill()),i.getDrawLines()&&(e.lineWidth=i.getLineWidth(),e.strokeStyle=i.getLineColor(),e.stroke())}function o(t,r,n,i,o,a){e.beginPath(),e.moveTo(t,o),e.lineTo(t,r),e.lineTo(n,i),e.lineTo(n,o),a.getDrawFill()&&"none"!=a.getFillColor()&&(e.fillStyle=a.getFillColor(),e.fill()),a.getDrawLines()&&(e.lineWidth=a.getLineWidth(),e.strokeStyle=a.getLineColor(),e.stroke())}var a=t.getPixelPosition(),s=t.getPixelSizes(),l=t.getRelativePositionOffset(s),u=a[0]+l[0],g=a[1]+l[1],c=s[0]/2,S=s[1]/2;r(t.getPoints(),u-c,g-S,s[0],s[1]);var d=t.getStyle();d.getDrawFill()&&"none"!=d.getFillColor()&&(e.fillStyle=d.getFillColor(),e.fill()),d.getDrawLines()&&(e.lineWidth=d.getLineWidth(),e.strokeStyle=d.getLineColor(),e.stroke());for(var f,E,p=t.getPoints(),h=0;h<p.length;h++){var m=p[h],A=u-c+m[0]*s[0],y=g-S+m[1]*s[1],v=m[3],P=m[4],D=[m[5],m[6]];if(v==EJSS_DRAWING2D.Trace.ELLIPSE)n(A,y,D,P);else if(v==EJSS_DRAWING2D.Trace.RECTANGLE)i(A,y,D,P);else if(v==EJSS_DRAWING2D.Trace.BAR){var I=t.getGroupPanel()._26([0,0])[1];D[1]=I-y,y+=D[1]/2,i(A,y,D,P)}else if(v==EJSS_DRAWING2D.Trace.AREA){if(0!=h){var I=t.getGroupPanel()._26([0,0])[1],_=u-c+f*s[0],C=g-S+E*s[1];o(mMark,_,C,A,y,I,P)}f=m[0],E=m[1]}}};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.trail=function(e,t){function r(t,r,n,i,o,a,s){if(!(r<=0)){e.beginPath();for(var l=0;l<r;l++){var u=t[l],g=i+u[0]*a,c=o+u[1]*s,S=u[2];0==l||0==S?e.moveTo(g,c):e.lineTo(g,c)}n.getDrawLines()&&(e.lineWidth=n.getLineWidth(),e.strokeStyle=n.getLineColor(),e.stroke())}}var n=t.getPixelPosition(),i=t.getPixelSizes(),o=t.getRelativePositionOffset(i),a=n[0]+o[0],s=n[1]+o[1],l=i[0]/2,u=i[1]/2,g=a-l,c=s-u,S=i[0],d=i[1],f=t.getSegmentsCount();if(f>0)for(var E=0;E<f;E++){var p=t.getSegmentPoints(E).length;r(t.getSegmentPoints(E),p,t.getSegmentStyle(E),g,c,S,d)}var p=t.getCurrentPoints().length;r(t.getCurrentPoints(),p,t.getStyle(),g,c,S,d)};var EJSS_CANVASGRAPHICS=EJSS_CANVASGRAPHICS||{};EJSS_CANVASGRAPHICS.wheel=function(e,t){var r=t.getPixelPosition(),n=t.getPixelSizes(),i=t.getRelativePositionOffset(n),o=r[0]+i[0],a=r[1]+i[1],s=Math.abs(n[0]),l=Math.abs(n[1]),u=n[0]/2,g=n[1]/2,c=.5522848,S=o-s/2,d=a-l/2;ox=s/2*c,oy=l/2*c,xe=S+s,ye=d+l,e.beginPath(),e.moveTo(S,a),e.bezierCurveTo(S,a-oy,o-ox,d,o,d),e.bezierCurveTo(o+ox,d,xe,a-oy,xe,a),e.bezierCurveTo(xe,a+oy,o+ox,ye,o,ye),e.bezierCurveTo(o-ox,ye,S,a+oy,S,a),e.moveTo(o-u,a),e.lineTo(o+u,a),e.moveTo(o,a-g),e.lineTo(o,a+g);var f=t.getStyle();f.getDrawFill()&&"none"!=f.getFillColor()&&(e.fillStyle=f.getFillColor(),e.fill()),f.getDrawLines()&&(e.lineWidth=f.getLineWidth(),e.strokeStyle=f.getLineColor(),e.stroke())};var EJSS_GRAPHICS=EJSS_GRAPHICS||{};EJSS_GRAPHICS.CanvasGraphics={getOffsetRect:function(e){return EJSS_GRAPHICS.GraphicsUtils.getOffsetRect(e)}},EJSS_GRAPHICS.canvasGraphics=function(e){var t=EJSS_INTERFACE.canvas(e),r=t.getDOMElement(),n=t.getContext();return t.getEventContext=function(){return r},t.getBox=function(){var e=EJSS_GRAPHICS.CanvasGraphics.getOffsetRect(t);return e.width-=1,e.height-=1,e},t.reset=function(){var e=EJSS_GRAPHICS.CanvasGraphics.getOffsetRect(t);n.clearRect(0,0,e.width,e.height)},t.draw=function(e,r){for(var n=0,i=e.length;n<i;n++){var o=e[n];o.isGroupVisible()&&t.drawElement(o,t.transformElement)}},t.drawElement=function(e,t){var r=EJSS_DRAWING2D.Shape,i=e._23();if("ElementImage"===i)EJSS_CANVASGRAPHICS.image(n,e,t);else{switch(n.save(),t(e),i){case"ElementCustom":var o=e.getFunction();o&&o(n,e);break;case"ElementShape":switch(e.getShapeType()){default:case r.ELLIPSE:EJSS_CANVASGRAPHICS.ellipse(n,e);break;case r.RECTANGLE:EJSS_CANVASGRAPHICS.rectangle(n,e);break;case r.ROUND_RECTANGLE:EJSS_CANVASGRAPHICS.roundRectangle(n,e);break;case r.WHEEL:EJSS_CANVASGRAPHICS.wheel(n,e);break;case r.NONE:case r.POINT:EJSS_CANVASGRAPHICS.point(n,e)}break;case"ElementSegment":EJSS_CANVASGRAPHICS.segment(n,e);break;case"ElementArrow":EJSS_CANVASGRAPHICS.arrow(n,e);break;case"ElementText":EJSS_CANVASGRAPHICS.text(n,e);break;case"ElementSpring":EJSS_CANVASGRAPHICS.spring(n,e);break;case"ElementTrail":EJSS_CANVASGRAPHICS.trail(n,e);break;case"ElementTrace":EJSS_CANVASGRAPHICS.trace(n,e);break;case"ElementGrid":EJSS_CANVASGRAPHICS.grid(n,e);break;case"ElementAxis":EJSS_CANVASGRAPHICS.axis(n,e);break;case"ElementCursor":EJSS_CANVASGRAPHICS.cursor(n,e);break;case"ElementPolygon":EJSS_CANVASGRAPHICS.polygon(n,e);break;case"ElementAnalyticCurve":EJSS_CANVASGRAPHICS.analyticCurve(n,e);break;case"ElementCellLattice":EJSS_CANVASGRAPHICS.cellLattice(n,e);break;case"ElementByteRaster":EJSS_CANVASGRAPHICS.byteRaster(n,e);break;case"ElementMesh":EJSS_CANVASGRAPHICS.mesh(n,e);break;case"ElementTank":EJSS_CANVASGRAPHICS.tank(n,e);break;case"ElementPipe":EJSS_CANVASGRAPHICS.pipe(n,e);break;case"ElementHistogram":EJSS_CANVASGRAPHICS.histogram(n,e);break;case"ElementVideo":Console.log("Not supported ElementVideo in Canvas!")}n.restore()}},t.transformElement=function(e){null!=e.getGroup()&&t.transformElement(e.getGroup());var r=e.getTransformation();if(Array.isArray(r))console.log("Array transformations are not supported in Canvas!");else if("string"==typeof r)console.log("SVG-based transformations are not supported in Canvas!");else if("number"==typeof r){var i=e.getPixelPosition();n.translate(i[0],i[1]),n.rotate(-r),n.translate(-i[0],-i[1])}},t._24=function(e){var r=e.getGutters();if(r.visible){var i=e.getInnerRect(),o=.5,a=.5,s=t.getBox(),l=s.width,u=s.height,g=e.getGuttersStyle(),c=e.getStyle();g.getDrawFill()&&(n.beginPath(),n.moveTo(o,a),n.lineTo(o,a+u),n.lineTo(o+l,a+u),n.lineTo(o+l,a),n.lineTo(o,a),n.moveTo(i.x,i.y),n.lineTo(i.x+i.width,i.y),n.lineTo(i.x+i.width,i.y+i.height),n.lineTo(i.x,i.y+i.height),n.lineTo(i.x,i.y),n.moveTo(o,a),n.closePath(),n.fillStyle=g.getFillColor(),n.fill()),g.getDrawLines()&&(n.beginPath(),n.moveTo(o,a),n.lineTo(o,a+u),n.lineTo(o+l,a+u),n.lineTo(o+l,a),n.lineTo(o,a),n.closePath(),n.lineWidth=g.getLineWidth(),n.strokeStyle=g.getLineColor(),n.stroke()),g.getDrawLines()&&(n.beginPath(),n.moveTo(i.x,i.y),n.lineTo(i.x+i.width,i.y),n.lineTo(i.x+i.width,i.y+i.height),n.lineTo(i.x,i.y+i.height),n.lineTo(i.x,i.y),n.closePath(),n.lineWidth=c.getLineWidth(),n.strokeStyle=c.getLineColor(),n.stroke())}},t.drawPanel=function(e){var r=.5,i=.5,o=t.getBox();n.beginPath(),n.rect(r,i,o.width,o.height);var a=e.getStyle();n.fillStyle=a.getFillColor(),n.fill(),a.getDrawLines()&&(n.lineWidth=a.getLineWidth(),n.strokeStyle=a.getLineColor(),n.stroke())},t};var EJSS_GRAPHICS=EJSS_GRAPHICS||{};EJSS_GRAPHICS.GraphicsUtils={getOffsetRect:function(e){var t,r,n,i,o=e.getDOMElement(),a=e.getWidth(),s=e.getHeight();t=parseFloat(a);var l=!isNaN(t)&&isFinite(a);r=parseFloat(s);var u=!isNaN(r)&&isFinite(s);if(o.getBoundingClientRect){var g=o.getElementById?o.getElementById(".myPanel"):null;if(g&&g.childElementCount>0)var c=g.getBoundingClientRect();else var c=o.getBoundingClientRect();n=c.top,i=c.left,l||(t=c.width),u||(r=c.height)}else if(void 0!==o.offsetTop)n=o.offsetTop,i=o.offsetLeft,l||(t=o.offsetWidth),u||(r=o.offsetHeight);else{for(var S=o.parentNode||document.getElementById(o.id).parentNode;S&&!S.offsetTop&&S&&!S.previousElementSibling&&!S.nextElementSibling;)S=S.parentNode;n=S.offsetTop,i=S.offsetLeft,l||(t=S.offsetWidth),u||(r=S.offsetHeight)}var d=document.body,f=document.documentElement,E=f.clientTop||d.clientTop||0,p=f.clientLeft||d.clientLeft||0;return n-=E,i-=p,{top:n,left:i,width:t,height:r,bottom:n+r,right:i+t}},drawSpring:function(e,t,r,n,i,o,a,s,l,u,g){var c=e*t,S=2*Math.PI/t;r<0&&(S*=-1);for(var d=t/2,f=[s,l,0],E=EJSS_TOOLS.Mathematics.normalTo(f),p=EJSS_TOOLS.Mathematics.normalize(EJSS_TOOLS.Mathematics.crossProduct(f,E)),h=0;h<=c;h++){var m;m=i?h<d?0:h<t?h-d:h>c-d?0:h>c-t?c-h-d:d:d;var A=Math.PI/2+h*S,y=Math.cos(A),v=Math.sin(A),P=o+h*s/c+m*r*(y*E[0]+v*p[0])/d,D=a+h*l/c+m*r*(y*E[1]+v*p[1])/d;if(0!=n){var I=m*Math.cos(2*h*Math.PI/t)/d;P+=n*I*s,D+=n*I*l}0==h?u(P,D):g(P,D)}},drawDecTicks:function(e,t,r,n,i,o,a,s,l,u){var g=EJSS_SVGGRAPHICS.Utils,c=e-r,S=e+r,d=t+n,f=t-n,E=g.crispValue(S),p=g.crispValue(f);if(s==EJSS_DRAWING2D.Axis.AXIS_VERTICAL)for(var h=p-a;h>=d-.5;h-=o)u(e,h,i,s);else for(var h=c+a;h<=E+.5;h+=o)u(h,t,i,s);
},drawDecTicksText:function(e,t,r,n,i,o,a,s,l,u,g,c,S,d,f,E){var p=EJSS_SVGGRAPHICS.Utils,h=e-r,m=e+r,A=t+n,y=t-n,v=p.crispValue(m),P=p.crispValue(y);if(d==EJSS_DRAWING2D.Axis.AXIS_VERTICAL)for(var D=0,I=P-a;I>=A-.5;I-=o,D++){if(f)var _=s[1]-g-u*D;else var _=s[0]+g+u*D;var C=parseFloat(_.toFixed(l)).toFixed(l);if(S==EJSS_DRAWING2D.Axis.TICKS_DOWN){var R=i/2;E(mGroup,e+R,I,C,c,!1)}else{var R=C.length*Math.floor(c.getFontSize()/2);R+=C.length*c.getNumberLetterSpacing(),R+=Math.floor(i/2),E(e-R,I,C,c,!1)}}else for(var D=0,I=h+a;I<=v+.5;I+=o,D++){var _=s[0]+g+u*D,C=parseFloat(_.toFixed(l)).toFixed(l);if(S==EJSS_DRAWING2D.Axis.TICKS_DOWN){var T=Math.floor(i/2)+2;E(I,t-i,C,c,!0)}else{var T=c.getFontSize()+Math.floor(i/2);E(I,t+T,C,c,!0)}}},drawLogTicks:function(e,t,r,n,i,o,a,s,l,u){var g=EJSS_SVGGRAPHICS.Utils,c=e-r,S=t-n,d=g.crispValue(S);if(l==EJSS_DRAWING2D.Axis.AXIS_VERTICAL)for(var f=Math.log(a[0])/Math.log(10),E=Math.log(a[1])/Math.log(10),p=E-f,h=Math.ceil(p),m=i/p,A=0;A<=h;A++)for(var y=Math.pow(10,A+f),v=Math.pow(10,A+f+1),P=v/s,D=0;D<s-1;D++){var I=y+D*P;if(0!=I&&I>=a[0]&&I<=a[1]){var _=Math.log(I)/Math.log(10),C=d-(_-f)*m;u(e,C,o,l)}}else for(var f=Math.log(a[0])/Math.log(10),E=Math.log(a[1])/Math.log(10),p=E-f,h=Math.ceil(p),m=i/p,A=0;A<=h;A++)for(var y=Math.pow(10,A+f),v=Math.pow(10,A+f+1),P=v/s,D=0;D<s-1;D++){var I=y+D*P;if(0!=I&&I>=a[0]&&I<=a[1]){var _=Math.log(I)/Math.log(10),C=c+(_-f)*m;u(C,t,o,l)}}},drawLogTicksText:function(e,t,r,n,i,o,a,s,l,u,g,c){var S=EJSS_SVGGRAPHICS.Utils,d=e-r,f=t-n,E=S.crispValue(f);if(g==EJSS_DRAWING2D.Axis.AXIS_VERTICAL)for(var p=Math.log(a[0])/Math.log(10),h=Math.log(a[1])/Math.log(10),m=h-p,A=Math.ceil(m),y=segsize/m,v=0;v<=A;v++)for(var P=Math.pow(10,v+p),D=Math.pow(10,v+p+1),I=D/i,_=0;_<i-1;_++){var C=P+_*I;if(0!=C&&C>=a[0]&&C<=a[1]){var R=Math.log(C)/Math.log(10),T=E-(R-p)*y;if(0==_)var N=C.toExponential(s);else var N=parseFloat((C/P).toFixed(s)).toFixed(s);if(u==EJSS_DRAWING2D.Axis.TICKS_DOWN){var O=o/2;c(e+O,T,N,l,!1)}else{var O=N.length*Math.floor(l.getFontSize()/2);O+=N.length*l.getNumberLetterSpacing(),O+=Math.floor(o/2),c(e-O,T,N,l,!1)}}}else for(var p=Math.log(a[0])/Math.log(10),h=Math.log(a[1])/Math.log(10),m=h-p,A=Math.ceil(m),y=segsize/m,v=0;v<=A;v++)for(var P=Math.pow(10,v+p),D=Math.pow(10,v+p+1),I=D/i,_=0;_<i-1;_++){var C=P+_*I;if(0!=C&&C>=a[0]&&C<=a[1]){var R=Math.log(C)/Math.log(10),T=d+(R-p)*y;if(0==_)var N=C.toExponential(s);else var N=parseFloat((C/P).toFixed(s)).toFixed(s);if(u==EJSS_DRAWING2D.Axis.TICKS_DOWN){var M=Math.floor(o/2)+2;c(T,t-o,N,l,!0)}else{var M=l.getFontSize()+Math.floor(o/2);c(T,t+M,N,l,!0)}}}},drawDecGrid:function(e,t,r,n,i,o,a,s,l){var u=EJSS_SVGGRAPHICS.Utils,g=u.crispValue(e),c=u.crispValue(r),S=u.crispValue(t),d=u.crispValue(n);if(a==-1){0==o&&(o=Math.abs(S-d));for(var f=d-i;f>=t-.5;f-=o)s(e,f),l(r,f)}else{0==o&&(o=Math.abs(c-g));for(var f=e+i;f<=c+.5;f+=o)s(f,t),l(f,n)}},drawLogGrid:function(e,t,r,n,i,o,a,s,l){var u=EJSS_SVGGRAPHICS.Utils,g=u.crispValue(e),c=u.crispValue(r),S=u.crispValue(t),d=u.crispValue(n),f="",E=Math.log(o[0])/Math.log(10),p=Math.log(o[1])/Math.log(10),h=p-E,m=Math.ceil(h);if(a==-1)var A=(d-S)/h;else var A=(c-g)/h;for(var y=0;y<=m;y++)for(var v=Math.pow(10,y+E),P=Math.pow(10,y+E+1),D=P/i,I=0;I<i-1;I++){var _=v+I*D;if(0!=_&&_>=o[0]&&_<=o[1]){var C=Math.log(_)/Math.log(10);if(a==-1){var R=d-(C-E)*A;s(g,R),l(c,R)}else{var R=g+(C-E)*A;s(R,S),l(R,d)}}}return f},buildCells:function(e,t,r,n,i){var o,a,s,l;if(null!=r&&r.length>0){var u=r.length;o=new Array(u),a=new Array(u),s=new Array(u),l=new Array(u);var g=1;null!=n&&(g=i?n[0][0].length:n[0].length);for(var c=0;c<u;c++){var S=r[c],d=S.length;o[c]=new Array(d),a[c]=new Array(d);for(var f=0;f<d;f++){var E=S[f];o[c][f]=e[E],a[c][f]=t[E]}if(null!=n)if(s[c]=new Array(d),l[c]=new Array(d),i)for(var p=n[c],f=0;f<d;f++){s[c][f]=g<=1?p[f][0]:EJSS_TOOLS.Mathematics.norm(p[f]),l[c][f]=new Array(g);for(var h=0;h<g;h++)l[c][f][h]=p[f][h]}else for(var f=0;f<d;f++){var E=S[f];s[c][f]=g<=1?n[E][0]:EJSS_TOOLS.Mathematics.norm(n[E]),l[c][f]=new Array(g);for(var h=0;h<g;h++)l[c][f][h]=n[E][h]}}}return{cellA:o,cellB:a,cellZ:s,cellVector:l}},drawPolygons:function(e,t,r,n){for(var i=e.cellA,o=e.cellB,a=e.cellZ,s=0,l=i.length;s<l;s++){var u=i[s],g=o[s],c=a[s];if("undefined"!=typeof c){for(var S=u.length,d=new Array(S),f=Number.MAX_VALUE,E=Number.MIN_VALUE,p=0;p<S;p++){var h=t.doubleToIndex(c[p]);f=Math.min(h,f),E=Math.max(h,E),d[p]=h}for(var m=t.getColorThresholds(),A=new Array(2*S),y=new Array(2*S),v=f;v<=E;v++){for(var P=0,D=0;D<S;D++){var I=(D+1)%S;if(d[D]<=v&&d[I]>=v){if(d[D]==v)A[P]=u[D],y[P]=g[D],P++;else{var _=(m[v]-c[D])/(c[I]-c[D]);A[P]=Math.round(u[D]+_*(u[I]-u[D])),y[P]=Math.round(g[D]+_*(g[I]-g[D])),P++}if(d[I]>v){var _=(m[v+1]-c[D])/(c[I]-c[D]);A[P]=Math.round(u[D]+_*(u[I]-u[D])),y[P]=Math.round(g[D]+_*(g[I]-g[D])),P++}}else if(d[D]>=v&&d[I]<=v){if(d[D]==v)A[P]=u[D],y[P]=g[D],P++;else{var _=(m[v+1]-c[D])/(c[I]-c[D]);A[P]=Math.round(u[D]+_*(u[I]-u[D])),y[P]=Math.round(g[D]+_*(g[I]-g[D])),P++}if(d[I]<v){var _=(m[v]-c[D])/(c[I]-c[D]);A[P]=Math.round(u[D]+_*(u[I]-u[D])),y[P]=Math.round(g[D]+_*(g[I]-g[D])),P++}}}P>0&&n(A,y,P,t,v)}}r(u,g)}},buildBoundary:function(e,t,r){var n,i;if(null!=r&&r.length>0){var o=r.length;n=new Array(o),i=new Array(o);for(var a=0;a<o;a++){var s=r[a],l=s.length;n[a]=new Array(l),i[a]=new Array(l);for(var u=0;u<l;u++){var g=s[u];n[a][u]=e[g],i[a][u]=t[g]}}}return{boundaryA:n,boundaryB:i}},drawBoundary:function(e,t,r,n){for(var i=e.boundaryA,o=e.boundaryB,a="black",s=0,l=i.length;s<l;s++){if(null!=t){var u=t[s];null!=r&&u<r.length&&(a=r[u])}n(i[s],o[s],a)}}};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.analyticCurve=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.arrow=function(e,t){function r(t,r,n,i,a,s,l,u,g,c){var S,d,f=e.getElementById(t);null===f?(f=document.createElementNS("http://www.w3.org/2000/svg","marker"),f.setAttribute("id",t),S=document.createElementNS("http://www.w3.org/2000/svg","path"),S.setAttribute("id",t+".markpath"),f.appendChild(S),d=document.createElementNS("http://www.w3.org/2000/svg","path"),d.setAttribute("id",t+".markpath2"),f.appendChild(d),e.getElementsByTagName("defs")[0].appendChild(f)):(S=e.getElementById(t+".markpath"),d=e.getElementById(t+".markpath2"),e.getElementsByTagName("defs")[0].insertBefore(f,f));var E=i+2*s,p=a+2*s;switch(f.setAttribute("viewBox",-s+" "+-s+" "+E+" "+p),f.setAttribute("refX",i/2),f.setAttribute("refY",a/2),f.setAttribute("markerUnits","userSpaceOnUse"),f.setAttribute("markerWidth",E),f.setAttribute("markerHeight",p),f.setAttribute("orient",n),S.setAttribute("fill",l),S.setAttribute("stroke",l),S.setAttribute("stroke-width",s),S.setAttribute("style","  marker-start :none;   marker-end :none; "),d.setAttribute("fill",u),d.setAttribute("stroke",u),d.setAttribute("stroke-width",s),d.setAttribute("style","  marker-start :none;   marker-end :none; "),r){case o.TRIANGLE:var h="M 0 0 L "+i+" "+a/2+" L 0 "+a+" z";S.setAttribute("d",h);break;case o.INVTRIANGLE:var h="M "+i+" 0 L 0 "+a/2+" L "+i+" "+a+" z";S.setAttribute("d",h);break;case o.ANGLE:f.setAttribute("markerHeight",a),f.setAttribute("refX",i);var m=-(s-1),A=a+(s-1),h="M 0 "+m+" L "+i+" "+a/2+" L 0 "+A;S.setAttribute("d",h),S.setAttribute("fill","none");break;case o.INVANGLE:f.setAttribute("markerHeight",a),f.setAttribute("refX",1);var m=-(s-1),A=a+(s-1),h="M "+i+" "+m+" L 0 "+a/2+" L "+i+" "+A;S.setAttribute("d",h),S.setAttribute("fill","none");break;case o.LINE:var h="M "+i/2+" 0 L "+i/2+" "+a+" z";S.setAttribute("d",h);break;case o.RECTANGLE:var h="M 0 0 L "+i+" 0 L "+i+" "+a+" L 0 "+a+" z";S.setAttribute("d",h);break;case o.DIAMOND:var h="M "+i/2+" 0 L "+i+" "+a/2+" L "+i/2+" "+a+" L 0 "+a/2+" z";S.setAttribute("d",h);break;case o.CIRCLE:var y=i<a?i:a;y/=2;var h="M "+i/2+" "+a/2+" m "+-y+", 0 a "+y+","+y+" 0 1,0 "+2*y+",0 a "+y+","+y+" 0 1,0 "+2*-y+",0";S.setAttribute("d",h);break;case o.WEDGE:S.setAttribute("stroke-width",0),d.setAttribute("stroke-width",.5);var v="undefined"==typeof c||0===c?0:Math.atan(g/c),y=i<a?i:a;y/=2;var P=i/2,D=a/2,I=P+y*Math.cos(v),_=D-y*Math.sin(v),C=P+y*Math.cos(Math.PI/3.25-v),R=D+y*Math.sin(Math.PI/3.25-v),T=" M "+P+" "+D+" L "+I+","+_+" A "+y+","+y+" 0 0,1 "+C+","+R,N="M "+P+" "+D+" m "+-y+", 0 a "+y+","+y+" 0 1,0 "+2*y+",0 a "+y+","+y+" 0 1,0 "+2*-y+",0 ";S.setAttribute("d",N),d.setAttribute("d",T);break;case o.POINTED:f.setAttribute("refX",i),S.setAttribute("stroke-width",0);var h="M 0 0 L "+i+" "+a/2+" L 0 "+a+" L "+i/2+" "+a/2+" L 0 0 z";S.setAttribute("d",h);break;case o.CURVE:f.setAttribute("refX",i),S.setAttribute("stroke-width",0);var O=3*i,M=a/2.5,h="M 0 0  A "+O+","+O+" 1 0,0 "+i+","+a/2+" A "+O+","+O+" 1 0,0  0,"+a+" A "+M+","+M+" 1 0,0  0,"+a/2+" A "+M+","+M+" 1 0,0  0,0 z";S.setAttribute("d",h)}}var n,i=EJSS_SVGGRAPHICS.Utils,o=EJSS_DRAWING2D.Arrow,a=t.getGroup();n=null!==a?e.getElementById(a.getName()):e;var s=e.getElementById(t.getName());null===s&&(s=document.createElementNS("http://www.w3.org/2000/svg","path"),s.setAttribute("id",t.getName()),n.appendChild(s));var l=t.getPixelPosition(),u=t.getPixelSizes(),g=t.getRelativePositionOffset(u),c=l[0]+g[0],S=l[1]+g[1],d=u[0]/2,f=u[1]/2;if(0!=u[0]||0!=u[1]){if(t.getMarkEnd()!=o.NONE){var E=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([u[0],u[1]]),p=0!=E&&E<t.getMarkEndWidth()?E:t.getMarkEndWidth(),h=0!=E&&E<t.getMarkEndHeight()?E:t.getMarkEndHeight(),m="none"==t.getMarkEndColor()?t.getStyle().getLineColor():t.getMarkEndColor(),A=t.getMarkEndStroke()<0?t.getStyle().getLineWidth():t.getMarkEndStroke();r(t.getName()+".end",t.getMarkEnd(),t.getMarkEndOrient(),p,h,A,m),s.setAttribute("marker-end","url(#"+t.getName()+".end)")}else s.removeAttribute("marker-end");if(t.getMarkMiddle()!=o.NONE){var y=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([u[0],u[1]]),v=0!=y&&y<t.getMarkMiddleWidth()?y:t.getMarkMiddleWidth(),P=0!=y&&y<t.getMarkMiddleHeight()?y:t.getMarkMiddleHeight(),m="none"==t.getMarkMiddleColor()?t.getStyle().getLineColor():t.getMarkMiddleColor(),D="none"==t.getMarkMiddleColorSnd()?t.getStyle().getLineColor():t.getMarkMiddleColorSnd(),A=t.getMarkMiddleStroke()<0?t.getStyle().getLineWidth():t.getMarkMiddleStroke();r(t.getName()+".mid",t.getMarkMiddle(),t.getMarkMiddleOrient(),v,P,A,m,D,u[0],u[1]),s.setAttribute("marker-mid","url(#"+t.getName()+".mid)")}else s.removeAttribute("marker-mid");if(t.getMarkStart()!=o.NONE){var I=t.getMarkProportion()*EJSS_TOOLS.Mathematics.norm([u[0],u[1]]),_=0!=I&&I<t.getMarkStartWidth()?I:t.getMarkStartWidth(),C=0!=I&&I<t.getMarkStartHeight()?I:t.getMarkStartHeight(),m="none"==t.getMarkStartColor()?t.getStyle().getLineColor():t.getMarkStartColor(),A=t.getMarkStartStroke()<0?t.getStyle().getLineWidth():t.getMarkStartStroke();r(t.getName()+".start",t.getMarkStart(),t.getMarkStartOrient(),_,C,A,m),s.setAttribute("marker-start","url(#"+t.getName()+".start)")}else s.removeAttribute("marker-start")}else s.removeAttribute("marker-end"),s.removeAttribute("marker-mid"),s.removeAttribute("marker-start");var R=t.getStyle();"crispEdges"==R.getShapeRendering()?t.getMarkMiddle()!=o.NONE?s.setAttribute("d","M "+i.crispValue(c-d)+" "+i.crispValue(S-f)+" L "+i.crispValue(c)+" "+i.crispValue(S)+" L "+i.crispValue(c+d)+" "+i.crispValue(S+f)):s.setAttribute("d","M "+i.crispValue(c-d)+" "+i.crispValue(S-f)+" L "+i.crispValue(c+d)+" "+i.crispValue(S+f)):t.getMarkMiddle()!=o.NONE?s.setAttribute("d","M "+(c-d)+" "+(S-f)+" L "+c+" "+S+" L "+(c+d)+" "+(S+f)):s.setAttribute("d","M "+(c-d)+" "+(S-f)+" L "+(c+d)+" "+(S+f)),R.getDrawFill()?s.setAttribute("fill",R.getFillColor()):s.setAttribute("fill","none"),R.getDrawLines()?(s.setAttribute("stroke",R.getLineColor()),s.setAttribute("stroke-width",R.getLineWidth())):(s.setAttribute("stroke","none"),s.setAttribute("stroke-width",0)),s.setAttribute("shapeRendering",R.getShapeRendering());var T=R.getAttributes();for(var N in T)s.setAttribute(N,T[N]);return s};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.axis=function(e,t){function r(e,t,r,n,i,o,s,l){var u=document.createElementNS("http://www.w3.org/2000/svg","path");e.appendChild(u),s==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?(l&&(i=-i,r=-r),"crispEdges"==o.getShapeRendering()?u.setAttribute("d","M "+a.crispValue(t)+" "+a.crispValue(r-.5-i)+" L "+a.crispValue(t)+" "+a.crispValue(r-.5+i)):u.setAttribute("d","M "+t+" "+(r-i)+" L "+t+" "+(r+i))):"crispEdges"==o.getShapeRendering()?u.setAttribute("d","M "+a.crispValue(t+.5-n)+" "+a.crispValue(r)+" L "+a.crispValue(t+.5+n)+" "+a.crispValue(r)):u.setAttribute("d","M "+(t-n)+" "+r+" L "+(t+n)+" "+r)}function n(e,t,r,n,i,o){if(o==EJSS_DRAWING2D.Axis.AXIS_VERTICAL){var s=document.createElementNS("http://www.w3.org/2000/svg","path");e.appendChild(s),"crispEdges"==i.getShapeRendering()?s.setAttribute("d","M "+a.crispValue(t-n/2)+" "+a.crispValue(r)+" L "+a.crispValue(t+n/2)+" "+a.crispValue(r)):s.setAttribute("d","M "+(t-n/2)+" "+r+" L "+(t+n/2)+" "+r)}else{var s=document.createElementNS("http://www.w3.org/2000/svg","path");e.appendChild(s),"crispEdges"==i.getShapeRendering()?s.setAttribute("d","M "+a.crispValue(t)+" "+a.crispValue(r-n/2)+" L "+a.crispValue(t)+" "+a.crispValue(r+n/2)):s.setAttribute("d","M "+t+" "+(r-n/2)+" L "+t+" "+(r+n/2))}}function i(e,t,r,n,i,o){var a=document.createElementNS("http://www.w3.org/2000/svg","g");e.appendChild(a);var s=document.createElementNS("http://www.w3.org/2000/svg","text");a.appendChild(s),s.setAttribute("font-family",i.getFontFamily()),s.setAttribute("font-size",i.getFontSizeString()),s.setAttribute("fill",i.getFillColor()),s.setAttribute("stroke",i.getOutlineColor()),s.setAttribute("stroke-width",i.getFontWeight()),s.setAttribute("letterSpacing",i.getLetterSpacing()),s.textContent=n,o?t-=s.getComputedTextLength()/2+.5:r+=i.getFontSize()/2,s.setAttribute("x",t),s.setAttribute("y",r)}var o,a=EJSS_SVGGRAPHICS.Utils,s=t.getGroup();o=null!==s?e.getElementById(s.getName()):e;var l=e.getElementById(t.getName());if(null!==l&&o.removeChild(l),t.getShow()){l=document.createElementNS("http://www.w3.org/2000/svg","g"),l.setAttribute("id",t.getName()),o.appendChild(l);var u=t.getPixelPosition(),g=t.getPixelSizes(),c=t.getRelativePositionOffset(g),S=u[0]+c[0],d=u[1]+c[1],f=g[0]/2,E=g[1]/2,p=t.getStyle(),h=t.getOrient(),m=t.getInvertedScaleY();r(l,S,d,f,E,p,h,m);var A=h==EJSS_DRAWING2D.Axis.AXIS_VERTICAL?Math.abs(g[1]):Math.abs(g[0]),y=t.getTicksMode();if(y==EJSS_DRAWING2D.Axis.SCALE_LOG){var v=t.getScale();if(v[0]>0&&v[1]>0){var P=t.getTicks(),D=t.getScalePrecision(),I=t.getTicksSize();EJSS_GRAPHICS.GraphicsUtils.drawLogTicks(S,d,f,E,A,I,v,P,h,function(e,t,r,i){n(l,e,t,r,p,i)});var _=t.getFont(),C=t.getTextPosition();EJSS_GRAPHICS.GraphicsUtils.drawLogTicksText(S,d,f,E,P,I,v,D,_,C,h,function(e,t,r,n,o){i(l,e,t,r,n,o)})}}else if(y==EJSS_DRAWING2D.Axis.SCALE_NUM){var R=0,T=0;if(t.getAutoTicks())for(var N=t.getAutoStepMin(),O=t.getAutoTicksRange(),M=O.length-1;M>=0&&(R=Math.abs(A/O[M]),!(1.001*R>=N));M--);else{var P=t.getTicks();0!=P?R=A/P:(R=t.getStep(),T=t.getTickStep())}var D=t.getScalePrecision(),v=t.getScale();if(0==T)var b=Math.abs((v[1]-v[0])*R/A);else{var b=T;R=Math.abs(b*A/(v[1]-v[0]))}var G=Math.pow(10,D),x=Math.round(b*G)/G;x>0&&(b=x,R=Math.abs(x*A/(v[1]-v[0])));var L=t.getFixedTick(),J=v[1];isNaN(L)||(J=L<v[0]?L+(Math.floor((v[0]-L)/b)+1)*b:L>v[1]?L-(Math.floor((L-v[1])/b)+1)*b:L);var w=Math.abs((v[0]-J)%b),W=Math.abs(w-b);(w<.001||W<.001)&&(w=0);var k=A*w/Math.abs(v[1]-v[0]),I=t.getTicksSize();EJSS_GRAPHICS.GraphicsUtils.drawDecTicks(S,d,f,E,I,R,k,h,m,function(e,t,r,i){n(l,e,t,r,p,i)});var _=t.getFont(),C=t.getTextPosition();EJSS_GRAPHICS.GraphicsUtils.drawDecTicksText(S,d,f,E,I,R,k,v,D,b,w,_,C,h,m,function(e,t,r,n,o){i(l,e,t,r,n,o)})}p.getDrawFill()?l.setAttribute("fill",p.getFillColor()):l.setAttribute("fill","none"),p.getDrawLines()?(l.setAttribute("stroke",p.getLineColor()),l.setAttribute("stroke-width",p.getLineWidth())):(l.setAttribute("stroke","none"),l.setAttribute("stroke-width",0)),l.setAttribute("shapeRendering",p.getShapeRendering());var F=p.getAttributes();for(var V in F)l.setAttribute(V,F[V])}return l};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.byteRaster=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.cellLattice=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.cursor=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.ellipse=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),i.setAttribute("id",t.getName()),r.appendChild(i));var o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1],g=Math.abs(a[0]/2),c=Math.abs(a[1]/2);i.setAttribute("cx",l),i.setAttribute("cy",u),i.setAttribute("rx",g),i.setAttribute("ry",c);var S=t.getStyle();S.getDrawFill()?i.setAttribute("fill",S.getFillColor()):i.setAttribute("fill","none"),S.getDrawLines()?(i.setAttribute("stroke",S.getLineColor()),i.setAttribute("stroke-width",S.getLineWidth())):(i.setAttribute("stroke","none"),i.setAttribute("stroke-width",0)),i.setAttribute("shapeRendering",S.getShapeRendering());var d=S.getAttributes();for(var f in d)i.setAttribute(f,d[f]);return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.grid=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null!==i&&r.removeChild(i),i=document.createElementNS("http://www.w3.org/2000/svg","g"),i.setAttribute("id",t.getName()),r.appendChild(i);var o=document.createElementNS("http://www.w3.org/2000/svg","path");o.setAttribute("id",t.getName()+"X"),i.appendChild(o);var a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("id",t.getName()+"Y"),i.appendChild(a);var s=t.getPixelPosition(),l=t.getPixelSizes(),u=t.getRelativePositionOffset(l),g=s[0]+u[0],c=s[1]+u[1],S=l[0]/2,d=l[1]/2,f=t.getShowX(),E=t.getShowY(),p="",h="";if(f){var m=t.getTicksXMode();if(m==EJSS_DRAWING2D.Grid.SCALE_LOG){var A=t.getScaleX();if(A[0]>0&&A[1]>0){var y=t.getTicksX(),v=g-S,P=g+S,D=c+d,I=c-d;EJSS_GRAPHICS.GraphicsUtils.drawLogGrid(v,D,P,I,y,A,1,function(e,t){p+=" M "+e+" "+t},function(e,t){p+=" L "+e+" "+t})}}else if(m==EJSS_DRAWING2D.Grid.SCALE_NUM){var _=0,C=0;if(t.getAutoTicksX())for(var R=t.getAutoStepXMin(),T=t.getAutoTicksRangeX(),N=T.length-1;N>=0&&(_=Math.abs(l[0]/T[N]),!(_>=R));N--);else{var y=t.getTicksX();0!=y?_=Math.abs(l[0]/y):(_=t.getStepX(),C=t.getTickStepX())}var O=t.getScalePrecisionX(),A=t.getScaleX();if(0==C)var M=Math.abs((A[1]-A[0])*_/l[0]);else{var M=C;_=Math.abs(M*l[0]/(A[1]-A[0]))}var b=Math.pow(10,O),G=Math.round(M*b)/b;G>0&&(M=G,_=Math.abs(G*l[0]/(A[1]-A[0])));var x=t.getFixedTickX(),L=A[1];isNaN(x)||(L=x<A[0]?x+(Math.floor((A[0]-x)/M)+1)*M:x>A[1]?x-(Math.floor((x-A[1])/M)+1)*M:x);var J=Math.abs((A[0]-L)%M),w=Math.abs(J-M);(J<.001||w<.001)&&(J=0);var W=Math.abs(l[0]*J/(A[1]-A[0])),v=g-S,P=g+S,D=c+d,I=c-d;EJSS_GRAPHICS.GraphicsUtils.drawDecGrid(v,D,P,I,W,_,1,function(e,t){p+=" M "+e+" "+t},function(e,t){p+=" L "+e+" "+t})}}if(E){var k=t.getTicksYMode();if(k==EJSS_DRAWING2D.Grid.SCALE_LOG){var F=t.getScaleY();if(F[0]>0&&F[1]>0){var V=t.getTicksY(),v=g-S,P=g+S,D=c+d,I=c-d;EJSS_GRAPHICS.GraphicsUtils.drawLogGrid(v,D,P,I,V,F,-1,function(e,t){h+=" M "+e+" "+t},function(e,t){h+=" L "+e+" "+t})}}else if(k==EJSS_DRAWING2D.Grid.SCALE_NUM){var B=0,H=0;if(t.getAutoTicksY())for(var z=t.getAutoStepYMin(),Y=t.getAutoTicksRangeY(),N=Y.length-1;N>=0&&(B=Math.abs(l[1]/Y[N]),!(B>=z));N--);else{var V=t.getTicksY();0!=V?B=Math.abs(l[1]/V):(B=t.getStepY(),H=t.getTickStepY())}var U=t.getScalePrecisionY(),F=t.getScaleY();if(0==H)var X=Math.abs((F[1]-F[0])*B/l[1]);else{var X=H;B=Math.abs(X*l[1]/(F[1]-F[0]))}var Z=Math.pow(10,U),j=Math.round(X*Z)/Z;j>0&&(X=j,B=Math.abs(j*l[1]/(F[1]-F[0])));var x=t.getFixedTickY(),L=F[1];isNaN(x)||(L=x<F[0]?x+(Math.floor((F[0]-x)/X)+1)*X:x>F[1]?x-(Math.floor((x-F[1])/X)+1)*X:x);var J=Math.abs((F[0]-L)%X),w=Math.abs(J-X);(J<.001||w<.001)&&(J=0);var q=Math.abs(l[1]*J/(F[1]-F[0])),v=g-S,P=g+S,D=c+d,I=c-d;EJSS_GRAPHICS.GraphicsUtils.drawDecGrid(v,D,P,I,q,B,-1,function(e,t){h+=" M "+e+" "+t},function(e,t){h+=" L "+e+" "+t})}}p.length>0&&(o.setAttribute("d",p),o.setAttribute("shapeRendering",t.getShapeRenderingX()),o.setAttribute("stroke",t.getLineColorX()),o.setAttribute("stroke-width",t.getLineWidthX())),h.length>0&&(a.setAttribute("d",h),a.setAttribute("shapeRendering",t.getShapeRenderingY()),a.setAttribute("stroke",t.getLineColorY()),a.setAttribute("stroke-width",t.getLineWidthY()));var K=t.getStyle().getAttributes();for(var $ in K)o.setAttribute($,K[$]),a.setAttribute($,K[$]);return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.group=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());return null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","g"),i.setAttribute("id",t.getName()),r.appendChild(i)),i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.histogram=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.image=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.mesh=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.pipe=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.point=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),i.setAttribute("id",t.getName()),r.appendChild(i));var o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1];i.setAttribute("cx",l),i.setAttribute("cy",u),i.setAttribute("rx",2),i.setAttribute("ry",2);var g=t.getStyle();i.setAttribute("fill",g.getFillColor());var c=g.getAttributes();for(var S in c)i.setAttribute(S,c[S]);return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.polygon=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.rectangle=function(e,t){var r,n=EJSS_SVGGRAPHICS.Utils,i=t.getGroup();r=null!==i?e.getElementById(i.getName()):e;var o=e.getElementById(t.getName());null===o&&(o=document.createElementNS("http://www.w3.org/2000/svg","path"),o.setAttribute("id",t.getName()),r.appendChild(o));var a=t.getPixelPosition(),s=t.getPixelSizes(),l=t.getRelativePositionOffset(s),u=a[0]+l[0],g=a[1]+l[1],c=s[0]/2,S=s[1]/2,d=t.getStyle();"crispEdges"==d.getShapeRendering()?o.setAttribute("d","M "+n.crispValue(u-c)+" "+n.crispValue(g+S)+" L "+n.crispValue(u+c)+" "+n.crispValue(g+S)+" L "+n.crispValue(u+c)+" "+n.crispValue(g-S)+" L "+n.crispValue(u-c)+" "+n.crispValue(g-S)+" z"):o.setAttribute("d","M "+(u-c)+" "+(g+S)+" L "+(u+c)+" "+(g+S)+" L "+(u+c)+" "+(g-S)+" L "+(u-c)+" "+(g-S)+" z"),d.getDrawFill()?o.setAttribute("fill",d.getFillColor()):o.setAttribute("fill","none"),d.getDrawLines()?(o.setAttribute("stroke",d.getLineColor()),o.setAttribute("stroke-width",d.getLineWidth())):(o.setAttribute("stroke","none"),o.setAttribute("stroke-width",0)),o.setAttribute("shapeRendering",d.getShapeRendering());var f=d.getAttributes();for(var E in f)o.setAttribute(E,f[E]);return o};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.roundRectangle=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i=e.getElementById(t.getName());null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","rect"),i.setAttribute("id",t.getName()),r.appendChild(i));var o=t.getPixelPosition(),a=t.getPixelSizes(),s=t.getRelativePositionOffset(a),l=o[0]+s[0],u=o[1]+s[1],g=Math.abs(a[0]/2),c=Math.abs(a[1]/2),S=Math.abs(t.getCornerRadius());i.setAttribute("x",l-g),i.setAttribute("y",u-c),i.setAttribute("width",Math.abs(a[0])),i.setAttribute("height",Math.abs(a[1])),i.setAttribute("rx",S),i.setAttribute("ry",S);var d=t.getStyle();d.getDrawFill()?i.setAttribute("fill",d.getFillColor()):i.setAttribute("fill","none"),d.getDrawLines()?(i.setAttribute("stroke",d.getLineColor()),i.setAttribute("stroke-width",d.getLineWidth())):(i.setAttribute("stroke","none"),i.setAttribute("stroke-width",0)),i.setAttribute("shapeRendering",d.getShapeRendering());var f=d.getAttributes();for(var E in f)i.setAttribute(E,f[E]);return i};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.segment=function(e,t){var r,n=EJSS_SVGGRAPHICS.Utils,i=t.getGroup();r=null!==i?e.getElementById(i.getName()):e;var o=e.getElementById(t.getName());null===o&&(o=document.createElementNS("http://www.w3.org/2000/svg","path"),o.setAttribute("id",t.getName()),r.appendChild(o));var a=t.getPixelPosition(),s=t.getPixelSizes(),l=t.getRelativePositionOffset(s),u=a[0]+l[0],g=a[1]+l[1],c=s[0]/2,S=s[1]/2,d=t.getStyle();"crispEdges"==d.getShapeRendering()?o.setAttribute("d","M "+n.crispValue(u-c)+" "+n.crispValue(g-S)+" L "+n.crispValue(u+c)+" "+n.crispValue(g+S)):o.setAttribute("d","M "+(u-c)+" "+(g-S)+" L "+(u+c)+" "+(g+S)),d.getDrawFill()?o.setAttribute("fill",d.getFillColor()):o.setAttribute("fill","none"),d.getDrawLines()?(o.setAttribute("stroke",d.getLineColor()),o.setAttribute("stroke-width",d.getLineWidth())):(o.setAttribute("stroke","none"),o.setAttribute("stroke-width",0)),o.setAttribute("shapeRendering",d.getShapeRendering());var f=d.getAttributes();for(var E in f)o.setAttribute(E,f[E]);return o};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.spring=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.tank=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.text=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i,o,a,s=e.getElementById(t.getName());null===s?(s=document.createElementNS("http://www.w3.org/2000/svg","g"),s.setAttribute("id",t.getName()),r.appendChild(s),i=document.createElementNS("http://www.w3.org/2000/svg","g"),i.setAttribute("id",t.getName()+".inner"),s.appendChild(i),a=document.createElementNS("http://www.w3.org/2000/svg","path"),a.setAttribute("id",t.getName()+".box"),i.appendChild(a),o=document.createElementNS("http://www.w3.org/2000/svg","text"),o.setAttribute("id",t.getName()+".text"),i.appendChild(o)):(i=e.getElementById(t.getName()+".inner"),o=e.getElementById(t.getName()+".text"),a=e.getElementById(t.getName()+".box"));var l=t.getFont();o.setAttribute("font-style",l.getFontStyle()),o.setAttribute("font-weight",l.getFontWeight()),o.setAttribute("font-size",l.getFontSizeString()),o.setAttribute("font-family",l.getFontFamily()),o.setAttribute("fill",l.getFillColor()),o.setAttribute("stroke",l.getOutlineColor()),o.setAttribute("letterSpacing",l.getLetterSpacing()),o.textContent=t.getText();var u=t.getPixelPosition(),g=t.getFramed()?4:0,c=[1.15*o.getComputedTextLength()+2*g,l.getFontSize()+2*g],S=EJSS_DRAWING2D.Element.getSWRelativePositionOffset(t.getRelativePosition(),c[0],c[1]),d=t.getMarginX(),f=t.getMarginY(),E=u[0]+S[0]+d+g,p=u[1]+S[1]+f-g;if(o.setAttribute("x",E),o.setAttribute("y",p),t.getFramed()){var h=g,m=g,A=c[0]-2*g,y=c[1]-2*g;if(A>0){var v=p+h,P=p-y-h,D=E-m,I=E+A+h;a.setAttribute("d","M "+D+" "+v+" L "+I+" "+v+" L "+I+" "+P+" L "+D+" "+P+" z");var _=t.getStyle();_.getDrawFill()?a.setAttribute("fill",_.getFillColor()):a.setAttribute("fill","none"),_.getDrawLines()?(a.setAttribute("stroke",_.getLineColor()),a.setAttribute("stroke-width",_.getLineWidth())):(a.setAttribute("stroke","none"),a.setAttribute("stroke-width",0));var C=_.getAttributes();for(var R in C)mShape.setAttribute(R,C[R])}else a.setAttribute("stroke","none"),a.setAttribute("fill","none")}var T=0;switch(t.getWritingMode()){case EJSS_DRAWING2D.Text.MODE_TOPDOWN:T=90;break;case EJSS_DRAWING2D.Text.MODE_RIGTHLEFT:T=180;break;case EJSS_DRAWING2D.Text.MODE_DOWNTOP:T=270;break;case EJSS_DRAWING2D.Text.MODE_LEFTRIGHT:T=0}return i.setAttribute("transform","rotate("+T+" "+(u[0]+d)+" "+(u[1]+f)+")"),s};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.trace=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.trail=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.Utils={},EJSS_SVGGRAPHICS.Utils.crispValue=function(e){return Math.round(+e.toFixed(4)+.5)-.5},EJSS_SVGGRAPHICS.Utils.crispTop=function(e){return Math.round(+e.toFixed(4)+.5)-.5},EJSS_SVGGRAPHICS.Utils.round=function(e){return+e.toFixed(4)},EJSS_SVGGRAPHICS.Utils.hsl2rgb=function(e){var t,r,n,i=e[0],o=e[1],a=e[2],s=(1-Math.abs(2*a-1))*o,l=i/60,u=s*(1-Math.abs(l%2-1));void 0===i||isNaN(i)||null===i?t=r=n=0:l>=0&&l<1?(t=s,r=u,n=0):l>=1&&l<2?(t=u,r=s,n=0):l>=2&&l<3?(t=0,r=s,n=u):l>=3&&l<4?(t=0,r=u,n=s):l>=4&&l<5?(t=u,r=0,n=s):l>=5&&l<6&&(t=s,r=0,n=u);var g,c,S,d=a-s/2;return g=255*(t+d),c=255*(r+d),S=255*(n+d),g=Math.round(g),c=Math.round(c),S=Math.round(S),{r:g,g:c,b:S}},EJSS_SVGGRAPHICS.Utils.PNGCanvasWorker=function(e){function t(e){var e=e.substring(4,e.length-1).replace(/ /g,"").split(",");return{r:e[0],g:e[1],b:e[2]}}function r(e){var e=e.substring(4,e.length-1).replace(/ /g,"").replace(/%/g,"").split(",");return{h:e[0],s:e[1]/100,l:e[2]/100}}function n(e,t,r,n,i,o,a){u=4*(t+r*e.width),e.data[u+0]=n,e.data[u+1]=i,e.data[u+2]=o,e.data[u+3]=a}for(var i=e.data.params.imageData,o=e.data.params.width,a=e.data.params.height,s=(e.data.params.depth,e.data.params.data),l=e.data.params.colors,u=e.data.id,g=l[0],c=l[l.length-1],S=0;S<o;S++)for(var d=0;d<a;d++){var u=s[S][a-d-1],f=u<0?g:u<l.length?l[u]:c;"undefined"==typeof f&&(f=g),"rgb"==f.substring(0,3)?rgb=t(f):"hsl"==f.substring(0,3)&&(rgb=EJSS_SVGGRAPHICS.Utils.hsl2rgb(r(f))),n(i,S,d,rgb.r,rgb.g,rgb.b,255)}self.postMessage({result:i,id:u})},EJSS_SVGGRAPHICS.Utils.PNGCanvasNoWorker=function(e,t,r,n,i,o){function a(e){var e=e.substring(4,e.length-1).replace(/ /g,"").split(",");return{r:e[0],g:e[1],b:e[2]}}function s(e){var e=e.substring(4,e.length-1).replace(/ /g,"").replace(/%/g,"").split(",");return{h:e[0],s:e[1]/100,l:e[2]/100}}function l(e,t,r,n,i,o,a){d=4*(t+r*e.width),e.data[d+0]=n,e.data[d+1]=i,e.data[d+2]=o,e.data[d+3]=a}for(var u=o[0],g=o[o.length-1],c=0;c<t;c++)for(var S=0;S<r;S++){var d=i[c][r-S-1],f=d<0?u:d<o.length?o[d]:g;"undefined"==typeof f&&(f=u),"rgb"==f.substring(0,3)?rgb=a(f):"hsl"==f.substring(0,3)&&(rgb=EJSS_SVGGRAPHICS.Utils.hsl2rgb(s(f))),l(e,c,S,rgb.r,rgb.g,rgb.b,255)}},EJSS_SVGGRAPHICS.Utils.PNGCanvas=function(e,t,r,n,i,o){var a=document.createElement("canvas");a.setAttribute("width",e),a.setAttribute("height",t);var s=a.getContext("2d"),l=s.createImageData(e,t);EJSS_TOOLS.Worker.runFunction?EJSS_TOOLS.Worker.runFunction("PNGCanvasWorker",EJSS_SVGGRAPHICS.Utils.PNGCanvasWorker,{imageData:l,width:e,height:t,depth:r,data:n,colors:i},function(e){s.putImageData(e.result,0,0),o(a.toDataURL())}):(EJSS_SVGGRAPHICS.Utils.PNGCanvasNoWorker(l,e,t,r,n,i),s.putImageData(l,0,0),o(a.toDataURL()))},EJSS_SVGGRAPHICS.Utils.ImageDataCanvas=function(e,t,r,n,i,o){var a=document.createElement("canvas");a.setAttribute("width",e),a.setAttribute("height",t);var s=a.getContext("2d"),l=s.createImageData(e,t);EJSS_TOOLS.Worker.runFunction("PNGCanvasWorker",EJSS_SVGGRAPHICS.Utils.PNGCanvasWorker,{imageData:l,width:e,height:t,depth:r,data:n,colors:i},function(e){o(e)})};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.video=function(e,t){};var EJSS_SVGGRAPHICS=EJSS_SVGGRAPHICS||{};EJSS_SVGGRAPHICS.wheel=function(e,t){var r,n=t.getGroup();r=null!==n?e.getElementById(n.getName()):e;var i,o,a=e.getElementById(t.getName());null===a?(a=document.createElementNS("http://www.w3.org/2000/svg","g"),a.setAttribute("id",t.getName()),r.appendChild(a),i=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),i.setAttribute("id",t.getName()+".circle"),a.appendChild(i),o=document.createElementNS("http://www.w3.org/2000/svg","path"),o.setAttribute("id",t.getName()+".cross"),a.appendChild(o)):(i=e.getElementById(t.getName()+".circle"),o=e.getElementById(t.getName()+".cross"));var s=t.getPixelPosition(),l=t.getPixelSizes(),u=t.getRelativePositionOffset(l),g=s[0]+u[0],c=s[1]+u[1],S=l[0]/2,d=l[1]/2;i.setAttribute("cx",g),i.setAttribute("cy",c),i.setAttribute("rx",Math.abs(S)),i.setAttribute("ry",Math.abs(d)),o.setAttribute("d","M "+(g-S)+" "+c+" L "+(g+S)+" "+c+" M "+g+" "+(c-d)+" L "+g+" "+(c+d));var f=t.getStyle();f.getDrawFill()?a.setAttribute("fill",f.getFillColor()):a.setAttribute("fill","none"),f.getDrawLines()?(a.setAttribute("stroke",f.getLineColor()),a.setAttribute("stroke-width",f.getLineWidth())):(a.setAttribute("stroke","none"),a.setAttribute("stroke-width",0)),a.setAttribute("shapeRendering",f.getShapeRendering());var E=f.getAttributes();for(var p in E)a.setAttribute(p,E[p]);return a};var EJSS_GRAPHICS=EJSS_GRAPHICS||{};EJSS_GRAPHICS.SvgGraphics={getOffsetRect:function(e){return EJSS_GRAPHICS.GraphicsUtils.getOffsetRect(e)}},EJSS_GRAPHICS.svgGraphics=function(e){var t=EJSS_INTERFACE.svgGraphics(e),r=t.getDOMElement();return t.getEventContext=function(){return r},t.getBox=function(){var e=EJSS_GRAPHICS.CanvasGraphics.getOffsetRect(t);return e.width-=1,e.height-=1,e},t.remove=function(e){var t=r.getElementById(e);return null!==t&&(r.removeChild(t),!0)},t.reset=function(){for(;r.firstChild;)r.removeChild(r.firstChild);var e=document.createElementNS("http://www.w3.org/2000/svg","defs");r.appendChild(e)},t.draw=function(e,n){for(var i=0,o=e.length;i<o;i++){var a=e[i];if(a.getElements)for(var s=a.getLastElements(),l=0,u=s.length;l<u;l++){var g=r.getElementById(s[l].getName());g&&g.parentNode.removeChild(g)}if(n||a.isChanged()||a.isGroupChanged()||a.isMustProject()){var c=t.drawElement(a);"undefined"!=typeof c&&null!=c&&t.transformElement(a,c)}}},t.drawElement=function(e){var t=EJSS_DRAWING2D.Shape,n=null;switch(e._23()){case"ElementCustom":var i=e.getFunction();i&&(n=i(r,e));break;case"ElementGroup":n=EJSS_SVGGRAPHICS.group(r,e);break;case"ElementShape":switch(e.getShapeType()){default:case t.ELLIPSE:n=EJSS_SVGGRAPHICS.ellipse(r,e);break;case t.RECTANGLE:n=EJSS_SVGGRAPHICS.rectangle(r,e);break;case t.ROUND_RECTANGLE:n=EJSS_SVGGRAPHICS.roundRectangle(r,e);break;case t.WHEEL:n=EJSS_SVGGRAPHICS.wheel(r,e);break;case t.NONE:case t.POINT:n=EJSS_SVGGRAPHICS.point(r,e)}break;case"ElementSegment":n=EJSS_SVGGRAPHICS.segment(r,e);break;case"ElementImage":n=EJSS_SVGGRAPHICS.image(r,e);break;case"ElementVideo":n=EJSS_SVGGRAPHICS.video(r,e);break;case"ElementArrow":n=EJSS_SVGGRAPHICS.arrow(r,e);break;case"ElementText":n=EJSS_SVGGRAPHICS.text(r,e);break;case"ElementSpring":n=EJSS_SVGGRAPHICS.spring(r,e);break;case"ElementTrail":n=EJSS_SVGGRAPHICS.trail(r,e);break;case"ElementTrace":n=EJSS_SVGGRAPHICS.trace(r,e);break;case"ElementGrid":n=EJSS_SVGGRAPHICS.grid(r,e);break;case"ElementAxis":n=EJSS_SVGGRAPHICS.axis(r,e);break;case"ElementCursor":n=EJSS_SVGGRAPHICS.cursor(r,e);break;case"ElementPolygon":n=EJSS_SVGGRAPHICS.polygon(r,e);break;case"ElementAnalyticCurve":n=EJSS_SVGGRAPHICS.analyticCurve(r,e);break;case"ElementCellLattice":n=EJSS_SVGGRAPHICS.cellLattice(r,e);break;case"ElementByteRaster":n=EJSS_SVGGRAPHICS.byteRaster(r,e);break;case"ElementMesh":n=EJSS_SVGGRAPHICS.mesh(r,e);break;case"ElementTank":n=EJSS_SVGGRAPHICS.tank(r,e);break;case"ElementPipe":n=EJSS_SVGGRAPHICS.pipe(r,e);break;case"ElementHistogram":n=EJSS_SVGGRAPHICS.histogram(r,e)}return n&&(e.isGroupVisible()?n.setAttribute("visibility","visible"):n.setAttribute("visibility","hidden")),n},t.transformElement=function(e,t){var r,n=e.getTransformation();if(Array.isArray(n))r="matrix("+n[0]+" "+n[1]+" "+n[2]+" "+n[3]+" "+n[4]+" "+n[5]+")";else if("string"==typeof n)r=n;else if("number"==typeof n){var i=e.getPixelPosition(),o=EJSS_TOOLS.Mathematics.degrees(-n);r="rotate("+o+" "+i[0]+" "+i[1]+")"}r&&t.setAttribute("transform",r)},t._24=function(e){var n=e.getGutters();if(n.visible){var i=EJSS_SVGGRAPHICS.Utils,o=r.getElementById(".myGutters"),a=r.getElementById(".myOuterBorder"),s=r.getElementById(".myInnerBorder");null===o&&(o=document.createElementNS("http://www.w3.org/2000/svg","path"),o.setAttribute("id",".myGutters"),o.setAttribute("stroke","none"),o.setAttribute("stroke-width",0),r.appendChild(o),a=document.createElementNS("http://www.w3.org/2000/svg","path"),a.setAttribute("id",".myOuterBorder"),a.setAttribute("fill","none"),r.appendChild(a),s=document.createElementNS("http://www.w3.org/2000/svg","path"),s.setAttribute("id",".myInnerBorder"),s.setAttribute("fill","none"),r.appendChild(s));var l=e.getInnerRect(),u=.5,g=.5,c=t.getBox(),S=c.width,d=c.height,f=e.getGuttersStyle(),E=e.getStyle();"crispEdges"==E.getShapeRendering()?(o.setAttribute("d","M "+i.crispValue(u)+" "+i.crispValue(g)+" L "+i.crispValue(u)+" "+i.crispValue(g+d)+" L "+i.crispValue(u+S)+" "+i.crispValue(g+d)+" L "+i.crispValue(u+S)+" "+i.crispValue(g)+" L "+i.crispValue(u)+" "+i.crispValue(g)+" M "+i.crispValue(l.x)+" "+i.crispValue(l.y)+" L "+i.crispValue(l.x+l.width)+" "+i.crispValue(l.y)+" L "+i.crispValue(l.x+l.width)+" "+i.crispValue(l.y+l.height)+" L "+i.crispValue(l.x)+" "+i.crispValue(l.y+l.height)+" L "+i.crispValue(l.x)+" "+i.crispValue(l.y)+" z"),a.setAttribute("d","M "+i.crispValue(u)+" "+i.crispValue(g)+" L "+i.crispValue(u)+" "+i.crispValue(g+d)+" L "+i.crispValue(u+S)+" "+i.crispValue(g+d)+" L "+i.crispValue(u+S)+" "+i.crispValue(g)+" L "+i.crispValue(u)+" "+i.crispValue(g)+" z"),s.setAttribute("d","M "+i.crispValue(l.x)+" "+i.crispValue(l.y)+" L "+i.crispValue(l.x+l.width)+" "+i.crispValue(l.y)+" L "+i.crispValue(l.x+l.width)+" "+i.crispValue(l.y+l.height)+" L "+i.crispValue(l.x)+" "+i.crispValue(l.y+l.height)+" L "+i.crispValue(l.x)+" "+i.crispValue(l.y)+" z")):(o.setAttribute("d","M "+u+" "+g+" L "+u+" "+(g+d)+" L "+(u+S)+" "+(g+d)+" L "+(u+S)+" "+g+" L "+u+" "+g+" M "+l.x+" "+l.y+" L "+(l.x+l.width)+" "+l.y+" L "+(l.x+l.width)+" "+(l.y+l.height)+" L "+l.x+" "+(l.y+l.height)+" L "+l.x+" "+l.y+" z"),a.setAttribute("d","M "+u+" "+g+" L "+u+" "+(g+d)+" L "+(u+S)+" "+(g+d)+" L "+(u+S)+" "+g+" L "+u+" "+g+" z"),s.setAttribute("d","M "+l.x+" "+l.y+" L "+(l.x+l.width)+" "+l.y+" L "+(l.x+l.width)+" "+(l.y+l.height)+" L "+l.x+" "+(l.y+l.height)+" L "+l.x+" "+l.y+" z")),f.getDrawFill()?o.setAttribute("fill",f.getFillColor()):o.setAttribute("fill","none"),f.getDrawLines()?(a.setAttribute("stroke",f.getLineColor()),a.setAttribute("stroke-width",f.getLineWidth())):(a.setAttribute("stroke","none"),a.setAttribute("stroke-width",0)),E.getDrawLines()?(s.setAttribute("stroke",E.getLineColor()),s.setAttribute("stroke-width",E.getLineWidth())):(s.setAttribute("stroke","none"),s.setAttribute("stroke-width",0)),o.setAttribute("shapeRendering",E.getShapeRendering()),a.setAttribute("shapeRendering",f.getShapeRendering()),s.setAttribute("shapeRendering",E.getShapeRendering())}},t.drawPanel=function(e){var n=EJSS_SVGGRAPHICS.Utils,i=r.getElementById(".myPanel");null===i&&(i=document.createElementNS("http://www.w3.org/2000/svg","path"),
i.setAttribute("id",".myPanel"),r.appendChild(i));var o=.5,a=.5,s=t.getBox(),l=s.width,u=s.height,g=e.getStyle();"crispEdges"==g.getShapeRendering()?i.setAttribute("d","M "+n.crispValue(o)+" "+n.crispValue(a)+" L "+n.crispValue(o)+" "+n.crispValue(a+u)+" L "+n.crispValue(o+l)+" "+n.crispValue(a+u)+" L "+n.crispValue(o+l)+" "+n.crispValue(a)+" z"):i.setAttribute("d","M "+o+" "+a+" L "+o+" "+(a+u)+" L "+(o+l)+" "+(a+u)+" L "+(o+l)+" "+a+" z"),g.getDrawFill()?i.setAttribute("fill",g.getFillColor()):i.setAttribute("fill","none"),g.getDrawLines()?(i.setAttribute("stroke",g.getLineColor()),i.setAttribute("stroke-width",g.getLineWidth())):(i.setAttribute("stroke","none"),i.setAttribute("stroke-width",0)),i.setAttribute("shapeRendering",g.getShapeRendering())},t.importSVG=function(e){var r=(new XMLSerializer).serializeToString(t.getDOMElement()),n=document.createElement("canvas"),i=t.getBox();n.width=i.width+1,n.height=i.height+1;var o=n.getContext("2d"),a=new Image;return a.src="data:image/svg+xml;utf8,"+r,a.onload=function(){o.drawImage(a,0,0),e&&e(n.toDataURL("image/png"))},a.src},t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.InfoText={registerProperties:function(e,t){EJSS_DRAWING2D.Text.registerProperties(e,t),t.registerProperty("Info",e.setInfo),t.registerProperty("Format",e.setFormat)}},EJSS_DRAWING2D.infoText=function(e){function t(e,t){if(!Array.isArray(t)||"undefined"==typeof n)return t;for(var r="",i=e,o=e.match(/[0-9]*\.(\^|#)+/g),a=0;a<o.length;a++){var s=o[a].split("#").length-1;r=isNaN(t[a])?t[a]:t[a].toFixed(s),i=i.replace(o[a],r)}return i}var r,n,i=EJSS_DRAWING2D.text(e),o=i.getText;return i.setInfo=function(e){r=e},i.getText=function(){if("undefined"==typeof r){var e=o();return t(n,e)}return r.getInfo?r.getInfo():"function"==typeof r?r():void 0},i.setFormat=function(e){n=e},i.isChanged=function(){return!0},i.registerProperties=function(e){EJSS_DRAWING2D.InfoText.registerProperties(i,e)},i};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Mesh={},EJSS_DRAWING2D.mesh=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Pipe={},EJSS_DRAWING2D.pipe=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.PlottingPanel={registerProperties:function(e,t){EJSS_DRAWING2D.DrawingPanel.registerProperties(e,t),t.registerProperty("Title",e.getTitle().setText),t.registerProperty("TitleFont",e.getTitle().getFont().setFont),t.registerProperty("TitleColor",e.getTitle().getFont().setFillColor),t.registerProperty("TitleMargin",e.getTitle().setMarginY),t.registerProperty("TitleX",e.getTitleX().setText),t.registerProperty("TitleXFont",e.getTitleX().getFont().setFont),t.registerProperty("TitleXColor",e.getTitleX().getFont().setFillColor),t.registerProperty("TitleXMargin",e.getTitleX().setMarginY),t.registerProperty("TitleY",e.getTitleY().setText),t.registerProperty("TitleYFont",e.getTitleY().getFont().setFont),t.registerProperty("TitleYColor",e.getTitleY().getFont().setFillColor),t.registerProperty("TitleYMargin",e.getTitleY().setMarginX),t.registerProperty("GridXShow",e.getGrid().setShowX,e.getGrid().getShowX),t.registerProperty("GridXTicks",e.getGrid().setTicksX,e.getGrid().getTicksX),t.registerProperty("GridXStep",e.getGrid().setStepX,e.getGrid().getStepX),t.registerProperty("GridXAutoStepMin",e.getGrid().setAutoStepXMin,e.getGrid().getAutoStepXMin),t.registerProperty("GridXAutoTicksRange",e.getGrid().setAutoTicksXRange,e.getGrid().getAutoTicksXRange),t.registerProperty("GridXScale",e.getGrid().setScaleX,e.getGrid().getScaleX),t.registerProperty("GridXScalePrecision",e.getGrid().setScalePrecisionX,e.getGrid().getScalePrecisionX),t.registerProperty("GridXFixedTick",e.getGrid().setFixedTickX,e.getGrid().getFixedTickX),t.registerProperty("GridXAutoTicks",e.getGrid().setAutoTicksX,e.getGrid().getAutoTicksX),t.registerProperty("GridXLineColor",e.getGrid().setLineColorX),t.registerProperty("GridXLineWidth",e.getGrid().setLineWidthX),t.registerProperty("GridXShapeRendering",e.getGrid().setShapeRenderingX),t.registerProperty("GridYShow",e.getGrid().setShowY,e.getGrid().getShowY),t.registerProperty("GridYTicks",e.getGrid().setTicksY,e.getGrid().getTicksY),t.registerProperty("GridYStep",e.getGrid().setStepY,e.getGrid().getStepY),t.registerProperty("GridYAutoStepMin",e.getGrid().setAutoStepYMin,e.getGrid().getAutoStepYMin),t.registerProperty("GridYAutoTicksRange",e.getGrid().setAutoTicksYRange,e.getGrid().getAutoTicksYRange),t.registerProperty("GridYScale",e.getGrid().setScaleY,e.getGrid().getScaleY),t.registerProperty("GridYScalePrecision",e.getGrid().setScalePrecisionY,e.getGrid().getScalePrecisionY),t.registerProperty("GridYFixedTick",e.getGrid().setFixedTickY,e.getGrid().getFixedTickY),t.registerProperty("GridYAutoTicks",e.getGrid().setAutoTicksY,e.getGrid().getAutoTicksY),t.registerProperty("GridYLineColor",e.getGrid().setLineColorY),t.registerProperty("GridYLineWidth",e.getGrid().setLineWidthY),t.registerProperty("GridYShapeRendering",e.getGrid().setShapeRenderingY),t.registerProperty("AxisXShow",e.getAxisX().setShow),t.registerProperty("AxisXLineColor",e.getAxisX().getStyle().setLineColor),t.registerProperty("AxisXLineWidth",e.getAxisX().getStyle().setLineWidth),t.registerProperty("AxisXShapeRendering",e.getAxisX().getStyle().setShapeRendering),t.registerProperty("AxisXFixedTick",e.getAxisX().setFixedTick,e.getAxisX().getFixedTick),t.registerProperty("AxisXAutoTicks",e.getAxisX().setAutoTicks,e.getAxisX().getAutoTicks),t.registerProperty("AxisXTicks",e.getAxisX().setTicks,e.getAxisX().getTicks),t.registerProperty("AxisXStep",e.getAxisX().setStep,e.getAxisX().getStep),t.registerProperty("AxisXTickStep",e.getAxisX().setTickStep,e.getAxisX().getTickStep),t.registerProperty("AxisXAutoStepMin",e.getAxisX().setAutoStepMin,e.getAxisX().getAutoStepMin),t.registerProperty("AxisXAutoTicksRange",e.getAxisX().setAutoTicksRange,e.getAxisX().getAutoTicksRange),t.registerProperty("AxisXScale",e.getAxisX().setScale,e.getAxisX().getScale),t.registerProperty("AxisXScalePrecision",e.getAxisX().setScalePrecision,e.getAxisX().getScalePrecision),t.registerProperty("AxisXFont",e.getAxisX().getFont().setFont),t.registerProperty("AxisXFontColor",e.getAxisX().getFont().setFillColor),t.registerProperty("AxisYShow",e.getAxisY().setShow),t.registerProperty("AxisYLineColor",e.getAxisY().getStyle().setLineColor),t.registerProperty("AxisYLineWidth",e.getAxisY().getStyle().setLineWidth),t.registerProperty("AxisYShapeRendering",e.getAxisY().getStyle().setShapeRendering),t.registerProperty("AxisYFixedTick",e.getAxisY().setFixedTick,e.getAxisY().getFixedTick),t.registerProperty("AxisYAutoTicks",e.getAxisY().setAutoTicks,e.getAxisY().getAutoTicks),t.registerProperty("AxisYTicks",e.getAxisY().setTicks,e.getAxisY().getTicks),t.registerProperty("AxisYStep",e.getAxisY().setStep,e.getAxisY().getStep),t.registerProperty("AxisYTickStep",e.getAxisY().setTickStep,e.getAxisY().getTickStep),t.registerProperty("AxisYAutoStepMin",e.getAxisY().setAutoStepMin,e.getAxisY().getAutoStepMin),t.registerProperty("AxisYAutoTicksRange",e.getAxisY().setAutoTicksRange,e.getAxisY().getAutoTicksRange),t.registerProperty("AxisYScale",e.getAxisY().setScale,e.getAxisY().getScale),t.registerProperty("AxisYScalePrecision",e.getAxisY().setScalePrecision,e.getAxisY().getScalePrecision),t.registerProperty("AxisYFont",e.getAxisY().getFont().setFont),t.registerProperty("AxisYFontColor",e.getAxisY().getFont().setFillColor),t.registerProperty("XFixedTick",function(t){e.getAxisX().setFixedTick(t),e.getGrid().setFixedTickX(t)}),t.registerProperty("YFixedTick",function(t){e.getAxisY().setFixedTick(t),e.getGrid().setFixedTickY(t)}),t.registerProperty("XTicks",function(t){e.getAxisX().setTicks(t),e.getGrid().setTicksX(t)}),t.registerProperty("YTicks",function(t){e.getAxisY().setTicks(t),e.getGrid().setTicksY(t)}),t.registerProperty("XStep",function(t){e.getAxisX().setStep(t),e.getGrid().setStepX(t)}),t.registerProperty("YStep",function(t){e.getAxisY().setStep(t),e.getGrid().setStepY(t)}),t.registerProperty("XTickStep",function(t){e.getAxisX().setTickStep(t),e.getGrid().setTickStepX(t)}),t.registerProperty("YTickStep",function(t){e.getAxisY().setTickStep(t),e.getGrid().setTickStepY(t)}),t.registerProperty("XAutoStepMin",function(t){e.getAxisX().setAutoStepMin(t),e.getGrid().setAutoStepXMin(t)}),t.registerProperty("YAutoStepMin",function(t){e.getAxisY().setAutoStepMin(t),e.getGrid().setAutoStepYMin(t)}),t.registerProperty("XAutoTicksRange",function(t){e.getAxisX().setAutoTicksRange(t),e.getGrid().setAutoTicksXRange(t)}),t.registerProperty("YAutoTicksRange",function(t){e.getAxisY().setAutoTicksRange(t),e.getGrid().setAutoTicksyRange(t)}),t.registerProperty("XScale",function(t){e.getAxisX().setScale(t),e.getGrid().setScaleX(t)}),t.registerProperty("YScale",function(t){e.getAxisY().setScale(t),e.getGrid().setScaleY(t)}),t.registerProperty("XScalePrecision",function(t){e.getAxisX().setScalePrecision(t),e.getGrid().setScalePrecisionX(t)}),t.registerProperty("YScalePrecision",function(t){e.getAxisY().setScalePrecision(t),e.getGrid().setScalePrecisionY(t)}),t.registerProperty("XAutoTicks",function(t){e.getAxisX().setAutoTicks(t),e.getGrid().setAutoTicksX(t)}),t.registerProperty("YAutoTicks",function(t){e.getAxisY().setAutoTicks(t),e.getGrid().setAutoTicksY(t)})}},EJSS_DRAWING2D.plottingPanel=function(e,t){var r=EJSS_DRAWING2D.drawingPanel(e,t);r.getGrid=function(){return i},r.getAxisX=function(){return a},r.getAxisY=function(){return s},r.getTitleX=function(){return l},r.getTitleY=function(){return u},r.getTitle=function(){return g},r.registerProperties=function(e){EJSS_DRAWING2D.PlottingPanel.registerProperties(r,e)};var n=EJSS_DRAWING2D.group(e+".bottomgroup");n.setRelativePosition("SOUTH_WEST"),n.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldXMin(),i=r.getRealWorldXMax(),o=r.getRealWorldYMin(),a=r.getRealWorldYMax(),s=Math.abs(i-t),l=Math.abs(a-o);return n.setSize([s,l]),n.setPosition([t,o]),!0}},n.panelChangeListener("bounds");var i=EJSS_DRAWING2D.grid(e+".grid");i.setGroup(n),i.setRelativePosition("SOUTH_WEST"),i.setLineColorX("lightgray"),i.setShapeRenderingX("RENDER_CRISPEDGES"),i.setLineColorY("lightgray"),i.setShapeRenderingY("RENDER_CRISPEDGES"),i.setSize([1,1]),i.setPosition([0,0]),i.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldXMin(),n=r.getRealWorldXMax();i.setScaleX([t,n]),i.setTicksXMode(r.getTypeScaleX());var o=r.getRealWorldYMin(),a=r.getRealWorldYMax();return i.setScaleY([o,a]),i.setTicksYMode(r.getTypeScaleY()),!0}};var o=EJSS_DRAWING2D.group(e+".topgroup");o.setRelativePosition("SOUTH_WEST"),o.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldXMin(),n=r.getRealWorldXMax(),i=r.getRealWorldYMin(),a=r.getRealWorldYMax(),s=Math.abs(n-t),l=Math.abs(a-i);return o.setSize([s,l]),o.setPosition([t,i]),!0}},o.panelChangeListener("bounds");var a=EJSS_DRAWING2D.axis(e+".axisX");a.setGroup(o),a.setRelativePosition("WEST"),a.getStyle().setLineColor("black"),a.getStyle().setShapeRendering("RENDER_CRISPEDGES"),a.getFont().setFontSize(10),a.setSize([1,1]),a.setPosition([0,0]),a.setOrient("AXIS_HORIZONTAL"),a.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldXMin(),n=r.getRealWorldXMax();return a.setScale([t,n]),a.setTicksMode(r.getTypeScaleX()),r.getInvertedScaleY()?(a.setTextPosition("TICKS_DOWN"),l.setMarginY(-30),g.setMarginY(20)):(a.setTextPosition("TICKS_UP"),l.setMarginY(30),g.setMarginY(-20)),!0}},a.setTicksMode(r.getTypeScaleX());var s=EJSS_DRAWING2D.axis(e+".axisY");s.setGroup(o),s.setRelativePosition("SOUTH"),s.getStyle().setLineColor("black"),s.getStyle().setShapeRendering("RENDER_CRISPEDGES"),s.getFont().setFontSize(10),s.setSize([1,1]),s.setPosition([0,0]),s.setOrient("AXIS_VERTICAL"),s.panelChangeListener=function(e){if("bounds"==e){var t=r.getRealWorldYMin(),n=r.getRealWorldYMax();return s.setScale([t,n]),s.setTicksMode(r.getTypeScaleY()),s.setInvertedScaleY(r.getInvertedScaleY()),!0}},s.setTicksMode(r.getTypeScaleY());var l=EJSS_DRAWING2D.text(e+".titleX");l.setGroup(o),l.setRelativePosition("CENTER"),l.getFont().setFontSize(12),l.setPosition([.5,0]),l.setMarginY(30),l.setText("x");var u=EJSS_DRAWING2D.text(e+".titleY");u.setGroup(o),u.setRelativePosition("CENTER"),u.getFont().setFontSize(12),u.setWritingMode("MODE_DOWNTOP"),u.setPosition([0,.5]),u.setMarginX(-40),u.setText("y");var g=EJSS_DRAWING2D.text(e+".title");return g.setGroup(o),g.setRelativePosition("CENTER"),g.getFont().setFontSize(12),g.setPosition([.5,1]),g.setMarginY(-20),g.setText("Plot"),r.getStyle().setLineColor("black"),r.getStyle().setFillColor("white"),r.getStyle().setShapeRendering("RENDER_CRISPEDGES"),r._25([50,50,50,50]),r.getGuttersStyle().setLineColor("black"),r.getGuttersStyle().setFillColor("rgb(211,216,255)"),r.getGuttersStyle().setShapeRendering("RENDER_CRISPEDGES"),r.addDecoration(n),r.addDecoration(i),r.addDecoration(o,-1,!0),r.addDecoration(a,-1,!0),r.addDecoration(s,-1,!0),r.addDecoration(l,-1,!0),r.addDecoration(u,-1,!0),r.addDecoration(g,-1,!0),r};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Polygon={},EJSS_DRAWING2D.polygon=function(e){},EJSS_DRAWING2D.PolygonSet={},EJSS_DRAWING2D.polygonSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Segment={registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Offset",e.setRelativePosition,e.getRelativePosition)}},EJSS_DRAWING2D.segment=function(e){var t=EJSS_DRAWING2D.element(e);return t._23=function(){return"ElementSegment"},t.registerProperties=function(e){EJSS_DRAWING2D.Segment.registerProperties(t,e)},t.setSize([.1,.1]),t.setRelativePosition("SOUTH_WEST"),t},EJSS_DRAWING2D.SegmentSet={},EJSS_DRAWING2D.segmentSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Shape={NONE:0,ELLIPSE:1,RECTANGLE:2,ROUND_RECTANGLE:3,WHEEL:4,POINT:5,registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("ShapeType",e.setShapeType),t.registerProperty("CornerRadius",e.setCornerRadius)},copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),t.setShapeType(e.getShapeType()),t.setCornerRadius(e.getCornerRadius())}},EJSS_DRAWING2D.shape=function(e){var t=EJSS_DRAWING2D.element(e),r=10,n=EJSS_DRAWING2D.Shape.ELLIPSE;return t.setShapeType=function(e){n="string"==typeof e?EJSS_DRAWING2D.Shape[e.toUpperCase()]:e},t.getShapeType=function(){return n},t.setCornerRadius=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getCornerRadius=function(){return r},t._23=function(){return"ElementShape"},t.registerProperties=function(e){EJSS_DRAWING2D.Shape.registerProperties(t,e)},t.copyTo=function(e){EJSS_DRAWING2D.Shape.copyTo(t,e)},t.setSize([.1,.1]),t.setRelativePosition("CENTER"),t.getStyle().setFillColor("Blue"),t.getStyle().setLineColor("Black"),t},EJSS_DRAWING2D.ShapeSet={},EJSS_DRAWING2D.shapeSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.SimplePanel={GRAPHICS2D_SVG:"SVG",GRAPHICS2D_CANVAS:"Canvas",registerProperties:function(e,t){t.registerProperty("MinimumX",e.setWorldXMin,e.getWorldXMin),t.registerProperty("MaximumX",e.setWorldXMax,e.getWorldXMax),t.registerProperty("MinimumY",e.setWorldYMin,e.getWorldYMin),t.registerProperty("MaximumY",e.setWorldYMax,e.getWorldYMax),t.registerProperty("Bounds",e.setWorldCoordinates,e.getWorldCoordinates),t.registerProperty("MarginX",e.setMarginX,e.getMarginX),t.registerProperty("MarginY",e.setMarginY,e.getMarginY),t.registerProperty("Parent",e.getGraphics().setParent,e.getGraphics().getParent),t.registerProperty("Width",e.getGraphics().setWidth,e.getGraphics().getWidth),t.registerProperty("Height",e.getGraphics().setHeight,e.getGraphics().getHeight),t.registerProperty("Graphics",e.setGraphics),t.registerProperty("Background",e.getStyle().setFillColor),t.registerProperty("Foreground",e.getStyle().setLineColor),t.registerProperty("LineColor",e.getStyle().setLineColor),t.registerProperty("LineWidth",e.getStyle().setLineWidth),t.registerProperty("DrawLines",e.getStyle().setDrawLines),t.registerProperty("FillColor",e.getStyle().setFillColor),t.registerProperty("DrawFill",e.getStyle().setDrawFill),t.registerProperty("ShapeRendering",e.getStyle().setShapeRendering),t.registerProperty("Visibility",e.getGraphics().getStyle().setVisibility),t.registerProperty("Display",e.getGraphics().getStyle().setDisplay),t.registerProperty("CSS",e.getGraphics().getStyle().setCSS)}},EJSS_DRAWING2D.simplePanel=function(e){var t={},r=EJSS_GRAPHICS.svgGraphics(e),n=EJSS_DRAWING2D.style(e),i=[],o=!1,a=[],s={xminPreferred:-1,xmaxPreferred:1,yminPreferred:-1,ymaxPreferred:1,xorigin:0,yorigin:0,xscale:1,yscale:1},l=!0,u=!0;return t.getName=function(){return e},t.getGraphics=function(){return r},t.importGraphics=function(e){return r.importSVG(e)},t.getStyle=function(){return n},t.setGraphics=function(t){t==EJSS_DRAWING2D.SimplePanel.GRAPHICS2D_SVG?r=EJSS_GRAPHICS.svgGraphics(e):t==EJSS_DRAWING2D.SimplePanel.GRAPHICS2D_CANVAS?console.log("WARNING: setGraphics() - Canvas not supported"):console.log("WARNING: setGraphics() - Graphics not supported")},t.setWorldXMin=function(e){e!==s.xminPreferred&&(s.xminPreferred=e,u=!0)},t.getWorldXMin=function(){return s.xminPreferred},t.setWorldXMax=function(e){e!==s.xmaxPreferred&&(s.xmaxPreferred=e,u=!0)},t.getWorldXMax=function(){return s.xmaxPreferred},t.setWorldYMin=function(e){e!==s.yminPreferred&&(s.yminPreferred=e,u=!0)},t.getWorldYMin=function(){return s.yminPreferred},t.setWorldYMax=function(e){e!==s.ymaxPreferred&&(s.ymaxPreferred=e,u=!0)},t.getWorldYMax=function(){return s.ymaxPreferred},t.setWorldCoordinates=function(e){t.setWorldXMin(e[0]),t.setWorldXMax(e[1]),t.setWorldYMin(e[2]),t.setWorldYMax(e[3])},t.getWorldCoordinates=function(){return[t.getWorldXMin(),t.getWorldXMax(),t.getWorldYMin(),t.getWorldYMax()]},t.addElement=function(e,r){EJSS_TOOLS.addToArray(i,e,r),e.setPanel(t),e.dataCollected&&a.push(e),o=!0},t.removeElement=function(e){EJSS_TOOLS.removeFromArray(i,e),e.setPanel(null),e.dataCollected&&EJSS_TOOLS.removeFromArray(a,e),o=!0},t.getElements=function(){return i},t.indexOfElement=function(e){return i.indexOf(e)},t.toPixelAxisY=function(e){return s.yorigin-e-s.yscale*s.yminPreferred},t.toPixelAxisX=function(e){return s.xorigin+e-s.xscale*s.xminPreferred},t._26=function(e){var t=[];return t[0]=s.xorigin+s.xscale*(e[0]-s.xminPreferred),t[1]=s.yorigin+s.yscale*(e[1]-s.yminPreferred),t},t.toPixelMod=function(e){var t=[];return t[0]=e[0]*s.xscale,t[1]=e[1]*s.yscale,t},t.toPanelPosition=function(e){var t=[];return t[0]=s.xminPreferred+(e[0]-s.xorigin)/s.xscale,t[1]=s.yminPreferred+(e[1]-s.yorigin)/s.yscale,t},t.toPanelMod=function(e){var t=[];return t[0]=0==s.xscale?0:e[0]/s.xscale,t[1]=0==s.yscale?0:e[1]/s.yscale,t},t.getPixelPositionWorldOrigin=function(){return[s.xorigin,s.yorigin]},t._27=function(){var e=r.getWidth(),t=r.getHeight(),n=e/(s.xmaxPreferred-s.xminPreferred),i=t/(s.ymaxPreferred-s.yminPreferred);s.xscale=n,s.yscale=-i,s.xorigin=.5,s.yorigin=t+.5,u=!1},t.reset=function(){r.reset()},t.render=function(){var e=!1;o&&(r.reset(),e=!0,o=!1);for(var n=0,s=a.length;n<s;n++)a[n].dataCollected();u&&t._27(),(l||e)&&r.drawPanel(t),r.draw(i,e),l=!1;for(var n=0,s=i.length;n<s;n++)i[n].setChanged(!1)},t.registerProperties=function(e){EJSS_DRAWING2D.SimplePanel.registerProperties(t,e)},n.setLineColor("black"),n.setFillColor("rgb(239,239,255)"),n.setChangeListener(function(e){l=!0}),t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Spring={},EJSS_DRAWING2D.spring=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.SpringSet={},EJSS_DRAWING2D.springSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Tank={},EJSS_DRAWING2D.tank=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Text={MODE_TOPDOWN:0,MODE_RIGTHLEFT:1,MODE_DOWNTOP:2,MODE_LEFTRIGHT:3,copyTo:function(e,t){EJSS_DRAWING2D.Element.copyTo(e,t),EJSS_DRAWING2D.Font.copyTo(e.getFont(),t.getFont()),t.setText(e.getText()),t.setWritingMode(e.getWritingMode())},registerProperties:function(e,t){EJSS_DRAWING2D.Element.registerProperties(e,t),t.registerProperty("Text",e.setText),t.registerProperty("Framed",e.setFramed),t.registerProperty("WritingMode",e.setWritingMode),t.registerProperty("Font",e.getFont().setFont),t.registerProperty("FontFamily",e.getFont().setFontFamily),t.registerProperty("FontSize",e.getFont().setFontSize),t.registerProperty("LetterSpacing",e.getFont().setLetterSpacing),t.registerProperty("OutlineColor",e.getFont().setOutlineColor),t.registerProperty("FontWeight",e.getFont().setFontWeight),t.registerProperty("FillColor",e.getFont().setFillColor),t.registerProperty("FontStyle",e.getFont().setFontStyle),t.registerProperty("MarginX",e.getMarginX().setMarginX),t.registerProperty("MarginY",e.getMarginY().setMarginY)}},EJSS_DRAWING2D.text=function(e){var t=EJSS_DRAWING2D.element(e),r="",n=EJSS_DRAWING2D.Text.MODE_LEFTRIGHT,i=EJSS_DRAWING2D.font(e),o=!1,a=0,s=0;return t._23=function(){return"ElementText"},t.setText=function(e){r!=e&&(r=e,t.setChanged(!0))},t.getText=function(){return r},t.setMarginX=function(e){a!=e&&(a=e,t.setChanged(!0))},t.getMarginX=function(){return a},t.setMarginY=function(e){s!=e&&(s=e,t.setChanged(!0))},t.getMarginY=function(){return s},t.getSizeX=function(){var e=r?r.length:0;return e*i.getFontSize()+e*i.getNumberLetterSpacing()},t.getSizeY=function(){return i.getFontSize()},t.getFont=function(){return i},t.setFramed=function(e){o!=e&&(o=e,t.setChanged(!0))},t.getFramed=function(){return o},t.setWritingMode=function(e){"string"==typeof e&&(e=EJSS_DRAWING2D.Text[e.toUpperCase()]),
n!=e&&(n=e,t.setChanged(!0))},t.getWritingMode=function(){return n},t.registerProperties=function(e){EJSS_DRAWING2D.Text.registerProperties(t,e)},t.copyTo=function(e){EJSS_DRAWING2D.Text.copyTo(t,e)},i.setChangeListener(function(e){t.setChanged(!0)}),t.setPixelSize(!0),t},EJSS_DRAWING2D.TextSet={},EJSS_DRAWING2D.textSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Trace={},EJSS_DRAWING2D.trace=function(e){},EJSS_DRAWING2D.TraceSet={},EJSS_DRAWING2D.traceSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Trail={},EJSS_DRAWING2D.trail=function(e){},EJSS_DRAWING2D.TrailSet={},EJSS_DRAWING2D.trailSet=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.colorCoded=function(e,t){var r=EJSS_DRAWING2D.colorMapper(e,t),n=!1;return r.setSymmetricZ=function(e){n=e},r.isSymmetricZ=function(){return n},r.setAutoscale=function(e){for(var t=Number.MAX_VALUE,i=Number.MIN_VALUE,o=0,a=e.length;o<a;o++){var s=e[o];i=Math.max(i,s),t=Math.min(t,s)}var l=i,u=t;n&&(l=Math.max(Math.abs(t),Math.abs(i)),u=-l),r.setScale(u,l)},r.setAutoscaleArray2=function(e){for(var t=Number.MAX_VALUE,i=Number.MIN_VALUE,o=0,a=e.length;o<a;o++)for(var s=0,l=e[o].length;s<l;s++){var u=e[o][s];i=Math.max(i,u),t=Math.min(t,u)}var g=i,c=t;n&&(g=Math.max(Math.abs(t),Math.abs(i)),c=-g),r.setScale(c,g)},r.setAutoscaleArray3=function(e){for(var t=Number.MAX_VALUE,i=Number.MIN_VALUE,o=0,a=e.length;o<a;o++)for(var s=0,l=e[o].length;s<l;s++)for(var u=0,g=e[o][s].length;u<g;u++){var c=e[o][s][u];i=Math.max(i,c),t=Math.min(t,c)}var S=i,d=t;n&&(S=Math.max(Math.abs(t),Math.abs(i)),d=-S),r.setScale(d,S)},r};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.ColorMapper={CUSTOM:-1,SPECTRUM:0,GRAYSCALE:1,DUALSHADE:2,RED:3,GREEN:4,BLUE:5,BLACK:6,WIREFRAME:7,NORENDER:8,REDBLUE_SHADE:9,getColorPalette:function(e,t){function r(e,t,r){var n={h:Math.round(360*e),s:t,b:r},i={r:0,g:0,b:0};if(0===n.s)return i.r=i.g=i.b=n.h,i;var o=Math.floor(n.h/60),a=n.h/60-o,s=n.b*(1-n.s),l=n.b*(1-a*n.s),u=n.b*(1-(1-a)*n.s);switch(o){case 0:i.r=n.b,i.g=u,i.b=s;break;case 1:i.r=l,i.g=n.b,i.b=s;break;case 2:i.r=s,i.g=n.b,i.b=u;break;case 3:i.r=s,i.g=l,i.b=n.b;break;case 4:i.r=u,i.g=s,i.b=n.b;break;case 5:i.r=n.b,i.g=s,i.b=l}return i.r=Math.round(255*i.r),i.g=Math.round(255*i.g),i.b=Math.round(255*i.b),i}var n=EJSS_DRAWING2D.ColorMapper,i=[];e<2&&(e=2);for(var o=0;o<e;o++){var a=o/(e-1)*.8,s=1,l=1,u=0,g=0,c=0;switch(t){case n.REDBLUE_SHADE:u=Math.floor(255*Math.max(0,-e-1+2*o)/(e-1)),c=Math.floor(255*Math.max(0,e-1-2*o)/(e-1)),i[o]="rgb("+u+","+g+","+c+")";break;case n.SPECTRUM:a=.8-a;var S=r(a,s,l);i[o]="rgb("+S.r+","+S.g+","+S.b+")";break;case n.GRAYSCALE:case n.BLACK:u=g=c=Math.floor(255*o/(e-1)),i[o]="rgb("+u+","+g+","+c+")";break;case n.RED:u=Math.floor(255*o/(e-1)),i[o]="rgb("+u+","+g+","+c+")";break;case n.GREEN:g=Math.floor(255*o/(e-1)),i[o]="rgb("+u+","+g+","+c+")";break;case n.BLUE:c=Math.floor(255*o/(e-1)),i[o]="rgb("+u+","+g+","+c+")";break;case n.DUALSHADE:default:var d=o/(e-1);a=.8*(1-d),l=.2+1.6*Math.abs(.5-d);var S=r(a,s,l);i[o]="rgb("+S.r+","+S.g+","+S.b+")"}}return i}},EJSS_DRAWING2D.colorMapper=function(e,t){var r,n,i,o=EJSS_DRAWING2D.ColorMapper,a={},s=[],l="darkgray",u="lightgray",g=-1,c=1;return a.setChangeListener=function(e){r=e},a.setPaletteType=function(t){"string"==typeof t&&(t=EJSS_DRAWING2D.ColorMapper[t.toUpperCase()]),n=t,l="darkgray",u="lightgray",n!=EJSS_DRAWING2D.ColorMapper.GRAYSCALE&&n!=EJSS_DRAWING2D.ColorMapper.BLACK||(l="rgb(64,64,128)",u="rgb(255,191,191)"),e=Math.max(2,e),s=o.getColorPalette(e,n),r&&r("palette")},a.getColors=function(){return s},a.getFloorColor=function(){return l},a.getCeilColor=function(){return u},a.getNumColors=function(){return e},a.setFloorCeilColor=function(e,t){l=e,u=t},a.setScale=function(e,t){g=e,c=t,i=new Array(s.length+1);for(var r=(c-g)/s.length,n=0,o=s.length;n<o;n++)i[n]=g+n*r;i[s.length]=c},a.getPaletteType=function(){return n},a.setColorPalette=function(t){l="darkgray",u="lightgray",s=t,e=t.length,n=EJSS_DRAWING2D.ColorMapper.CUSTOM,r&&r("colors")},a.setNumberOfColors=function(t){if(t!=e){if(e=t,n==EJSS_DRAWING2D.ColorMapper.CUSTOM){for(var i=[],o=0,s=Math.min(colors.length,e);o<s;o++)i[o]=colors[o];for(var o=colors.length;o<numColors;o++)i[o]=colors[colors.length-1];colors=i}else a.setPaletteType(n);r&&r("numColors")}},a.getNumberOfColors=function(){return e},a.doubleToIndex=function(e){if(g-e>Number.MIN_VALUE)return-1;if(e-c>Number.MIN_VALUE)return s.length;var t=0;return c!=g&&(t=Math.floor(s.length*(e-g)/(c-g))),t=Math.max(0,t),Math.min(t,s.length-1)},a.indexToColor=function(e){return e<0?l:e>=s.length?u:s[e]},a.getColorThresholds=function(){return i},a.setPaletteType(t),a.setScale(-1,1),a};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Font={FONTSTYLES:["normal","italic","oblique","initial"],FONTWEIGHTS:["normal","lighter","bold","bolder","initial","100","200","300","400","500","600","700","800","900"],copyTo:function(e,t){t.setFontFamily(e.getFontFamily()),t.setFontSize(e.getFontSizeString()),t.setLetterSpacing(e.getLetterSpacing()),t.setOutlineColor(e.getOutlineColor()),t.setFontWeight(e.getFontWeight()),t.setFillColor(e.getFillColor())}},EJSS_DRAWING2D.font=function(e){var t,r={},n="Arial",i="20",o="normal",a="none",s="normal",l="black",u="none";return r.setChangeListener=function(e){t=e},r.setFontFamily=function(e){n!=e&&(n=e,t&&t("fontFamily"))},r.getFontFamily=function(){return n},r.setFontSize=function(e){i!=e&&(i=e,t&&t("fontSize"))},r.getFontSize=function(){var e;return e=isNaN(i)?i.indexOf("em")!=-1?10*+i.substr(0,i.indexOf("em")):i.indexOf("px")!=-1?+i.substr(0,i.indexOf("px")):0:+i},r.getFontSizeString=function(){return i},r.setLetterSpacing=function(e){o!=e&&(o=e,t&&t("letterSpacing"))},r.getLetterSpacing=function(){return o},r.getNumberLetterSpacing=function(){var e;return e=isNaN(o)?o.indexOf("px")!=-1?+o.substr(0,o.indexOf("px")):1:+o},r.setOutlineColor=function(e){a!=e&&(a=e,t&&t("lineColor"))},r.getOutlineColor=function(){return a},r.setFontWeight=function(e){s!=e&&FONTWEIGHTS.indexOf(e)>-1&&(s=e,t&&t("fontWeight"))},r.getFontWeight=function(){return s},r.setFillColor=function(e){l!=e&&(l=e,t&&t("fillColor"))},r.getFillColor=function(){return l},r.setFontStyle=function(e){u!=e&&FONTSTYLES.indexOf(e)>-1&&(u=e,t&&t("fontstyle"))},r.getFontStyle=function(){return u},r.getFont=function(){return u+" "+mLineWidth+" "+i+" "+n},r.setFont=function(e){if(!("string"!=typeof e||e.length<=0)){var t=e.split(" ");u=t[0],s=t[1];var r=t[2].split("/");i=r[0],t[3]&&(n=e.substring(e.indexOf(t[3])))}},r};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.functionsParser=function(){function e(e){function t(){}return t.prototype=e,new t}function t(e,t,r,n){this.type_=e,this.index_=t||0,this.prio_=r||0,this.number_=void 0!==n&&null!==n?n:0,this.toString=function(){switch(this.type_){case m:return this.number_;case A:case y:case v:return this.index_;case P:return"CALL";default:return"Invalid Token"}}}function r(e,t,r,n){this.tokens=e,this.ops1=t,this.ops2=r,this.functions=n}function n(e){return"string"==typeof e?(D.lastIndex=0,D.test(e)?"'"+e.replace(D,function(e){var t=I[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+"'":"'"+e+"'"):e}function i(e,t){return Number(e)+Number(t)}function o(e,t){return e-t}function a(e,t){return e*t}function s(e,t){return e/t}function l(e,t){return e%t}function u(e,t){return""+e+t}function g(e){return-e}function c(e){return Math.random()*(e||1)}function S(e){e=Math.floor(e);for(var t=e;e>1;)t*=--e;return t}function d(e,t){return Math.sqrt(e*e+t*t)}function f(e){return e<0?0:1}function E(e,t){return"[object Array]"!=Object.prototype.toString.call(e)?[e,t]:(e=e.slice(),e.push(t),e)}function p(){this.success=!1,this.errormsg="",this.expression="",this.pos=0,this.tokennumber=0,this.tokenprio=0,this.tokenindex=0,this.tmpprio=0,this.ops1={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sqrt:Math.sqrt,log:Math.log,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,"-":g,exp:Math.exp},this.ops2={"+":i,"-":o,"*":a,"/":s,"%":l,"^":Math.pow,",":E,"||":u},this.functions={random:c,fac:S,min:Math.min,max:Math.max,pyt:d,step:f,pow:Math.pow,atan2:Math.atan2},this.consts={E:Math.E,pi:Math.PI,PI:Math.PI}}var h={},m=0,A=1,y=2,v=3,P=4,D=/[\\\'\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,I={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","'":"\\'","\\":"\\\\"};r.prototype={simplify:function(n){n=n||{};var i,o,a,s,l=[],u=[],g=this.tokens.length,c=0;for(c=0;c<g;c++){s=this.tokens[c];var S=s.type_;if(S===m)l.push(s);else if(S===v&&s.index_ in n)s=new t(m,0,0,n[s.index_]),l.push(s);else if(S===y&&l.length>1)o=l.pop(),i=l.pop(),a=this.ops2[s.index_],s=new t(m,0,0,a(i.number_,o.number_)),l.push(s);else if(S===A&&l.length>0)i=l.pop(),a=this.ops1[s.index_],s=new t(m,0,0,a(i.number_)),l.push(s);else{for(;l.length>0;)u.push(l.shift());u.push(s)}}for(;l.length>0;)u.push(l.shift());return new r(u,e(this.ops1),e(this.ops2),e(this.functions))},substitute:function(n,i){i instanceof r||(i=(new p).parse(String(i)));var o,a=[],s=this.tokens.length,l=0;for(l=0;l<s;l++){o=this.tokens[l];var u=o.type_;if(u===v&&o.index_===n)for(var g=0;g<i.tokens.length;g++){var c=i.tokens[g],S=new t(c.type_,c.index_,c.prio_,c.number_);a.push(S)}else a.push(o)}var d=new r(a,e(this.ops1),e(this.ops2),e(this.functions));return d},evaluate:function(e){e=e||{};var t,r,n,i,o=[],a=this.tokens.length,s=0;for(s=0;s<a;s++){i=this.tokens[s];var l=i.type_;if(l===m)o.push(i.number_);else if(l===y)r=o.pop(),t=o.pop(),n=this.ops2[i.index_],o.push(n(t,r));else if(l===v)if(i.index_ in e)o.push(e[i.index_]);else{if(!(i.index_ in this.functions))throw new Error("undefined variable: "+i.index_);o.push(this.functions[i.index_])}else if(l===A)t=o.pop(),n=this.ops1[i.index_],o.push(n(t));else{if(l!==P)throw new Error("invalid Expression");if(t=o.pop(),n=o.pop(),!n.apply||!n.call)throw new Error(n+" is not a function");"[object Array]"==Object.prototype.toString.call(t)?o.push(n.apply(void 0,t)):o.push(n.call(void 0,t))}}if(o.length>1)throw new Error("invalid Expression (parity)");return o[0]},toString:function(e){var t,r,i,o,a=[],s=this.tokens.length,l=0;for(l=0;l<s;l++){o=this.tokens[l];var u=o.type_;if(u===m)a.push(n(o.number_));else if(u===y)r=a.pop(),t=a.pop(),i=o.index_,e&&"^"==i?a.push("Math.pow("+t+","+r+")"):a.push("("+t+i+r+")");else if(u===v)a.push(o.index_);else if(u===A)t=a.pop(),i=o.index_,"-"===i?a.push("("+i+t+")"):a.push(i+"("+t+")");else{if(u!==P)throw new Error("invalid Expression");t=a.pop(),i=a.pop(),a.push(i+"("+t+")")}}if(a.length>1)throw new Error("invalid Expression (parity)");return a[0]},variables:function(){for(var e=this.tokens.length,t=[],r=0;r<e;r++){var n=this.tokens[r];n.type_===v&&t.indexOf(n.index_)==-1&&t.push(n.index_)}return t},toJSFunction:function(e,t){var r=new Function(e,"with(Parser.values) { return "+this.simplify(t).toString(!0)+"; }");return r}},h.parse=function(e){return(new p).parse(e)},h.evaluate=function(e,t){return p.parse(e).evaluate(t)},p.Expression=r,p.values={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sqrt:Math.sqrt,log:Math.log,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,random:c,fac:S,exp:Math.exp,min:Math.min,max:Math.max,pyt:d,step:f,pow:Math.pow,atan2:Math.atan2,E:Math.E,pi:Math.PI,PI:Math.PI};var _=1,C=2,R=4,T=8,N=16,O=32,M=64,b=128,G=256;return p.prototype={parse:function(n){this.errormsg="",this.success=!0;var i=[],o=[];this.tmpprio=0;var a=_|T|R|M,s=0;for(this.expression=n,this.pos=0;this.pos<this.expression.length;)if(this.isOperator())this.isSign()&&a&M?(this.isNegativeSign()&&(this.tokenprio=2,this.tokenindex="-",s++,this.addfunc(o,i,A)),a=_|T|R|M):this.isComment()||(0===(a&C)&&this.error_parsing(this.pos,"unexpected operator"),s+=2,this.addfunc(o,i,y),a=_|T|R|M);else if(this.isNumber()){0===(a&_)&&this.error_parsing(this.pos,"unexpected number");var l=new t(m,0,0,this.tokennumber);o.push(l),a=C|N|O}else if(this.isString()){0===(a&_)&&this.error_parsing(this.pos,"unexpected string");var l=new t(m,0,0,this.tokennumber);o.push(l),a=C|N|O}else if(this.isLeftParenth())0===(a&T)&&this.error_parsing(this.pos,'unexpected "("'),a&b&&(s+=2,this.tokenprio=-2,this.tokenindex=-1,this.addfunc(o,i,P)),a=_|T|R|M|G;else if(this.isRightParenth()){if(a&G){var l=new t(m,0,0,[]);o.push(l)}else 0===(a&N)&&this.error_parsing(this.pos,'unexpected ")"');a=C|N|O|T|b}else if(this.isComma())0===(a&O)&&this.error_parsing(this.pos,'unexpected ","'),this.addfunc(o,i,y),s+=2,a=_|T|R|M;else if(this.isConst()){0===(a&_)&&this.error_parsing(this.pos,"unexpected constant");var u=new t(m,0,0,this.tokennumber);o.push(u),a=C|N|O}else if(this.isOp2())0===(a&R)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(o,i,y),s+=2,a=T;else if(this.isOp1())0===(a&R)&&this.error_parsing(this.pos,"unexpected function"),this.addfunc(o,i,A),s++,a=T;else if(this.isVar()){0===(a&_)&&this.error_parsing(this.pos,"unexpected variable");var g=new t(v,this.tokenindex,0,0);o.push(g),a=C|N|O|T|b}else this.isWhite()||(""===this.errormsg?this.error_parsing(this.pos,"unknown character"):this.error_parsing(this.pos,this.errormsg));for((this.tmpprio<0||this.tmpprio>=10)&&this.error_parsing(this.pos,'unmatched "()"');i.length>0;){var c=i.pop();o.push(c)}return s+1!==o.length&&this.error_parsing(this.pos,"parity"),new r(o,e(this.ops1),e(this.ops2),e(this.functions))},evaluate:function(e,t){return this.parse(e).evaluate(t)},error_parsing:function(e,t){throw this.success=!1,this.errormsg="parse error [column "+e+"]: "+t,new Error(this.errormsg)},addfunc:function(e,r,n){for(var i=new t(n,this.tokenindex,this.tokenprio+this.tmpprio,0);r.length>0&&i.prio_<=r[r.length-1].prio_;)e.push(r.pop());r.push(i)},isNumber:function(){for(var e=!1,t="";this.pos<this.expression.length;){var r=this.expression.charCodeAt(this.pos);if(!(r>=48&&r<=57||46===r))break;t+=this.expression.charAt(this.pos),this.pos++,this.tokennumber=parseFloat(t),e=!0}return e},unescape:function(e,t){for(var r=[],n=!1,i=0;i<e.length;i++){var o=e.charAt(i);if(n){switch(o){case"'":r.push("'");break;case"\\":r.push("\\");break;case"/":r.push("/");break;case"b":r.push("\b");break;case"f":r.push("\f");break;case"n":r.push("\n");break;case"r":r.push("\r");break;case"t":r.push("\t");break;case"u":var a=parseInt(e.substring(i+1,i+5),16);r.push(String.fromCharCode(a)),i+=4;break;default:throw this.error_parsing(t+i,"Illegal escape sequence: '\\"+o+"'")}n=!1}else"\\"==o?n=!0:r.push(o)}return r.join("")},isString:function(){var e=!1,t="",r=this.pos;if(this.pos<this.expression.length&&"'"==this.expression.charAt(this.pos))for(this.pos++;this.pos<this.expression.length;){var n=this.expression.charAt(this.pos);if("'"==n&&"\\"!=t.slice(-1)){this.pos++,this.tokennumber=this.unescape(t,r),e=!0;break}t+=this.expression.charAt(this.pos),this.pos++}return e},isConst:function(){var e;for(var t in this.consts){var r=t.length;if(e=this.expression.substr(this.pos,r),t===e)return this.tokennumber=this.consts[t],this.pos+=r,!0}return!1},isOperator:function(){var e=this.expression.charCodeAt(this.pos);if(43===e)this.tokenprio=0,this.tokenindex="+";else if(45===e)this.tokenprio=0,this.tokenindex="-";else if(124===e){if(124!==this.expression.charCodeAt(this.pos+1))return!1;this.pos++,this.tokenprio=0,this.tokenindex="||"}else if(42===e)this.tokenprio=1,this.tokenindex="*";else if(47===e)this.tokenprio=2,this.tokenindex="/";else if(37===e)this.tokenprio=2,this.tokenindex="%";else{if(94!==e)return!1;this.tokenprio=3,this.tokenindex="^"}return this.pos++,!0},isSign:function(){var e=this.expression.charCodeAt(this.pos-1);return 45===e||43===e},isPositiveSign:function(){var e=this.expression.charCodeAt(this.pos-1);return 43===e},isNegativeSign:function(){var e=this.expression.charCodeAt(this.pos-1);return 45===e},isLeftParenth:function(){var e=this.expression.charCodeAt(this.pos);return 40===e&&(this.pos++,this.tmpprio+=10,!0)},isRightParenth:function(){var e=this.expression.charCodeAt(this.pos);return 41===e&&(this.pos++,this.tmpprio-=10,!0)},isComma:function(){var e=this.expression.charCodeAt(this.pos);return 44===e&&(this.pos++,this.tokenprio=-1,this.tokenindex=",",!0)},isWhite:function(){var e=this.expression.charCodeAt(this.pos);return(32===e||9===e||10===e||13===e)&&(this.pos++,!0)},isOp1:function(){for(var e="",t=this.pos;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||"_"!=r&&(r<"0"||r>"9")))break;e+=r}return e.length>0&&e in this.ops1&&(this.tokenindex=e,this.tokenprio=5,this.pos+=e.length,!0)},isOp2:function(){for(var e="",t=this.pos;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||"_"!=r&&(r<"0"||r>"9")))break;e+=r}return e.length>0&&e in this.ops2&&(this.tokenindex=e,this.tokenprio=5,this.pos+=e.length,!0)},isVar:function(){for(var e="",t=this.pos;t<this.expression.length;t++){var r=this.expression.charAt(t);if(r.toUpperCase()===r.toLowerCase()&&(t===this.pos||"_"!=r&&(r<"0"||r>"9")))break;e+=r}return e.length>0&&(this.tokenindex=e,this.tokenprio=4,this.pos+=e.length,!0)},isComment:function(){var e=this.expression.charCodeAt(this.pos-1);return 47===e&&42===this.expression.charCodeAt(this.pos)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)}},h};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.InteractionTarget={ENABLED_FIXED:0,ENABLED_NONE:0,ENABLED_ANY:1,ENABLED_X:2,ENABLED_Y:3,ENABLED_NO_MOVE:4,SENSITIVITY_BOTH:0,SENSITIVITY_HORIZONTAL:1,SENSITIVITY_VERTICAL:2,SENSITIVITY_ANY:3,copyTo:function(e,t){t.setMotionEnabled(e.getMotionEnabled()),t.setAffectsGroup(e.getAffectsGroup()),t.setActionCommand(e.getActionCommand()),t.setDataObject(e.getDataObject()),t.setSensitivity(e.getSensitivity())}},EJSS_DRAWING2D.interactionTarget=function(e,t,r){var n=EJSS_DRAWING2D.InteractionTarget,i={},o=EJSS_DRAWING2D.Element,a=n.ENABLED_NONE,s=!1,l=null,u=null,g=20,c=n.SENSITIVITY_BOTH;return i.getElement=function(){return e},i.getType=function(){return t},i.setMotionEnabled=function(e){"string"==typeof e?(value=n[e.toUpperCase()],a="undefined"==typeof value?n.ENABLED_NONE:value):a=e},i.getMotionEnabled=function(){return a},i.setSensitivityType=function(e){c="string"==typeof e?n[e.toUpperCase()]:e},i.getSensitivityType=function(){return c},i.isEnabled=function(){return a!=n.ENABLED_NONE},i.setPositionOffset=function(e){r=e},i.getPixelPosition=function(){var t=e.getPixelPosition(),n=e.getPixelSizes(),i=e.getRelativePositionOffset(n),a=t[0]+i[0],s=t[1]+i[1],l=e.getPanel().getInvertedScaleY(),u=o.getRelativePositionOffset(r,n[0],n[1],l);return[a-u[0],s-u[1]]},i.getPosition=function(){var t=e.getAbsolutePosition(),n=e.getAbsoluteSize(),i=e.getPanel().getInvertedScaleY(),a=o.getRelativePositionOffset(r,n[0],n[1],i),s=e.getRelativePositionOffset(n),l=t[0]+s[0]-a[0],u=t[1]+s[1]-a[1];return[l,u]},i.setAffectsGroup=function(e){s=e},i.getAffectsGroup=function(){return s},i.setSensitivity=function(e){g=e},i.getSensitivity=function(){return g},i.setActionCommand=function(e){l=e},i.getActionCommand=function(){return l},i.setDataObject=function(e){u=e},i.getDataObject=function(){return u},i};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.PanelInteraction={TARGET_POSITION:0,TARGET_SIZE:1},EJSS_DRAWING2D.panelInteraction=function(e){function t(e,t,r){var n=EJSS_DRAWING2D.InteractionTarget,i=EJSS_DRAWING2D.PanelInteraction;if(t.getType()===i.TARGET_POSITION){var o=t.getPosition(),a=r[0]-o[0],s=r[1]-o[1];switch(t.getMotionEnabled()){case n.ENABLED_ANY:e.setX(e.getX()+a),e.setY(e.getY()+s),e.getController().propertiesChanged("Position","X","Y");break;case n.ENABLED_X:e.setX(e.getX()+a),e.getController().propertiesChanged("Position","X");break;case n.ENABLED_Y:e.setY(e.getY()+s),e.getController().propertiesChanged("Position","Y")}}else if(t.getType()===i.TARGET_SIZE){var o=t.getPosition(),a=r[0]-o[0],s=r[1]-o[1],l=t.getElement(),u=l.getAbsoluteSize();0===u[0]&&(u[0]=1e-5),0===u[1]&&(u[1]=1e-5);var g=[a/u[0],s/u[1]],c=e.getSize();switch(0===c[0]&&0!==g[0]&&(c[0]=1e-5),0===c[1]&&0!==g[0]&&(c[1]=1e-5),t.getMotionEnabled()){case n.ENABLED_ANY:e.setSizeX(c[0]+c[0]*g[0]),e.setSizeY(c[1]+c[1]*g[1]),e.getController().propertiesChanged("Size","SizeX","SizeY");break;case n.ENABLED_X:e.setSizeX(c[0]+c[0]*g[0]),e.getController().propertiesChanged("Size","SizeX");break;case n.ENABLED_Y:e.setSizeY(c[1]+c[1]*g[1]),e.getController().propertiesChanged("Size","SizeY")}}}function r(t){var r=e.getGraphics().getBox(),n=r.left,i=r.top,o=[];if("undefined"!=typeof t.changedTouches)for(var a=0;a<t.changedTouches.length;a++)o[a]=[],o[a][0]=t.changedTouches[a].pageX-window.pageXOffset-n,
o[a][1]=t.changedTouches[a].pageY-window.pageYOffset-i;else o[0]=[],o[0][0]=(t.clientX||t.x)-n,o[0][1]=(t.clientY||t.y)-i;return o}var n={},i=EJSS_DRAWING2D.PanelInteraction,o=!1,a=!1,s=!1,l=[],u=[],g=null,c=!1,S=!1,d=0,f="move",E=0;n.reload=function(){l=[],u=[],g=null,S=!1,d=0,E=0,o=!o,n.setEnabled(!o),a=!a,n.setStopGestures(!a)},n.getPanel=function(){return e},n.getEnabled=function(){return o},n.setStopMoveEvents=function(e){s!=e&&(s=e,s?n.setHandler("move",function(){return!0}):n.setHandler("move",n.handleMouseMoveEvent))},n.setStopGestures=function(e){a!=e&&(a=e,a?(n.setHandler("gesturestart",function(e){return e.preventDefault(),e.stopPropagation(),!1}),n.setHandler("gesturechange",function(e){return e.preventDefault(),e.stopPropagation(),!1}),n.setHandler("gestureend",function(e){return e.preventDefault(),e.stopPropagation(),!1})):(n.setHandler("gesturestart",function(){return!0}),n.setHandler("gesturechange",function(){return!0}),n.setHandler("gestureend",function(){return!0})))},n.setEnabled=function(e){o!=e&&(o=e,o?(s||n.setHandler("move",n.handleMouseMoveEvent),n.setHandler("down",n.handleMouseDownEvent),n.setHandler("up",n.handleMouseUpEvent)):(n.setHandler("move",function(){return!0}),n.setHandler("down",function(){return!0}),n.setHandler("up",function(){return!0})))},n.setCursorTypeForMove=function(e){f=e},n.getInteractionPoint=function(){return l},n.getInteractionBounds=function(){return 0==u.length||0==l.length?[]:[u[0],l[0],u[1],l[1]]},n.getInteractionElement=function(){return g},n.getOrientation=function(){return window.orientation},n.handleMouseMoveEvent=function(i){a&&(i.preventDefault(),i.stopPropagation());var s=r(i);if(l=e.toPanelPosition(s[s.length-1]),S)if(null!=g){var u=g.getAffectsGroup()?g.getElement().getGroup():g.getElement();t(u,g,l),u.getController().invokeAction("OnDrag"),o&&e.getController().invokeAction("OnMove")}else if(c)o&&e.getController().invokeAction("OnDrag");else for(var d=0;d<s.length;d++){var E=n.findInteractionTarget(e.getElements(),s[d]);if(null!=E){var u=E.getAffectsGroup()?E.getElement().getGroup():E.getElement(),p=e.toPanelPosition(s[d]);t(u,E,p),u.getController().invokeAction("OnDrag"),o&&e.getController().invokeAction("OnMove")}else o&&e.getController().invokeAction("OnDrag")}else{var E=n.findInteractionTarget(e.getElements(),s[0]);null===E?(null!=g&&g.getElement().getController().invokeAction("OnExit"),o&&e.getController().invokeAction("OnMove"),i.target.style.cursor="default"):(g!=E&&(null!=g&&g.getElement().getController().invokeAction("OnExit"),E.getElement().getController().invokeAction("OnEnter")),E.isEnabled()?i.target.style.cursor=f:i.target.style.cursor="default"),g=E}return e.getController().reportInteractions(),!1},n.handleMouseDownEvent=function(t){S=!0,s&&n.setHandler("move",n.handleMouseMoveEvent),a&&(t.preventDefault(),t.stopPropagation());var i=r(t);u=e.toPanelPosition(i[0]),l=e.toPanelPosition(i[i.length-1]);for(var d=!1,E=null,p=0;p<i.length;p++)E=n.findInteractionTarget(e.getElements(),i[p]),null!==E?(E.getElement().getController().invokeAction("OnPress"),t.target.style.cursor=f):o&&(e.getController().invokeAction("OnPress"),d=!0);var h="undefined"!=typeof t.touches?t.touches.length:1;return 1==i.length&&1==h?(g=E,c=d):(g=null,c=!1),e.getController().reportInteractions(),!1},n.handleMouseUpEvent=function(t){S=!1,s&&n.setHandler("move",function(){return!0}),a&&(t.preventDefault(),t.stopPropagation());var i=r(t);if(l=e.toPanelPosition(i[i.length-1]),null!=g)g.getElement().getController().invokeAction("OnRelease");else for(var u=0;u<i.length;u++){var c=n.findInteractionTarget(e.getElements(),i[u]);null!==c?c.getElement().getController().invokeAction("OnRelease"):o&&e.getController().invokeAction("OnRelease")}return t.timeStamp-d<500&&e.getController().invokeAction("OnDoubleClick"),d=t.timeStamp,t.target.style.cursor="default",e.getController().reportInteractions(),!1},n.findInteractionTarget=function(t,r){for(var o=EJSS_DRAWING2D.InteractionTarget,a=null,s=t.length-1;s>=0;s--){var l=t[s];if(l.isGroupVisible())if(l.getElements){if(a=n.findInteractionTarget(l.getElements(),r),null!==a)return a}else{for(var u=l.getInteractionTargets(),g=0;g<u.length;g++)if(u[g].isEnabled()){var c=u[g].getSensitivity();if(c>0){var S=u[g].getPixelPosition(),d=!1;switch(u[g].getSensitivityType()){case o.SENSITIVITY_HORIZONTAL:d=Math.abs(S[1]-r[1])<c;break;case o.SENSITIVITY_VERTICAL:d=Math.abs(S[0]-r[0])<c;break;case o.SENSITIVITY_ANY:d=Math.abs(S[0]-r[0])<c||Math.abs(S[1]-r[1])<c;break;default:d=Math.abs(S[0]-r[0])<c&&Math.abs(S[1]-r[1])<c}if(d)return E=s,u[g]}}if(a=l.getInteractionTarget(i.TARGET_POSITION),a.isEnabled()&&!a.getSensitivity()){var f=l.getBounds(),p=e.toPanelPosition(r);if(f.left<p[0]&&f.right>p[0]&&f.bottom<p[1]&&f.top>p[1])return E=s,a}}}return null},n.getIndexElement=function(){return E},n.setHandler=function(t,r){var n=e.getGraphics(),i=n.getEventContext();switch(t){case"move":i.addEventListener("mousemove",r,!1),i.addEventListener("touchmove",r,!1);break;case"down":i.addEventListener("mousedown",r,!1),i.addEventListener("touchstart",r,!1);break;case"up":i.addEventListener("mouseup",r,!1),i.addEventListener("touchend",r,!1);break;case"gesturestart":i.addEventListener("gesturestart",r,!1);break;case"gesturechange":i.addEventListener("gesturechange",r,!1);break;case"gestureend":i.addEventListener("gestureend",r,!1)}return!1};var p=window.onorientationchange;window.onorientationchange=function(){p&&p(),e.getController().invokeAction("OnOrientationChange"),e.getController().reportInteractions()};var h=window.onresize;return window.onresize=function(){h&&h(),e.getController().invokeAction("OnResize"),e.getController().reportInteractions()},n.setStopGestures(!0),n};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Style={RENDER_AUTO:"auto",RENDER_OPTSPEED:"optimizeSpeed",RENDER_CRISPEDGES:"crispEdges",RENDER_GEOPRECISION:"geometricPrecision",copyTo:function(e,t){t.setDrawLines(e.getDrawLines()),t.setLineColor(e.getLineColor()),t.setLineWidth(e.getLineWidth()),t.setDrawFill(e.getDrawFill()),t.setFillColor(e.getFillColor()),t.setAttributes(e.getAttributes()),t.setShapeRendering(e.getShapeRendering())}},EJSS_DRAWING2D.style=function(e){var t,r=EJSS_DRAWING2D.Style,n={},i=!0,o="black",a=.5,s=!0,l="none",u=r.RENDER_AUTO,g={};return n.setChangeListener=function(e){t=e},n.setDrawLines=function(e){e!=i&&(i=e,t&&t("drawlines"))},n.getDrawLines=function(){return i},n.setLineColor=function(e){return"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=o&&(o=e,t&&t("linecolor")),n},n.getLineColor=function(){return o},n.setLineWidth=function(e){e!=a&&(a=e,t&&t("linewidth"))},n.getLineWidth=function(){return a},n.setDrawFill=function(e){e!=s&&(s=e,t&&t("drawfill"))},n.getDrawFill=function(){return s},n.setFillColor=function(e){"string"!=typeof e&&(e=EJSS_TOOLS.DisplayColors.getLineColor(e)),e!=l&&(l=e,t&&t("fillcolor"))},n.getFillColor=function(){return l},n.setShapeRendering=function(e){"RENDER"==e.substring(0,6)&&(e=r[e.toUpperCase()]),u!=e&&(u=e,t&&t("shaperendering"))},n.getShapeRendering=function(){return u},n.setAttributes=function(e){e!=g&&(g=e,t&&t("attributes"))},n.getAttributes=function(){return g},n.serialize=function(){return{mDrawLines:i,mLineColor:o,mLineWidth:a,mDrawFill:s,mFillColor:l,mShapeRendering:u,mAttributes:g}},n.unserialize=function(e){i=e.mDrawLines,o=e.mLineColor,a=e.mLineWidth,s=e.mDrawFill,l=e.mFillColor,u=e.mShapeRendering,g=e.mAttributes},n};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Transformation={compare:function(e,t){return e.radians==t.radians&&e.a==t.a&&e.b==t.b&&e.c==t.c&&e.d==t.d&&e.e==t.e&&e.f==t.f}},EJSS_DRAWING2D.transformation=function(e){e=e||{a:1,b:0,c:0,d:1,e:0,f:0};var t={a:e.a,c:e.c,e:e.e,b:e.b,d:e.d,f:e.f,radians:0};return t.toString=function(){return"a="+t.a+", c="+t.c+", e="+t.e+"\nb="+t.b+", d="+t.d+", f="+t.f},t.setToIdentity=function(){t.a=1,t.c=0,t.e=0,t.b=0,t.d=1,t.f=0,radians=0},t.setTransform=function(e){Array.isArray(e)&&e.length>5?(t.a=e[0],t.c=e[2],t.e=e[4],t.b=e[1],t.d=e[3],t.f=e[5]):(t.a=e.a,t.c=e.c,t.e=e.e,t.b=e.b,t.d=e.d,t.f=e.f,t.radians=e.radians)},t.setToTranslation=function(e,r){t.a=1,t.c=0,t.e=e,t.b=0,t.d=1,t.f=r},t.setToRotation=function(e){var r=Math.cos(e),n=Math.sin(e);t.a=r,t.c=-n,t.e=0,t.b=n,t.d=r,t.f=0,t.radians=e},t.getRotation=function(){return t.radians},t.translate=function(e,r){t.e+=e,t.f+=r},t.scale=function(e,r){t.a*=e,t.b*=e,t.c*=r,t.d*=r},t.concatenate=function(e){var r=t.a,n=t.b,i=t.c,o=t.d,a=t.e,s=t.f;t.a=r*e.a+i*e.b,t.b=n*e.a+o*e.b,t.c=r*e.c+i*e.d,t.d=n*e.c+o*e.d,t.e=r*e.e+i*e.f+a,t.f=n*e.e+o*e.f+s,t.radians+=e.radians},t.transform=function(e){var r=e[0],n=e[1];return e[0]=t.a*r+t.c*n+t.e,e[1]=t.b*r+t.d*n+t.f,e},t.transformVector=function(e){var r=e[0],n=e[1];return e[0]=t.a*r+t.c*n,e[1]=t.b*r+t.d*n,e},t.inverseTransform=function(e){var r=t.a,n=t.b,i=t.c,o=t.d,a=t.e,s=t.f,l=r*o-n*i;if(0===l)return null;var u=e[0],g=e[1];return e[0]=(o*u-i*g+(i*s-o*a))/l,e[1]=(-n*u+r*g+(n*a-r*s))/l,e},t};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.Video={},EJSS_DRAWING2D.video=function(e){};var EJSS_DRAWING2D=EJSS_DRAWING2D||{};EJSS_DRAWING2D.WebCamImage={},EJSS_DRAWING2D.webCamImage=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.AnalyticCurve={},EJSS_DRAWING3D.analyticCurve=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.AnalyticSurface={},EJSS_DRAWING3D.analyticSurface=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Arrow={},EJSS_DRAWING3D.arrow=function(e){},EJSS_DRAWING3D.ArrowSet={},EJSS_DRAWING3D.arrowSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Basic={},EJSS_DRAWING3D.basic=function(e){},EJSS_DRAWING3D.BasicSet={},EJSS_DRAWING3D.basicSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Box={},EJSS_DRAWING3D.box=function(e){},EJSS_DRAWING3D.BoxSet={},EJSS_DRAWING3D.boxSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Cone={},EJSS_DRAWING3D.cone=function(e){},EJSS_DRAWING3D.ConeSet={},EJSS_DRAWING3D.coneSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Cylinder={},EJSS_DRAWING3D.cylinder=function(e){},EJSS_DRAWING3D.CylinderSet={},EJSS_DRAWING3D.cylinderSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Disk={},EJSS_DRAWING3D.disk=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.DrawingPanel={},EJSS_DRAWING3D.drawingPanel=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Element={},EJSS_DRAWING3D.element=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.ElementSet={},EJSS_DRAWING3D.elementSet=function(e,t){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Ellipsoid={},EJSS_DRAWING3D.ellipsoid=function(e){},EJSS_DRAWING3D.EllipsoidSet={},EJSS_DRAWING3D.ellipsoidSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Group={},EJSS_DRAWING3D.group=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.panelInteraction=function(e){function t(t){var r,n;"undefined"!=typeof t.changedTouches&&1===t.changedTouches.length?(r=t.changedTouches[0].pageX,n=t.changedTouches[0].pageY):(r=t.x||t.clientX,n=t.y||t.clientY);var i=e.getGraphics().getOffsetLeft(),o=e.getGraphics().getOffsetTop();return[r-i,n-o]}var r={},n=!1,i=[0,0],o=0,a=0,s=!1,l=0,u=0,g=0;return r.getPanel=function(){return e},r.getEnabled=function(){return n},r.setEnabled=function(e){n!=e&&(n=e,n?(r.setHandler("move",r.handleMouseMoveEvent),r.setHandler("down",r.handleMouseDownEvent),r.setHandler("up",r.handleMouseUpEvent),r.setHandler("mousewheel",r.handleMouseWheelEvent),r.setHandler("pinch",r.handlePinchGesture)):(r.setHandler("move",function(){}),r.setHandler("down",function(){}),r.setHandler("up",function(){}),r.setHandler("mousewheel",function(){}),r.setHandler("pinch",function(){})))},r.getInteractionPoint=function(){return i},r.getInteractionDeltas=function(){return[o,a]},r.getInteractionZoomDelta=function(){return u/3},r.handleMouseWheelEvent=function(t){var r="undefined"!=typeof t.touches?t.touches.length:0;0==r&&(t.preventDefault(),u=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),e.getController().invokeAction("OnZoom"),e.getController().reportInteractions())},r.handlePinchGesture=function(t){t.timeStamp-l>100&&(t.preventDefault(),t.scale<g?u=1:t.scale>=g&&(u=-1),g=t.scale,e.getController().invokeAction("OnZoom"),e.getController().reportInteractions(),l=t.timeStamp)},r.handleMouseMoveEvent=function(r){var n="undefined"!=typeof r.touches?r.touches.length:1;if(1==n){var l=i[0],u=i[1];i=t(r),o=i[0]-l,a=i[1]-u,s?(e.getController().invokeAction("OnDrag"),r.target.style.cursor="move"):r.target.style.cursor="default",e.getController().reportInteractions()}},r.handleMouseDownEvent=function(n){var o="undefined"!=typeof n.touches?n.touches.length:1;1==o&&(s=!0,i=t(n),e.getController().invokeAction("OnPress"),r.pick(i[0],i[1]),n.preventDefault(),e.getController().reportInteractions())},r.handleMouseUpEvent=function(r){var n="undefined"!=typeof r.touches?r.touches.length:1;1==n&&(s=!1,i=t(r),e.getController().invokeAction("OnRelease"),r.target.style.cursor="default",r.timeStamp-l<500&&e.getController().invokeAction("OnDoubleClick"),l=r.timeStamp,e.getController().reportInteractions())},r.setHandler=function(t,r){var n=e.getGraphics(),i=n.getEventContext();switch(t){case"move":i.addEventListener("mousemove",r,!1),i.addEventListener("touchmove",r,!1);break;default:case"down":i.addEventListener("mousedown",r,!1),i.addEventListener("touchstart",r,!1);break;case"up":i.addEventListener("mouseup",r,!1),i.addEventListener("touchend",r,!1);break;case"mousewheel":i.addEventListener("mousewheel",r,!1);break;case"pinch":i.addEventListener("gesturestart",function(e){g=1},!1),i.addEventListener("gesturechange",r,!1)}return!1},r.pick=function(t,r){var n=t-1,i=r-1,o=1,a=1,s=e.getGraphics().getContext();if(s){var l=new Uint8Array(o*a*4);s.readPixels(n,i,o,a,s.RGBA,s.UNSIGNED_BYTE,l),l.data&&(l=l.data)}},r};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Style={copyTo:function(e,t){t.setClosedTop(e.getClosedTop()),t.setClosedBottom(e.getClosedBottom()),t.setClosedLeft(e.getClosedLeft()),t.setClosedRight(e.getClosedRight()),t.setDrawLines(e.getDrawLines()),t.setLineColor(e.getLineColor()),t.setLineWidth(e.getLineWidth()),t.setDrawFill(e.getDrawFill()),t.setFillColor(e.getFillColor()),t.setTransparency(e.getTransparency())}},EJSS_DRAWING3D.style=function(e){var t,r,n={},i=!0,o=!0,a=!0,s=!0,l=[0,0,0],u=[0,0,0],g=.5,c=!1,S=!0,d=0;return n.setProjChangeListener=function(e){t=e},n.setMeshChangeListener=function(e){r=e},n.setClosedTop=function(e){e!=i&&(i=e,r&&r("closedtop"))},n.getClosedTop=function(){return i},n.setClosedBottom=function(e){e!=o&&(o=e,r&&r("closedbottom"))},n.getClosedBottom=function(){return o},n.setClosedLeft=function(e){e!=a&&(a=e,r&&r("closedleft"))},n.getClosedLeft=function(){return a},n.setClosedRight=function(e){e!=s&&(s=e,r&&r("closedright"))},n.getClosedRight=function(){return s},n.setDrawLines=function(e){e!=c&&(c=e,t&&t("drawlines"))},n.getDrawLines=function(){return c},n.setLineColor=function(e){return"string"==typeof e&&(e=EJSS_TOOLS.DisplayColors.getArrayColor(e)),EJSS_TOOLS.compareArrays(e,l)||(l=e.slice(),t&&t("linecolor")),n},n.getLineColor=function(){return l},n.setLineWidth=function(e){e!=g&&(g=e,t&&t("linewidth"))},n.getLineWidth=function(){return g},n.setDrawFill=function(e){e!=S&&(S=e,t&&t("drawfill"))},n.getDrawFill=function(){return S},n.setFillColor=function(e){"string"==typeof e&&(e=EJSS_TOOLS.DisplayColors.getArrayColor(e)),EJSS_TOOLS.compareArrays(e,u)||(u=e.slice(),t&&t("fillcolor"))},n.getFillColor=function(){return u},n.setTransparency=function(e){e!=d&&(d=e,t&&t("transparency"))},n.getTransparency=function(){return d},n};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Transformation={registerProperties:function(e,t){e.setController(t),t.registerProperty("Parent",e.setParent,e.getParent),t.registerProperty("Axis",e.setAxis,e.getAxis),t.registerProperty("Angle",e.setAngle,e.getAngle),t.registerProperty("Origin",e.setOrigin,e.getOrigin)}},EJSS_DRAWING3D.rotationX=function(e){var t=EJSS_DRAWING3D.transformation();return t.setAxis([1,0,0]),t},EJSS_DRAWING3D.rotationY=function(e){var t=EJSS_DRAWING3D.transformation();return t.setAxis([0,1,0]),t},EJSS_DRAWING3D.rotationZ=function(e){var t=EJSS_DRAWING3D.transformation();return t.setAxis([0,0,1]),t},EJSS_DRAWING3D.transformation=function(e){var t={},r=null,n=[0,0,0,1,0,0,0],i={propertiesChanged:function(){},invokeAction:function(){}};return t.getArray=function(){return n},t.setChanged=function(e){e&&r.setProjChanged(!0)},t.setParent=function(e){r&&r.removeExtraTransformation(t),r=e,r&&r.addExtraTransformation(t)},t.getParent=function(){return r},t.setAngle=function(e){n[0]=e},t.getAngle=function(){return n[0]},t.setAxis=function(e){n[1]=e[0],n[2]=e[1],n[3]=e[2]},t.getAxis=function(){return n.slice(1,4)},t.setOrigin=function(e){n[4]=e[0],n[5]=e[1],n[6]=e[2]},t.getOrigin=function(){return n.slice(5)},t.getController=function(){return i},t.setController=function(e){i=e},t.registerProperties=function(e){EJSS_DRAWING3D.Transformation.registerProperties(t,e)},t};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.analyticCurve=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.analyticSurface=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.arrow=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.basic=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.box=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.cylinder=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.ellipsoid=function(e,t){};var hasFloat32Array="undefined"!=typeof Float32Array;Matrix.prototype={inverse:function(){return Matrix.inverse(this,new Matrix)},transpose:function(){return Matrix.transpose(this,new Matrix)},multiply:function(e){return Matrix.multiply(this,e,new Matrix)},transformPoint:function(e){var t=this.m;return new Vector(t[0]*e.x+t[1]*e.y+t[2]*e.z+t[3],t[4]*e.x+t[5]*e.y+t[6]*e.z+t[7],t[8]*e.x+t[9]*e.y+t[10]*e.z+t[11]).divide(t[12]*e.x+t[13]*e.y+t[14]*e.z+t[15])},transformVector:function(e){var t=this.m;return new Vector(t[0]*e.x+t[1]*e.y+t[2]*e.z,t[4]*e.x+t[5]*e.y+t[6]*e.z,t[8]*e.x+t[9]*e.y+t[10]*e.z)}},Matrix.inverse=function(e,t){t=t||new Matrix;var r=e.m,n=t.m;n[0]=r[5]*r[10]*r[15]-r[5]*r[14]*r[11]-r[6]*r[9]*r[15]+r[6]*r[13]*r[11]+r[7]*r[9]*r[14]-r[7]*r[13]*r[10],n[1]=-r[1]*r[10]*r[15]+r[1]*r[14]*r[11]+r[2]*r[9]*r[15]-r[2]*r[13]*r[11]-r[3]*r[9]*r[14]+r[3]*r[13]*r[10],n[2]=r[1]*r[6]*r[15]-r[1]*r[14]*r[7]-r[2]*r[5]*r[15]+r[2]*r[13]*r[7]+r[3]*r[5]*r[14]-r[3]*r[13]*r[6],n[3]=-r[1]*r[6]*r[11]+r[1]*r[10]*r[7]+r[2]*r[5]*r[11]-r[2]*r[9]*r[7]-r[3]*r[5]*r[10]+r[3]*r[9]*r[6],n[4]=-r[4]*r[10]*r[15]+r[4]*r[14]*r[11]+r[6]*r[8]*r[15]-r[6]*r[12]*r[11]-r[7]*r[8]*r[14]+r[7]*r[12]*r[10],n[5]=r[0]*r[10]*r[15]-r[0]*r[14]*r[11]-r[2]*r[8]*r[15]+r[2]*r[12]*r[11]+r[3]*r[8]*r[14]-r[3]*r[12]*r[10],n[6]=-r[0]*r[6]*r[15]+r[0]*r[14]*r[7]+r[2]*r[4]*r[15]-r[2]*r[12]*r[7]-r[3]*r[4]*r[14]+r[3]*r[12]*r[6],n[7]=r[0]*r[6]*r[11]-r[0]*r[10]*r[7]-r[2]*r[4]*r[11]+r[2]*r[8]*r[7]+r[3]*r[4]*r[10]-r[3]*r[8]*r[6],n[8]=r[4]*r[9]*r[15]-r[4]*r[13]*r[11]-r[5]*r[8]*r[15]+r[5]*r[12]*r[11]+r[7]*r[8]*r[13]-r[7]*r[12]*r[9],n[9]=-r[0]*r[9]*r[15]+r[0]*r[13]*r[11]+r[1]*r[8]*r[15]-r[1]*r[12]*r[11]-r[3]*r[8]*r[13]+r[3]*r[12]*r[9],n[10]=r[0]*r[5]*r[15]-r[0]*r[13]*r[7]-r[1]*r[4]*r[15]+r[1]*r[12]*r[7]+r[3]*r[4]*r[13]-r[3]*r[12]*r[5],n[11]=-r[0]*r[5]*r[11]+r[0]*r[9]*r[7]+r[1]*r[4]*r[11]-r[1]*r[8]*r[7]-r[3]*r[4]*r[9]+r[3]*r[8]*r[5],n[12]=-r[4]*r[9]*r[14]+r[4]*r[13]*r[10]+r[5]*r[8]*r[14]-r[5]*r[12]*r[10]-r[6]*r[8]*r[13]+r[6]*r[12]*r[9],n[13]=r[0]*r[9]*r[14]-r[0]*r[13]*r[10]-r[1]*r[8]*r[14]+r[1]*r[12]*r[10]+r[2]*r[8]*r[13]-r[2]*r[12]*r[9],n[14]=-r[0]*r[5]*r[14]+r[0]*r[13]*r[6]+r[1]*r[4]*r[14]-r[1]*r[12]*r[6]-r[2]*r[4]*r[13]+r[2]*r[12]*r[5],n[15]=r[0]*r[5]*r[10]-r[0]*r[9]*r[6]-r[1]*r[4]*r[10]+r[1]*r[8]*r[6]+r[2]*r[4]*r[9]-r[2]*r[8]*r[5];for(var i=r[0]*n[0]+r[1]*n[4]+r[2]*n[8]+r[3]*n[12],o=0;o<16;o++)n[o]/=i;return t},Matrix.transpose=function(e,t){t=t||new Matrix;var r=e.m,n=t.m;return n[0]=r[0],n[1]=r[4],n[2]=r[8],n[3]=r[12],n[4]=r[1],n[5]=r[5],n[6]=r[9],n[7]=r[13],n[8]=r[2],n[9]=r[6],n[10]=r[10],n[11]=r[14],n[12]=r[3],n[13]=r[7],n[14]=r[11],n[15]=r[15],t},Matrix.multiply=function(e,t,r){r=r||new Matrix;var n=e.m,i=t.m,o=r.m;return o[0]=n[0]*i[0]+n[1]*i[4]+n[2]*i[8]+n[3]*i[12],o[1]=n[0]*i[1]+n[1]*i[5]+n[2]*i[9]+n[3]*i[13],o[2]=n[0]*i[2]+n[1]*i[6]+n[2]*i[10]+n[3]*i[14],o[3]=n[0]*i[3]+n[1]*i[7]+n[2]*i[11]+n[3]*i[15],o[4]=n[4]*i[0]+n[5]*i[4]+n[6]*i[8]+n[7]*i[12],o[5]=n[4]*i[1]+n[5]*i[5]+n[6]*i[9]+n[7]*i[13],o[6]=n[4]*i[2]+n[5]*i[6]+n[6]*i[10]+n[7]*i[14],o[7]=n[4]*i[3]+n[5]*i[7]+n[6]*i[11]+n[7]*i[15],o[8]=n[8]*i[0]+n[9]*i[4]+n[10]*i[8]+n[11]*i[12],o[9]=n[8]*i[1]+n[9]*i[5]+n[10]*i[9]+n[11]*i[13],o[10]=n[8]*i[2]+n[9]*i[6]+n[10]*i[10]+n[11]*i[14],o[11]=n[8]*i[3]+n[9]*i[7]+n[10]*i[11]+n[11]*i[15],o[12]=n[12]*i[0]+n[13]*i[4]+n[14]*i[8]+n[15]*i[12],o[13]=n[12]*i[1]+n[13]*i[5]+n[14]*i[9]+n[15]*i[13],o[14]=n[12]*i[2]+n[13]*i[6]+n[14]*i[10]+n[15]*i[14],o[15]=n[12]*i[3]+n[13]*i[7]+n[14]*i[11]+n[15]*i[15],r},Matrix.identity=function(e){e=e||new Matrix;var t=e.m;return t[0]=t[5]=t[10]=t[15]=1,t[1]=t[2]=t[3]=t[4]=t[6]=t[7]=t[8]=t[9]=t[11]=t[12]=t[13]=t[14]=0,e},Matrix.perspective=function(e,t,r,n,i){var o=Math.tan(e*Math.PI/360)*r,a=o*t;return Matrix.frustum(-a,a,-o,o,r,n,i)},Matrix.frustum=function(e,t,r,n,i,o,a){a=a||new Matrix;var s=a.m;return s[0]=2*i/(t-e),s[1]=0,s[2]=(t+e)/(t-e),s[3]=0,s[4]=0,s[5]=2*i/(n-r),s[6]=(n+r)/(n-r),s[7]=0,s[8]=0,s[9]=0,s[10]=-(o+i)/(o-i),s[11]=-2*o*i/(o-i),s[12]=0,s[13]=0,s[14]=-1,s[15]=0,a},Matrix.ortho=function(e,t,r,n,i,o,a){a=a||new Matrix;var s=a.m;return s[0]=2/(t-e),s[1]=0,s[2]=0,s[3]=-(t+e)/(t-e),s[4]=0,s[5]=2/(n-r),s[6]=0,s[7]=-(n+r)/(n-r),s[8]=0,s[9]=0,s[10]=-2/(o-i),s[11]=-(o+i)/(o-i),s[12]=0,s[13]=0,s[14]=0,s[15]=1,a},Matrix.scale=function(e,t,r,n){n=n||new Matrix;var i=n.m;return i[0]=e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=t,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=r,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,n},Matrix.translate=function(e,t,r,n){n=n||new Matrix;var i=n.m;return i[0]=1,i[1]=0,i[2]=0,i[3]=e,i[4]=0,i[5]=1,i[6]=0,i[7]=t,i[8]=0,i[9]=0,i[10]=1,i[11]=r,i[12]=0,i[13]=0,i[14]=0,i[15]=1,n},Matrix.rotate=function(e,t,r,n,i,o,a,s){if(!e||!t&&!r&&!n)return Matrix.identity(s);s=s||new Matrix;var l=s.m,u=Math.sqrt(t*t+r*r+n*n);t/=u,r/=u,n/=u;var g=Math.cos(e),c=Math.sin(e),S=1-g;return l[0]=t*t*S+g,l[1]=t*r*S-n*c,l[2]=t*n*S+r*c,l[3]=i-l[0]*i-l[1]*o-l[2]*a,l[4]=r*t*S+n*c,l[5]=r*r*S+g,l[6]=r*n*S-t*c,l[7]=o-l[4]*i-l[5]*o-l[6]*a,l[8]=n*t*S-r*c,l[9]=n*r*S+t*c,l[10]=n*n*S+g,l[11]=a-l[8]*i-l[9]*o-l[10]*a,l[12]=0,l[13]=0,l[14]=0,l[15]=1,s},Matrix.lookAt=function(e,t,r,n,i,o,a,s,l,u){u=u||new Matrix;var g=u.m,c=new Vector(e,t,r),S=new Vector(n,i,o),d=new Vector(a,s,l),f=c.subtract(S).unit(),E=d.cross(f).unit(),p=f.cross(E).unit();return g[0]=E.x,g[1]=E.y,g[2]=E.z,g[3]=-E.dot(c),g[4]=p.x,g[5]=p.y,g[6]=p.z,g[7]=-p.dot(c),g[8]=f.x,g[9]=f.y,g[10]=f.z,g[11]=-f.dot(c),g[12]=0,g[13]=0,g[14]=0,g[15]=1,u};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.mesh=function(e,t,r){},EJSS_WEBGLGRAPHICS.indexer=function(){var e={},t=[],r={};return e.getUnique=function(){return t},e.add=function(e){var n=JSON.stringify(e);return n in r||(r[n]=t.length,t.push(e)),r[n]},e},EJSS_WEBGLGRAPHICS.buffer=function(e,t,r){var n={},i=null,t=t,r=r,o="",a=[];return n.setData=function(e){a=e},n._0=function(e){o=e},n.getBuffer=function(){return i},n.getName=function(){return o},n.compile=function(n){for(var o=[],s=0,l=1e4;s<a.length;s+=l)o=Array.prototype.concat.apply(o,a.slice(s,s+l));var u=a.length?o.length/a.length:0;if(u!=Math.round(u))throw"buffer elements not of consistent size, average size is "+u;i=i||e.createBuffer(),i.length=o.length,i.spacing=u,e.bindBuffer(t,i),e.bufferData(t,new r(o),n||e.STATIC_DRAW)},n};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.plane=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.segment=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.Shader={},EJSS_WEBGLGRAPHICS.shader=function(e,t,r,n){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.spring=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.surface=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.text=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.Texture={},EJSS_WEBGLGRAPHICS.texture=function(e,t,r,n){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.trail=function(e,t){};var EJSS_WEBGLGRAPHICS=EJSS_WEBGLGRAPHICS||{};EJSS_WEBGLGRAPHICS.Utils={},EJSS_WEBGLGRAPHICS.Utils.regexMap=function(e,t,r){for(;null!=(result=e.exec(t));)r(result)},EJSS_WEBGLGRAPHICS.Utils.isArray=function(e){var t=Object.prototype.toString.call(e);return"[object Array]"==t||"[object Float32Array]"==t},EJSS_WEBGLGRAPHICS.Utils.isNumber=function(e){var t=Object.prototype.toString.call(e);return"[object Number]"==t||"[object Boolean]"==t},Vector.prototype={setx:function(e){this.x=e},sety:function(e){this.y=e},setz:function(e){this.z=e},getx:function(){return this.x},gety:function(){return this.y},getz:function(){return this.z},negative:function(){return new Vector((-this.x),(-this.y),(-this.z))},add:function(e){return e instanceof Vector?new Vector(this.x+e.x,this.y+e.y,this.z+e.z):new Vector(this.x+e,this.y+e,this.z+e)},subtract:function(e){return e instanceof Vector?new Vector(this.x-e.x,this.y-e.y,this.z-e.z):new Vector(this.x-e,this.y-e,this.z-e)},multiply:function(e){return e instanceof Vector?new Vector(this.x*e.x,this.y*e.y,this.z*e.z):new Vector(this.x*e,this.y*e,this.z*e)},divide:function(e){return e instanceof Vector?new Vector(this.x/e.x,this.y/e.y,this.z/e.z):new Vector(this.x/e,this.y/e,this.z/e)},equals:function(e){return this.x==e.x&&this.y==e.y&&this.z==e.z},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},cross:function(e){return new Vector(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},length:function(){return Math.sqrt(this.dot(this))},unit:function(){return this.divide(this.length())},min:function(){return Math.min(Math.min(this.x,this.y),this.z)},max:function(){return Math.max(Math.max(this.x,this.y),this.z)},angle:function(e){return Math.acos(this.dot(e)/(this.length()*e.length()))},toAngles:function(){return{theta:Math.atan2(this.z,this.x),phi:Math.asin(this.y/this.length())}},toArray:function(e){return[this.x,this.y,this.z].slice(0,e||3)},clone:function(){return new Vector(this.x,this.y,this.z)},init:function(e,t,r){return this.x=e,this.y=t,this.z=r,this}},Vector.negative=function(e,t){return t.x=-e.x,t.y=-e.y,t.z=-e.z,t},Vector.add=function(e,t,r){return t instanceof Vector?(r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z):(r.x=e.x+t,r.y=e.y+t,r.z=e.z+t),r},Vector.subtract=function(e,t,r){return t instanceof Vector?(r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z):(r.x=e.x-t,r.y=e.y-t,r.z=e.z-t),r},Vector.multiply=function(e,t,r){return t instanceof Vector?(r.x=e.x*t.x,r.y=e.y*t.y,r.z=e.z*t.z):(r.x=e.x*t,r.y=e.y*t,r.z=e.z*t),r},Vector.divide=function(e,t,r){return t instanceof Vector?(r.x=e.x/t.x,r.y=e.y/t.y,r.z=e.z/t.z):(r.x=e.x/t,r.y=e.y/t,r.z=e.z/t),r},Vector.cross=function(e,t,r){return r.x=e.y*t.z-e.z*t.y,r.y=e.z*t.x-e.x*t.z,r.z=e.x*t.y-e.y*t.x,r},Vector.unit=function(e,t){var r=e.length();return t.x=e.x/r,t.y=e.y/r,t.z=e.z/r,t},Vector.fromAngles=function(e,t){return new Vector(Math.cos(e)*Math.cos(t),Math.sin(t),Math.sin(e)*Math.cos(t))},Vector.randomDirection=function(){return Vector.fromAngles(Math.random()*Math.PI*2,Math.asin(2*Math.random()-1))},Vector.min=function(e,t){return new Vector(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.min(e.z,t.z))},Vector.max=function(e,t){return new Vector(Math.max(e.x,t.x),Math.max(e.y,t.y),Math.max(e.z,t.z))},Vector.lerp=function(e,t,r){return t.subtract(e).multiply(r).add(e)},Vector.fromArray=function(e){return new Vector(e[0],e[1],e[2])};var EJSS_GRAPHICS=EJSS_GRAPHICS||{};EJSS_GRAPHICS.WebGLGraphics={},EJSS_GRAPHICS.webGLGraphics=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Plane={},EJSS_DRAWING3D.plane=function(e){},EJSS_DRAWING3D.PlaneSet={},EJSS_DRAWING3D.planeSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Segment={},EJSS_DRAWING3D.segment=function(e){},EJSS_DRAWING3D.SegmentSet={},EJSS_DRAWING3D.segmentSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Sphere={},EJSS_DRAWING3D.sphere=function(e){},EJSS_DRAWING3D.SphereSet={},EJSS_DRAWING3D.sphereSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Spring={},EJSS_DRAWING3D.spring=function(e){},EJSS_DRAWING3D.SpringSet={},EJSS_DRAWING3D.springSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Surface={},EJSS_DRAWING3D.surface=function(e){},EJSS_DRAWING3D.SurfaceSet={},EJSS_DRAWING3D.surfaceSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Tetrahedron={},EJSS_DRAWING3D.tetrahedron=function(e){},EJSS_DRAWING3D.TetrahedronSet={},EJSS_DRAWING3D.tetrahedronSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Text={},EJSS_DRAWING3D.text=function(e){},EJSS_DRAWING3D.TextSet={},EJSS_DRAWING3D.textSet=function(e){};var EJSS_DRAWING3D=EJSS_DRAWING3D||{};EJSS_DRAWING3D.Trail={},EJSS_DRAWING3D.trail=function(e){},EJSS_DRAWING3D.TrailSet={},EJSS_DRAWING3D.trailSet=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.ArrayPanel={},EJSS_INTERFACE.arrayPanel=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Audio={},EJSS_INTERFACE.audio=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.BoxPanel={registerProperties:function(e,t){EJSS_INTERFACE.Panel.registerProperties(e,t)},showOkDialog:function(e,t,r){var n=document.getElementById(".myBoxPanelOk")||EJSS_INTERFACE.boxPanel(".myBoxPanelOk").getDOMElement(),i=document.getElementById(".myBoxPanelOk.back"),o=document.getElementById(".myBoxPanelOk.msg");o.style.visibility="visible",o.innerHTML=e+"<br/>";var a=document.getElementById(".myBoxPanelOk.okbt");a.onclick=t,a.style.display="inline",n.style.width=r||"200px",n.style.marginLeft=parseFloat(n.style.width)/-2+"px",n.style.visibility="visible",i.style.visibility="visible"},showOkCancelDialog:function(e,t,r,n){var i=document.getElementById(".myBoxPanelCancelOk")||EJSS_INTERFACE.boxPanel(".myBoxPanelCancelOk").getDOMElement(),o=document.getElementById(".myBoxPanelCancelOk.back"),a=document.getElementById(".myBoxPanelCancelOk.msg");a.style.visibility="visible",a.innerHTML=e+"<br/>";var s=document.getElementById(".myBoxPanelCancelOk.okbt");s.onclick=t,s.style.display="inline";var l=document.getElementById(".myBoxPanelCancelOk.cancelbt");l.onclick=r,l.style.display="inline",i.style.width=n||"200px",i.style.marginLeft=parseFloat(i.style.width)/-2+"px",i.style.visibility="visible",o.style.visibility="visible"},showInputDialog:function(e,t,r,n){var i=document.getElementById(".BoxPanelInput")||EJSS_INTERFACE.boxPanel(".BoxPanelInput").getDOMElement(),o=document.getElementById(".BoxPanelInput.back"),a=document.getElementById(".BoxPanelInput.msg");a.style.visibility="visible",a.innerHTML=e;var s=document.getElementById(".BoxPanelInput.input");s.style.display="inline";var l=document.getElementById(".BoxPanelInput.okbt");l.onclick=function(){t(s.value)},l.style.display="inline";var u=document.getElementById(".BoxPanelInput.cancelbt");u.onclick=r,u.style.display="inline",i.style.width=n||"200px",i.style.marginLeft=parseFloat(i.style.width)/-2+"px",i.style.visibility="visible",o.style.visibility="visible"},showSelectDialog:function(e,t,r,n,i,o){var a=document.getElementById(".BoxPanelSelect")||EJSS_INTERFACE.boxPanel(".BoxPanelSelect").getDOMElement(),s=document.getElementById(".BoxPanelSelect.back"),l=document.getElementById(".BoxPanelSelect.msg");l.style.visibility="visible",l.innerHTML=e;var u=document.getElementById(".BoxPanelSelect.select");u.innerHTML="";for(var g=0;g<t.text.length;g++){var c=document.createElement("option");c.value&&c.value[g]&&c.setAttribute("value",t.value[g]),c.innerHTML=t.text[g],u.appendChild(c)}i&&(u.size=i),u.style.display="block",u.style.margin="0 auto";var S=document.getElementById(".BoxPanelSelect.okbt");S.onclick=function(){r(t.value[u.selectedIndex])},S.style.display="inline";var d=document.getElementById(".BoxPanelSelect.cancelbt");d.onclick=n,d.style.display="inline",a.style.width=o||"200px",a.style.marginLeft=parseFloat(a.style.width)/-2+"px",a.style.visibility="visible",s.style.visibility="visible"}},EJSS_INTERFACE.boxPanel=function(e){var t=EJSS_INTERFACE.panel(e);t.setVisibility=function(e){mElement.style.visibility=e,t.getStyle().setVisibility(e)},t.registerProperties=function(e){EJSS_INTERFACE.BoxPanel.registerProperties(t,e)};var r=document.createElement("div");document.body.appendChild(r),r.className="myBoxPanelBackground",r.id=e+".back",r.style.backgroundColor="rgba(255, 255, 255, 0.3)",r.style.position="fixed",r.style.top="1%",r.style.left="1%",r.style.width="98%",r.style.height="98%",r.style.zIndex="99998",r.style.visibility="hidden";var n=document.createElement("span");n.id=e+".msg",n.style.visibility="hidden",t.getDOMElement().appendChild(n);var i=document.createElement("input");i.id=e+".input",i.type="text",i.style.display="none",i.size="20",t.getDOMElement().appendChild(i);var o=document.createElement("select");o.id=e+".select",o.style.display="none",o.size="4",t.getDOMElement().appendChild(o);var a=document.createElement("button");a.id=e+".okbt",a.innerHTML="Ok",a.style.verticalAlign="middle",a.style.display="none",a.addEventListener("click",function(){document.getElementById(e).style.visibility="hidden",document.getElementById(e+".back").style.visibility="hidden",document.getElementById(e+".msg").style.visibility="hidden",document.getElementById(e+".input").style.display="none",document.getElementById(e+".okbt").style.display="none",document.getElementById(e+".cancelbt").style.display="none"}),t.getDOMElement().appendChild(a);var s=document.createElement("button");return s.id=e+".cancelbt",s.innerHTML="Cancel",s.style.verticalAlign="middle",s.style.display="none",s.addEventListener("click",function(){document.getElementById(e).style.visibility="hidden",document.getElementById(e+".back").style.visibility="hidden",document.getElementById(e+".msg").style.visibility="hidden",document.getElementById(e+".input").style.display="none",document.getElementById(e+".okbt").style.display="none",document.getElementById(e+".cancelbt").style.display="none"}),t.getDOMElement().appendChild(s),t.getDOMElement().className="BoxPanel",t.getStyle().setCSS({position:"fixed",top:"25%",left:"50%"}),t.getStyle().setCSS({zIndex:"99999",visibility:"hidden"}),t.getStyle().setCSS({marginLeft:"-250px",width:"500px"}),t.getStyle().setCSS({background:"lightgray"}),t.getStyle().setCSS({borderWidth:"1px"}),t.getStyle().setCSS({borderStyle:"solid"}),t.getStyle().setCSS({borderColor:"red"}),t.getStyle().setCSS({overflow:"hidden",wordWrap:"break-word"}),t};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Button={},EJSS_INTERFACE.button=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Canvas={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Height",e.setHeight),t.registerProperty("Width",e.setWidth),t.registerProperty("ImageData",e.setImageData),t.registerProperty("Enabled",e.setEnabled,e.isEnabled),t.registerAction("OnPress",e.getInteractionPoint),t.registerAction("OnDrag",e.getInteractionPoint),t.registerAction("OnRelease",e.getInteractionPoint),t.registerAction("OnEnter",e.getInteractionPoint),t.registerAction("OnExit",e.getInteractionPoint),t.registerAction("OnMove",e.getInteractionPoint)}},EJSS_INTERFACE.canvas=function(e){function t(e){var t=EJSS_GRAPHICS.CanvasGraphics.getOffsetRect(u),r=[];if("undefined"!=typeof e.changedTouches)for(var n=0;n<e.changedTouches.length;n++)r[n]=[],r[n][0]=e.changedTouches[n].pageX-window.pageXOffset-t.left,r[n][1]=e.changedTouches[n].pageY-window.pageYOffset-t.top;else r[0]=[],r[0][0]=(e.clientX||e.x)-t.left,r[0][1]=(e.clientY||e.y)-t.top;return r[0]}function r(e){e.preventDefault();var r=u.getController();return r&&(S=t(e),r.invokeAction("OnPress").reportInteractions()),d=!0,!1}function n(e){e.preventDefault();var r=u.getController();return d&&r&&(S=t(e),r.invokeAction("OnRelease").reportInteractions()),d=!1,!1}function i(e){e.preventDefault();var r=u.getController();return d=!1,r&&(S=t(e),r.invokeAction("OnEnter").reportInteractions()),!1}function o(e){e.preventDefault();var r=u.getController();return d=!1,r&&(S=t(e),r.invokeAction("OnExit").reportInteractions()),!1}function a(e){e.preventDefault();var r=u.getController();return r&&(S=t(e),d?r.invokeAction("OnDrag").reportInteractions():r.invokeAction("OnMove").reportInteractions()),!1}var s,l,u=EJSS_INTERFACE.element(e),g=0,c=0,S=[0,0],d=!1;u.render=function(){s&&E.putImageData(s,0,0)},u.setImageData=function(e){s||(s=E.createImageData(c,g)),e.data&&(e=e.data);for(var t=0;t<e.length;t++)s.data[t]=e[t]},u.clear=function(){E.clearRect(0,0,c,g)},u.setWidth=function(e){var t=u.getDOMElement();return c!=e&&(c=e,"string"==typeof e&&e.indexOf("%")!=-1&&t.parentNode&&t.parentNode.offsetWidth?e=t.parentNode.offsetWidth*parseFloat(e)/100:"string"==typeof e&&(e=parseFloat(e)),"number"==typeof e&&t.setAttribute("width",e),!0)},u.getWidth=function(){var e=u.getDOMElement();if("string"==typeof c&&c.indexOf("%")!=-1&&e.parentNode&&e.parentNode.offsetWidth){var t=e.parentNode.offsetWidth*parseFloat(c)/100;if("number"==typeof t){var r=e.getAttribute("width");t!=r&&e.setAttribute("width",t)}}return c},u.setHeight=function(e){var t=u.getDOMElement();return g!=e&&(g=e,"string"==typeof e&&e.indexOf("%")!=-1&&t.parentNode&&t.parentNode.offsetHeight?e=t.parentNode.offsetHeight*parseFloat(e)/100:"string"==typeof e&&(e=parseFloat(e)),"number"==typeof e&&t.setAttribute("height",e),!0)},u.getHeight=function(){var e=u.getDOMElement();if("string"==typeof g&&g.indexOf("%")!=-1&&e.parentNode&&e.parentNode.offsetHeight&&(value=e.parentNode.offsetHeight*parseFloat(g)/100,"number"==typeof value)){var t=e.getAttribute("height");value!=t&&e.setAttribute("height",value)}return g},u.getContext=function(){return E},u.registerProperties=function(e){EJSS_INTERFACE.Canvas.registerProperties(u,e)},u.setEnabled=function(e){l=e;var t=u.getDOMElement();l?(t.onmousedown=r,t.onmouseup=n,t.onmouseover=i,t.onmouseout=o,t.onmousemove=a,t.addEventListener("touchstart",r,!1),t.addEventListener("touchend",n,!1),t.addEventListener("touchmove",a,!1)):(t.onmousedown=void 0,t.onmouseup=void 0,t.onmouseover=void 0,t.onmouseout=void 0,t.onmousemove=void 0,t.removeEventListener("touchstart",r),t.removeEventListener("touchend",n),t.removeEventListener("touchmove",a))},u.isEnabled=function(){return l},u.getInteractionPoint=u.getMousePosition=function(){return S};var f=document.createElement("canvas");f.setAttribute("id",e),f.style.overflow="hidden";var E=f.getContext("2d");return document.body.appendChild(f),u.setDOMElement(f),u.setEnabled(!0),u.setWidth(500),u.setHeight(500),u};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.CheckBox={},EJSS_INTERFACE.checkBox=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.ComboBox={},EJSS_INTERFACE.comboBox=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.DataTable={},EJSS_INTERFACE.dataTable=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Element={registerProperties:function(e,t){e.setController(t),t.registerProperty("Tooltip",e.setTitle),t.registerProperty("Foreground",e.getStyle().setColor),t.registerProperty("Background",e.getStyle().setBackgroundColor),t.registerProperty("BackgroundImage",e.getStyle().setBackgroundImage),t.registerProperty("BorderWidth",e.getStyle().setBorderWidth),t.registerProperty("BorderColor",e.getStyle().setBorderColor),t.registerProperty("BorderStyle",e.getStyle().setBorderStyle),t.registerProperty("Padding",e.getStyle().setPadding),t.registerProperty("Width",e.getStyle().setWidth,e.getStyle().getWidth),t.registerProperty("Height",e.getStyle().setHeight,e.getStyle().getHeight),t.registerProperty("LineHeight",e.getStyle().setLineHeight,e.getStyle().getLineHeight),t.registerProperty("TextAlign",e.getStyle().setTextAlign),t.registerProperty("VerticalAlign",e.getStyle().setVerticalAlign),t.registerProperty("Visibility",e.getStyle().setVisibility),t.registerProperty("Display",e.getStyle().setDisplay),t.registerProperty("Disabled",e.setDisabled),t.registerProperty("Float",e.getStyle().setFloat),t.registerProperty("Position",e.getStyle().setPosition),t.registerProperty("Left",e.getStyle().setLeft),t.registerProperty("Top",e.getStyle().setTop),t.registerProperty("Bottom",e.getStyle().setBottom),t.registerProperty("Overflow",e.getStyle().setOverflow),t.registerProperty("BoxShadow",e.getStyle().setShadow),t.registerProperty("Margin",e.getStyle().setMargin),t.registerProperty("Parent",e.setParent),t.registerProperty("ClassName",e.setClassName),t.registerProperty("CSS",e.getStyle().setCSS),t.registerProperty("Font",e.getStyle().setFont),t.registerProperty("FontFamily",e.getStyle().setFontFamily),t.registerProperty("FontSize",e.getStyle().setFontSize),t.registerProperty("LetterSpacing",e.getStyle().setLetterSpacing),t.registerProperty("OutlineColor",e.getStyle().setOutlineColor),t.registerProperty("FontWeight",e.getStyle().setFontWeight),t.registerProperty("FillColor",e.getStyle().setFillColor),t.registerProperty("FontStyle",e.getStyle().setFontStyle),t.registerProperty("Transform",e.getStyle().setTransform),t.registerProperty("WhiteSpace",e.getStyle().setWhiteSpace)}},EJSS_INTERFACE.element=function(e){var t,r,n={},i=EJSS_INTERFACE.style(e),o=null;return n.getDOMElement=function(){return t},n.setDOMElement=function(e){t=e},n.setParent=function(e){if(r=e,"string"==typeof e){var t=document.getElementById(e);t.appendChild(n.getDOMElement())}else e.getDOMElement?e.appendChild(n):e.appendChild(n.getDOMElement())},n.getParent=function(){return r},n.getName=function(){return e},n.getResourcePath=function(e){return e},n.setClassName=function(e){n.getDOMElement().className=e},n._23Name=function(){return n.getDOMElement().className},n.setDisabled=function(e){n.getDOMElement().disabled=e},n.getDisabled=function(){return n.getDOMElement().disabled},n.setTitle=function(e){n.getDOMElement().title=e},n.getTitle=function(){return n.getDOMElement().title},n.getStyle=function(){return i},n.getController=function(){return o},n.setController=function(e){o=e},n.registerProperties=function(e){EJSS_INTERFACE.Element.registerProperties(n,e)},n};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.FunctionField={},EJSS_INTERFACE.functionField=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Html={},EJSS_INTERFACE.html=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Image={},EJSS_INTERFACE.image=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.ImageAndTextButton={},EJSS_INTERFACE.imageAndTextButton=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Label={},EJSS_INTERFACE.label=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.MathML={},EJSS_INTERFACE.mathML=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Media={},EJSS_INTERFACE.media=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.MotionJPEG={},EJSS_INTERFACE.motionJPEG=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.NumberField={},EJSS_INTERFACE.numberField=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Panel={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Html",e.setHtml,e.getHtml)}},EJSS_INTERFACE.panel=function(e){var t=EJSS_INTERFACE.element(e);t.appendChild=function(e){var r=e.getDOMElement();t.getDOMElement().appendChild(r)},t.removeChild=function(e){var r=e.getDOMElement();t.getDOMElement().removeChild(r)},t.insertBefore=function(e,r){var n=e.getDOMElement(),i=r.getDOMElement();t.getDOMElement().insertBefore(n,i)},t.setHtml=function(e){t.getDOMElement().innerHTML=e},t.getHtml=function(){return t.getDOMElement().innerHTML},t.registerProperties=function(e){EJSS_INTERFACE.Panel.registerProperties(t,e)};var r=document.createElement("div");return r.id=e,r.contenteditable=!0,document.body.appendChild(r),t.setDOMElement(r),t.getStyle().setPadding("0px"),t.getStyle().setMargin("0px"),t.getStyle().setTextAlign("TEXTA_CENTER"),t.getStyle().setCSS({display:"block","margin-left":"auto","margin-right":"auto"}),t.getDOMElement().ontouchstart=function(e){for(var t=document.getElementsByTagName("input"),r=0;t.length>r;r++)t[r].disabled=!1},t};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.PasswordField={},EJSS_INTERFACE.passwordField=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.RadioButton={},EJSS_INTERFACE.radioButton=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Separator={},EJSS_INTERFACE.separator=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Slider={},EJSS_INTERFACE.slider=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Style={BORDER_SOLID:"solid",BORDER_DOTTED:"dotted",BORDER_DASHED:"dashed",TEXTA_LEFT:"left",TEXTA_RIGHT:"right",TEXTA_CENTER:"center",TEXTA_JUSTIFY:"justify",VISIB_VISIBLE:"visible",VISIB_HIDDEN:"hidden",FLOAT_LEFT:"left",FLOAT_RIGHT:"right",FLOAT_NONE:"none",FLOAT_CENTER:"none",POSITION_STATIC:"static",POSITION_ABSOLUTE:"absolute",POSITION_FIXED:"fixed",POSITION_RELATIVE:"relative",POSITION_INHERIT:"inherit",OVERFLOW_VISIBLE:"visible",OVERFLOW_HIDDEN:"hidden",OVERFLOW_SCROLL:"scroll",OVERFLOW_AUTO:"auto",setCSS:function(e,t){var r=/-([\da-z])/gi,n=function(e,t){return(t+"").toUpperCase()},i=e.style;if("object"!=typeof t){var o=t.trim().split("{");if(o[0]&&o[0].length>0){var a,s=o[0].trim(),l=document.styleSheets[0].rules||document.styleSheets[0].cssRules;for(a=0;a<l.length&&l[a].selectorText!=s;a++);var u=l[a].cssText?l[a].cssText:l[a].style.cssText;u=u.match(/{.*}/g)[0];var g=u.slice(1,u.length-2).split(";");for(elem in g){var c=g[elem].split(":");if(2==c.length){var S=c[0].trim(),d=c[1].trim(),f=S.replace(r,n);i[f]=d}}}if(o[1]){var E=o[1].trim(),g=E.slice(0,E.length-2).split(";");for(elem in g){var c=g[elem].split(":");if(2==c.length){var S=c[0].trim(),d=c[1].trim(),f=S.replace(r,n);i[f]=d}}}}else for(var p in t){var f=p.replace(r,n);i[f]=t[p]}}},EJSS_INTERFACE.style=function(e){var t=EJSS_INTERFACE.Style,r={},n="white",i=0,o=t.BORDER_SOLID;return r.setCSS=function(r){t.setCSS(document.getElementById(e),r)},r.setVisibility=function(t){document.getElementById(e).style.visibility=t?"visible":"hidden"},r.getVisibility=function(){return"visible"==document.getElementById(e).style.visibility},r.setVerticalAlign=function(t){document.getElementById(e).style.verticalAlign=t},r.getVerticalAlign=function(){return document.getElementById(e).style.verticalAlign},r.setTextAlign=function(r){"TEXTA_"==r.substring(0,6)&&(r=t[r.toUpperCase()]),document.getElementById(e).style.textAlign=r},r.getTextAlign=function(){return document.getElementById(e).style.textAlign},r.setLineHeight=function(t){"string"!=typeof t&&(t+="px"),document.getElementById(e).style.lineHeight=t},r.getLineHeight=function(){return document.getElementById(e).style.lineHeight},r.setHeight=function(t){"string"!=typeof t&&(t+="px"),document.getElementById(e).style.height=t},r.getHeight=function(){return document.getElementById(e).style.height},r.setWidth=function(t){"string"!=typeof t&&(t+="px"),document.getElementById(e).style.width=t},r.getWidth=function(){return document.getElementById(e).style.width},r.setOverflow=function(r){"OVERFL"==r.substring(0,6)&&(r=t[r.toUpperCase()]),document.getElementById(e).style.overflow=r},r.getOverflow=function(){return document.getElementById(e).style.overflow},r.setPosition=function(r){"POSITI"==r.substring(0,6)&&(r=t[r.toUpperCase()]),document.getElementById(e).style.position=r},r.getPosition=function(){return document.getElementById(e).style.position},r.setFloat=function(r){"FLOAT_"==r.substring(0,6)&&(r=t[r.toUpperCase()]),document.getElementById(e).style.float=r},r.getFloat=function(){return document.getElementById(e).style.float},r.setDisplay=function(t){document.getElementById(e).style.display=t},r.getDisplay=function(){return document.getElementById(e).style.display},r.setTop=function(t){document.getElementById(e).style.top=t},r.getTop=function(){return document.getElementById(e).style.top},r.setBottom=function(t){document.getElementById(e).style.bottom=t},r.getBottom=function(){return document.getElementById(e).style.bottom},r.setLeft=function(t){document.getElementById(e).style.left=t},r.getLeft=function(){return document.getElementById(e).style.left},r.setBorderStyle=function(r){"BORDER"==r.substring(0,6)&&(r=t[r.toUpperCase()]),o=r,document.getElementById(e).style.border=i+"px "+o+" "+n},r.getBorderStyle=function(){return o},r.setBorderWidth=function(t){i=t,document.getElementById(e).style.border=i+"px "+o+" "+n},r.getBorderWidth=function(){return i},r.setBorderColor=function(t){"string"!=typeof t&&(t=EJSS_TOOLS.DisplayColors.getLineColor(t)),n=t,document.getElementById(e).style.border=i+"px "+o+" "+n},r.getBorderColor=function(){return n},r.setPadding=function(t){document.getElementById(e).style.padding=t},r.getPadding=function(){return document.getElementById(e).style.padding},r.setShadow=function(t){t?document.getElementById(e).style.boxShadow=t:document.getElementById(e).style.boxShadow=""},r.getShadow=function(){return""!=document.getElementById(e).style.boxShadow},r.setMargin=function(t){document.getElementById(e).style.margin=t},r.getMargin=function(){return document.getElementById(e).style.margin},r.setBackgroundImage=function(t){document.getElementById(e).style.backgroundImage="url("+t+")",document.getElementById(e).style.backgroundSize="100% 100%"},r.getBackgroundImage=function(){return document.getElementById(e).style.backgroundImage},r.setBackgroundColor=function(t){"string"!=typeof t&&(t=EJSS_TOOLS.DisplayColors.getLineColor(t)),document.getElementById(e).style.backgroundColor=t},r.getBackgroundColor=function(){return document.getElementById(e).style.backgroundColor},r.setColor=function(t){"string"!=typeof t&&(t=EJSS_TOOLS.DisplayColors.getLineColor(t)),document.getElementById(e).style.color=t},r.getColor=function(){return document.getElementById(e).style.color},r.getFont=function(){return document.getElementById(e).style.font},r.setFont=function(t){var r=document.getElementById(e).style,n=t.split(" ");r.fontStyle=n[0],r.fontWeight=n[1];var i=n[2].split("/");r.fontSize=i[0],i[1]&&(r.lineHeight=i[1]),n[3]&&(r.fontFamily=t.substring(t.indexOf(n[3])))},r.setFontStyle=function(t){document.getElementById(e).style.fontStyle=t},r.getFontStyle=function(){return document.getElementById(e).style.fontStyle},r.setFontFamily=function(t){document.getElementById(e).style.fontFamily=t},r.getFontFamily=function(){return document.getElementById(e).style.fontFamily},r.setFontSize=function(t){document.getElementById(e).style.fontSize=t},r.getFontSize=function(){return document.getElementById(e).style.fontSize},r.setLetterSpacing=function(t){document.getElementById(e).style.letterSpacing=t},r.getLetterSpacing=function(){return document.getElementById(e).style.letterSpacing},r.setOutlineColor=function(t){document.getElementById(e).style.stroke=t},r.getOutlineColor=function(){return document.getElementById(e).style.stroke},r.setFontWeight=function(t){document.getElementById(e).style.fontWeight=t},r.getFontWeight=function(){return document.getElementById(e).style.fontWeight},r.setFillColor=function(t){document.getElementById(e).style.fill=t},r.getFillColor=function(){return document.getElementById(e).style.fill},r.setTransform=function(t){document.getElementById(e).style.transform=t,document.getElementById(e).style["-ms-transform"]=t,document.getElementById(e).style["-webkit-transform"]=t},r.getTransform=function(){return document.getElementById(e).style.transform},r.setWhiteSpace=function(t){document.getElementById(e).style.whiteSpace=t},r.getWhiteSpace=function(){return document.getElementById(e).style.whiteSpace},r};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.SvgGraphics={registerProperties:function(e,t){EJSS_INTERFACE.Element.registerProperties(e,t),t.registerProperty("Height",e.setHeight),t.registerProperty("Width",e.setWidth)}},EJSS_INTERFACE.svgGraphics=function(e){var t=EJSS_INTERFACE.element(e),r=0,n=0;t.setWidth=function(e){if(n!=e){n=e;var r="string"==typeof n&&n.indexOf("%")!=-1?n:parseFloat(n);return t.getDOMElement().setAttribute("width",r),!0}return!1},t.getWidth=function(){return n},t.setHeight=function(e){if(r!=e){r=e;var n="string"==typeof r&&r.indexOf("%")!=-1?r:parseFloat(r);return t.getDOMElement().setAttribute("height",n),!0}return!1},t.getHeight=function(){return r},t.registerProperties=function(e){EJSS_INTERFACE.SvgGraphics.registerProperties(t,e)};var i=document.createElementNS("http://www.w3.org/2000/svg","svg");return i.setAttribute("id",e),i.style.overflow="hidden",i.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),document.body.appendChild(i),t.setDOMElement(i),t.setWidth(500),t.setHeight(500),t};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.TextArea={},EJSS_INTERFACE.textArea=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.TextField={},EJSS_INTERFACE.textField=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.TwoStateButton={},EJSS_INTERFACE.twoStateButton=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.Video={},EJSS_INTERFACE.video=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.WebGLCanvas={},EJSS_INTERFACE.webGLCanvas=function(e){};var EJSS_INTERFACE=EJSS_INTERFACE||{};EJSS_INTERFACE.WrappedPanel={},EJSS_INTERFACE.wrappedPanel=function(e){};var EJSS_CORE=EJSS_CORE||{};EJSS_CORE.Model={MODE_JAVA_STYLE:1,MODE_RESPECT_TIME:2,MODE_RESPECT_DELAY:3},EJSS_CORE.createAnimation=function(){function e(e){for(var t=0,r=e.length;t<r;t++)if(S=!1,e[t](),S)return}var t,r,n={},i=1,o="Choose a name for the file",a="Select a file to read",s=i,l=1,u=!1,g=!0,c=!1,S=!1,d=+new Date,f=!1,E=null,p=NaN,h=s,m=0,A=10,y=!0,v=!1,P=[],D=EJSS_CORE.Model.MODE_JAVA_STYLE;n.setView=function(e){E=e,E._12(function(){f||E._16(b,r,f)&&(n.automaticResetSolvers(),n.update())})},n.getView=function(){return E},n.serialize=function(){var e={};n._userSerialize&&(e=n._userSerialize());var t=E.serialize(),r={model:e,view:t};return JSON.stringify(r,function(e,t){return"number"==typeof t&&(isNaN(t)?t="__NaN":isFinite(t)||(t="__Infinity")),t})},n.unserialize=function(e){var t=JSON.parse(e,function(e,t){return"__NaN"==t?t=NaN:"__Infinity"==t&&(t=1/0),t});if(t.model){var r=t.model;n._userUnserialize&&n._userUnserialize(r)}if(t.view){var i=t.view;E.unserialize(i)}};var I,_,C,R,T;n.sendCallback=function(){},n.setStatusParams=function(e,t,r,i,o,a){I=e,_=t,C=r,R=i,T=o,a&&(n.sendCallback=a)},n.sendSnapshot=function(e,t,r,n){if(R){var i=t.split(".").pop();i==t.split(".")[0]&&(i="");var o=t.split(".")[0]+"_context_id_"+I+"_user_id_"+_+"_ejsapp_id_"+C+i;e.importGraphics(function(e){var t=new XMLHttpRequest,i="user_file="+o+"&file="+encodeURIComponent(e)+"&type=png";t.open("POST",R,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4==t.readyState&&200==t.status?r&&r():n&&n()},t.send(i)})}},n.sendState=function(e,t,r){if(R){var i=e.split(".").pop();i==e.split(".")[0]&&(i="");var o=e.split(".")[0]+"_context_id_"+I+"_user_id_"+_+"_ejsapp_id_"+C+i,a=n.serialize(),s=new XMLHttpRequest,l="user_file="+o+"&file="+encodeURIComponent(a)+"&type=json";s.open("POST",R,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){4==s.readyState&&200==s.status?t&&t():r&&r()},s.send(l)}},n.sendText=function(e,t,r,n,i){if(R){if(r)o="."+r;else{r="txt";var o="."+e.split(".").pop();o=="."+e.split(".")[0]&&(o="")}var a=e.split(".")[0]+"_context_id_"+I+"_user_id_"+_+"_ejsapp_id_"+C+o,s=new XMLHttpRequest,l="user_file="+a+"&file="+encodeURIComponent(t)+"&type="+r;s.open("POST",R,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){4==s.readyState&&200==s.status?n&&n():i&&i()},s.send(l)}},n.getState=function(e,t,r){var i=new XMLHttpRequest;i.open("GET",e,!0),i.setRequestHeader("Cache-Control","no-cache"),i.onreadystatechange=function(){4==i.readyState&&200==i.status?(n.unserialize(i.responseText),t&&t()):r&&r()},i.send()},n.getText=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.setRequestHeader("Cache-Control","no-cache"),n.onreadystatechange=function(){4==n.readyState&&200==n.status?t&&t(n.responseText):r&&r()},n.send()},n.getStateFiles=function(e,t,r){if(C){var n=new XMLHttpRequest,i=T+"?ejsapp_id="+C+"&type="+e;n.open("GET",i,!0),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){var e=n.responseText.split(";"),i={};i.name=[],i.url=[];for(var o=0;o+1<e.length;o++)i.name.push(e[o]),i.url.push(e[++o]);t&&t(i)}else r&&r()},n.send()}},n.saveText=function(e,t,r){if(!r){var r=t;t=null}I?EJSS_INTERFACE.BoxPanel.showInputDialog(o,function(e){n.sendText(e,r,t,function(){n.sendCallback()})}):n.sendText(e,r,t,function(){n.sendCallback()})},n.saveState=function(e){I?EJSS_INTERFACE.BoxPanel.showInputDialog(o,function(e){n.sendState(e,function(){n.sendCallback()})}):n.sendState(e,function(){n.sendCallback()})},n.saveImage=function(e,t){I?EJSS_INTERFACE.BoxPanel.showInputDialog(o,function(e){n.sendSnapshot(E[t],e,function(){n.sendCallback()})}):n.sendSnapshot(E[t],e,function(){n.sendCallback()})},n.readState=function(e,t){if(e)n.getState(e);else{var r="undefined"!=typeof t?t:".json";n.getStateFiles(r,function(e){var t={text:e.name,value:e.url};EJSS_INTERFACE.BoxPanel.showSelectDialog(a,t,function(e){n.getState(e)})})}},n.readText=function(e,t,r){e?n.getText(e,function(e){if("function"==typeof r)r(e);else{var t={};t[r]=e,n._userUnserialize(t)}}):n.getStateFiles(t,function(e){var t={text:e.name,value:e.url};EJSS_INTERFACE.BoxPanel.showSelectDialog(a,t,function(e){n.getText(e,function(e){if("function"==typeof r)r(e);else{var t={};t[r]=e,n._userUnserialize(t)}})})})};var N,O,M=[],b=0,G={},x=!1;n.getEventInteractionsStream=function(e){var t=e.target||e.srcElement,n={pageX:e.pageX,pageY:e.pageY,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,target:t.id,timeStamp:+new Date};n.runCount=b,n.runTime=r,n.event="mouse",N.send(JSON.stringify(n))},n.startCaptureStream=function(e,t,i,o,a){var s=window.location,l="https:"===s.protocol?"wss:":"ws:";l+="//"+s.host+":"+e;try{N=new WebSocket(l),"undefined"!=typeof t&&t(),N.onopen=function(){b=0,r=+new Date,E.registerInteractions(N),document.addEventListener("mousemove",n.getEventInteractionsStream),document.addEventListener("touchmove",n.getEventInteractionsStream),document.addEventListener("mousedown",n.getEventInteractionsStream),document.addEventListener("touchstart",n.getEventInteractionsStream)},N.onclose=function(e){n.stopCaptureStream(),a(e)},N.onmessage=function(e){console.log("Message is received: "+e.data)}}catch(e){return void("undefined"!=typeof i&&i(e))}},n.stopCaptureStream=function(){try{N.close()}catch(e){}E.unregisterInteractions(),document.removeEventListener("mousemove",n.getEventInteractionsStream),document.removeEventListener("touchmove",n.getEventInteractionsStream),document.removeEventListener("mousedown",n.getEventInteractionsStream),document.removeEventListener("touchstart",n.getEventInteractionsStream)},n.playCaptureStream=function(e,t,n,i,o){var a=10;if(!x){x=!0;var s=[];try{O=new EventSource(e),"undefined"!=typeof t&&t(),O.onopen=i,O.onclose=function(e){var t=document.getElementById("_my_mouse");t&&document.body.removeChild(t),o(e)},O.onmessage=function(e){var t=JSON.parse(e.data);console.log("Now: "+Date.now()+"-"+t.timeStamp),s=s.concat(t.interactions)}}catch(e){return void("undefined"!=typeof n&&n(e))}setTimeout(function(){b=0,r=+new Date,k=[];var e=0,t=b,n=0,i=0,o=0,l=0,u=setInterval(function(){for(var r=e;r<s.length;){var g=s[r++];if("undefined"!=typeof g.isPlaying&&g.isPlaying)k.push(g),e++;else if(g.runCount==t&&n>=g.timeStamp-g.runTime&&i<=g.timeStamp-g.runTime){e++,i=g.timeStamp-g.runTime;for(var c in G){var S=E[c];S.getDOMElement().style.border=G[c]}if(G={},"undefined"!=typeof g.event){var d=g.pageX,f=g.pageY,p=g.target;if("undefined"!=typeof p&&p.length>0){var S=document.getElementById(p);null!=S&&(o=g.offsetLeft-S.offsetLeft,l=g.offsetTop-S.offsetTop)}d-=o,f+=l;var h=document.getElementById("_my_mouse");if(!h){var h=document.createElement("div");h.id="_my_mouse",h.style.position="absolute",h.style.margin="0",h.style.border="3px solid red",document.body.appendChild(h)}h.style.left=d+"px",h.style.top=f+"px"}else if("undefined"!=typeof g.property){var S=E[g.element];S.propertyChanged(g.property,g.data).reportInteractions()}else if("undefined"!=typeof g.action){var S=E[g.element];S.invokeAction(g.action).reportInteractions(),"undefined"==typeof G[S.getName()]&&(G[S.getName()]=S.getDOMElement().style.border),S.getDOMElement().style.border="1px solid red"}}}t!=b?(t=b,n=0,i=0):n+=a,x||clearInterval(u)},a)},1e3)}},n.pauseCaptureStream=function(){try{O.close()}catch(e){}x=!1},n.getEventInteractions=function(e){var t=e.target||e.srcElement,n={pageX:e.pageX,pageY:e.pageY,offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,target:t.id,timeStamp:e.timeStamp};n.runCount=b,n.runTime=r,n.event="mouse",M.push(n)},n.startCapture=function(){b=0,r=+new Date,E.registerInteractions(),M=[],document.addEventListener("mousemove",n.getEventInteractions),
document.addEventListener("touchmove",n.getEventInteractions),document.addEventListener("mousedown",n.getEventInteractions),document.addEventListener("touchstart",n.getEventInteractions)},n.stopCapture=function(){E.unregisterInteractions(),document.removeEventListener("mousemove",n.getEventInteractions),document.removeEventListener("touchmove",n.getEventInteractions),document.removeEventListener("mousedown",n.getEventInteractions),document.removeEventListener("touchstart",n.getEventInteractions);var e={interactions:E.getRegInteractions(),events:M};return e},n._readCapturedInteractions=function(){for(var e=k.length,t=0;t<e;t++){var r=k[t];if(r.runCount==b&&r.isPlaying){if("undefined"!==r.property){var n=E[r.element];n.propertyChanged(r.property,r.data).reportInteractions()}if("undefined"!==r.action){var n=E[r.element];n.invokeAction(r.action).reportInteractions(),"undefined"==typeof G[n.getName()]&&(G[n.getName()]=n.getDOMElement().style.border),n.getDOMElement().style.border="1px solid red"}r.runCount=-1}}};var L=!1,J=!1,w=1,W=!1,k=[];n.playCapture=function(e,t,i){var o=10,a=e.interactions,l=a.length,u=0,g=e.events,c=g.length,S=0;if(!L){L=!0,J=!1,n.reset(),"undefined"!=typeof i&&(w=i),s/=w,b=0,r=+new Date,k=a;var d=b,f=0,p=0,h=0,m=setInterval(function(){for(var e in G){var r=E[e];r.getDOMElement().style.border=G[e]}if(G={},L){for(;u<l&&a[u].runCount<=d&&f>=a[u].timeStamp-a[u].runTime;){if(!a[u].isPlaying){if("undefined"!==a[u].property){var r=E[a[u].element];r.propertyChanged(a[u].property,a[u].data).reportInteractions()}if("undefined"!==a[u].action){var r=E[a[u].element];r.invokeAction(a[u].action).reportInteractions(),"undefined"==typeof G[r.getName()]&&(G[r.getName()]=r.getDOMElement().style.border),r.getDOMElement().style.border="1px solid red"}}u++}for(;S<c&&g[S].runCount<=d&&f>=g[S].timeStamp-g[S].runTime;){var n=g[S].pageX,i=g[S].pageY,A=g[S].target;if("undefined"!=typeof A&&A.length>0){var r=document.getElementById(A);null!=r&&(p=g[S].offsetLeft-r.offsetLeft,h=g[S].offsetTop-r.offsetTop)}n-=p,i+=h;var y=document.getElementById("_my_mouse");if(!y){var y=document.createElement("div");y.id="_my_mouse",y.style.position="absolute",y.style.margin="0",y.style.border="3px solid red",document.body.appendChild(y)}y.style.left=n+"px",y.style.top=i+"px",S++}if(d!=b?(d=b,f=0):f+=o*w,S>=c&&u>=l){var y=document.getElementById("_my_mouse");y&&document.body.removeChild(y),clearInterval(m),L=!1,s*=w,k=[],t()}}J&&(clearInterval(m),L=!1,s*=w,k=[],t())},o)}},n.pauseCapture=function(){W=f,n.pause(),L=!1},n.resumeCapture=function(){W&&n.play(),L=!0},n.resetCapture=function(){J=!0},n.changeCaptureStep=function(e){s*=w,w=e,s/=w},n.setMode=function(e){n.setRunningMode(e)},n.setRunningMode=function(e){D="string"==typeof e?EJSS_CORE.Model[e.toUpperCase()]:e},n.getMode=function(){return D},n.setRunAlways=function(e){v=e},n.setPauseOnPageExit=function(e){v=!e},n.setFPS=function(e){s=Math.max(1e3/e,i)},n.getFPS=function(){return Math.int(1e3/s)},n.setDelay=function(e){s=Math.max(e,0)},n.setMinimumDelay=function(e){A=Math.max(e,0)},n.setStepsPerDisplay=function(e){e>=1&&(l=e)},n.setUpdateView=function(e){g=e},n.setAutoplay=function(e){c=e},n.isPlaying=function(){return f},n.isPaused=function(){return!f},n.resetRealTime=function(){var e=+Date();p=1e3*n.getRealTime()-e},n.play=function(){f||(d=+new Date,h=s,f=!0,t=window.setTimeout(n.run,A))},n.pause=function(){f=!1,u=!0,0!=t&&(window.clearTimeout(t),t=0)},n.run=function(){b++,r=+new Date;var e,i=1;if(f){if(y||v){switch(D){default:case EJSS_CORE.Model.MODE_JAVA_STYLE:n.step(),d=+new Date,e=d-r,i=Math.max(A,s-e);break;case EJSS_CORE.Model.MODE_RESPECT_DELAY:n.step(),i=s,d=+new Date;break;case EJSS_CORE.Model.MODE_RESPECT_TIME:if(e=r-d,e>=h-m){var o=0;h&&(o=Math.floor((e+m)/h),m=e+m-o*h);var a=n.step(o);h&&a>e&&o>100&&(alert("Imposible running with delay "+h+" ms."),f=!1,m=0),h=s,d=r}}var l=t;if(n._readCapturedInteractions(),E._16(b,r,f)&&(n.automaticResetSolvers(),n.update()),l!=t)return}else d=+new Date;t=window.setTimeout(n.run,i)}},n.onExit=function(){n.pause(),E._16(b,r,f),n.freeMemory()},n.reset=function(e){e||(n.pause(),n.resetModel()),E._14(!1),E._reset(),e||(E._15(),E._initialize(),n.initializeModel()),n.updateModel(),g?(E._update(),E._render()):E._collectData(),E._14(!0),c&&n.play(),E._resized(window.innerWidth,window.innerHeight)},n.initialize=function(){E._initialize(),n.initializeModel(),n.updateModel(),g?(E._update(),E._render()):E._collectData()},n.update=function(){(y||v)&&(n.updateModel(),g?(E._update(),E._render()):E._collectData())},n.step=function(e){var t=+new Date;e||(e=1);var r=Math.max(e,l);if(r>1){u=!1;for(var i=1;i<r;i++){if(u)return void n.update();n.stepModel(),n.updateModel(),E._collectData()}}n.stepModel();var o=+new Date-t;return n.update(),o},n.setShouldBreak=function(e){S=e},n.getShouldBreak=function(){return S},n._autoSelectView=function(e){for(var t=screen.height,r=screen.width,n=[],i=Number.MAX_VALUE,o=0;o<e.length;o++){var a=r-e[o].width;a>=0&&(a<i?(i=a,n=[o]):a==i&&n.push(o))}var s=-1;i=Number.MAX_VALUE;for(var o=0;o<n.length;o++){var a=Math.abs(t-e[n[o]].height);a<i&&(i=a,s=n[o])}return s},n.addToOnload=function(e){P.push(e)},n.onload=function(){for(var e=0,t=P.length;e<t;e++)P[e]()};var F=[],V=[],B=[],H=[];return n.getRealTime=function(){return NaN},n.automaticResetSolvers=function(){},n.freeMemory=function(){},n.addToReset=function(e){F.push(e)},n.addToInitialization=function(e){V.push(e)},n.addToEvolution=function(e){B.push(e)},n.addToFixedRelations=function(e){H.push(e)},n.resetModel=function(){e(F)},n.initializeModel=function(){e(V)},n.stepModel=function(){e(B)},n.updateModel=function(){e(H)},window.onblur=function(){y=!1},window.onfocus=function(){y=!0},n};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.Bootstrap2IntervalData={},EJSS_ODE_INTERPOLATION.bootstrap2IntervalData=function(e,t,r,n,i){var o,a,s,l,u=EJSS_ODE_INTERPOLATION.bootstrapIntervalData(e,t,r,n,i);u.interpolate=function(e,t){var r=u.getDeltaTime(),n=u.getLeftState(),i=u.getLeftRate(),g=(e-u.getLeft())/r;return n[t]+g*(r*i[t]+g*(o[t]+g*(a[t]+g*(s[t]+g*l[t]))))},u.interpolateState=function(e,t,r,n){return u.bootstrap2((e-u.getLeft())/u.getDeltaTime(),t,r,n),t},u.bootstrap2=function(e,t,r,n){for(var i=u.getDeltaTime(),g=u.getLeftState(),c=u.getLeftRate(),S=r,d=0;d<n;d++)t[d]=g[S]+e*(i*c[S]+e*(o[S]+e*(a[S]+e*(s[S]+e*l[S])))),S++};var g=.7,c=.85,S=2*g*(g-1)*c*(c-1)*(c-g)*(10*g*c-5*c-5*g+3),d=g*(-3*g+2),f=g*(-3*g+4)-1,E=6*g*(g-1),p=c*(-3*c+2),h=c*(-3*c+4)-1,m=6*c*(c-1),A=g*(2+g*(-6+4*g)),y=c*(2+c*(-6+4*c)),v=g*(4+g*(-9+5*g*g)),P=c*(4+c*(-9+5*c*c)),D=e.length,I=D-1,_=u.getDeltaTime(),C=new Array(D),R=new Array(D),T=new Array(D);o=new Array(D),a=new Array(D),s=new Array(D),l=new Array(D),u.bootstrap1(g,C,0,I),C[I]=u.getLeft()+g*_,i.getRate(C,R),u.bootstrap1(c,C,0,I),C[I]=u.getLeft()+c*_,i.getRate(C,T);for(var N=0;N<D;N++){var O=r[N]-e[N],M=_*t[N],b=_*n[N],G=_*R[N]+d*b+f*M+E*O,x=_*T[N]+p*b+h*M+m*O,L=(P*G-v*x)/S,J=(A*x-y*G)/S,w=b+M-2*O-2*L-3*J;l[N]=J,s[N]=L,a[N]=w,o[N]=O-M-w-L-J}return u};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.BootstrapIntervalData={},EJSS_ODE_INTERPOLATION.bootstrapIntervalData=function(e,t,r,n,i){var o,a,s,l=EJSS_ODE_INTERPOLATION.hermiteIntervalData(e,t,r,n);l.interpolate=function(e,t){var r=l.getDeltaTime(),n=l.getLeftState(),i=l.getLeftRate(),u=(e-l.getLeft())/r;return n[t]+u*(r*i[t]+u*(o[t]+u*(a[t]+u*s[t])))},l.interpolateState=function(e,t,r,n){return l.bootstrap1((e-l.getLeft())/l.getDeltaTime(),t,r,n),t},l.bootstrap1=function(e,t,r,n){for(var i=l.getDeltaTime(),u=l.getLeftState(),g=l.getLeftRate(),c=r,S=0;S<n;S++)t[S]=u[c]+e*(i*g[c]+e*(o[c]+e*(a[c]+e*s[c]))),c++};var u=.25,g=u*(u-1)*(4*u-2),c=u*(-3*u+2),S=u*(-3*u+4)-1,d=6*u*(u-1),f=e.length,E=l.getDeltaTime(),p=new Array(f),h=new Array(f);o=new Array(f),a=new Array(f),s=new Array(f),l.hermite(u,p,0,f-1),p[f-1]=l.getLeft()+u*E,i.getRate(p,h);for(var m=0;m<f;m++){var A=r[m]-e[m],y=E*t[m],v=E*n[m],P=(E*h[m]+c*v+S*y+d*A)/g,D=v+y-2*A-2*P;s[m]=P,a[m]=D,o[m]=A-y-D-P}return l};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.ConstantConditionData={},EJSS_ODE_INTERPOLATION.constantConditionData=function(e){var t,r=EJSS_ODE_INTERPOLATION.intervalData(Number.NaN,Number.NaN);r.interpolate=function(e,r){return t[r]},r.interpolateState=function(e,r,n,i){for(var o=n,a=0;a<i;a++)r[a]=t[o],o++;return r};var n=e.length;t=new Array(n);for(var i=0;i<n;i++)t[i]=e[i];return r};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.Dopri5IntervalData={},EJSS_ODE_INTERPOLATION.dopri5IntervalData=function(e,t,r){var n=EJSS_ODE_INTERPOLATION.extraStepsIntervalData(e,bState,r);return n.interpolate=function(e,t){var r=(e-n.getLeft())/n.getDeltaTime(),i=1-r,o=n.getCoeffs();return o[0][t]+r*(o[1][t]+i*(o[2][t]+r*(o[3][t]+i*o[4][t])))},n.interpolateState=function(e,t,r,i){for(var o=(e-n.getLeft())/n.getDeltaTime(),a=1-o,s=n.getCoeffs(),l=r,u=0;u<i;u++)t[u]=s[0][l]+o*(s[1][l]+a*(s[2][l]+o*(s[3][l]+a*s[4][l]))),l++;return t},n};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.Dopri853IntervalData={},EJSS_ODE_INTERPOLATION.dopri853IntervalData=function(e,t,r){var n=EJSS_ODE_INTERPOLATION.extraStepsIntervalData(e,bState,r);return n.interpolate=function(e,t){var r=(e-n.getLeft())/n.getDeltaTime(),i=1-r,o=n.getCoeffs();return o[0][t]+r*(o[1][t]+i*(o[2][t]+r*(o[3][t]+i*(o[4][t]+r*(o[5][t]+i*(o[6][t]+r*o[7][t]))))))},n.interpolateState=function(e,t,r,i){for(var o=(e-n.getLeft())/n.getDeltaTime(),a=1-o,s=n.getCoeffs(),l=r,u=0;u<i;u++)t[u]=s[0][l]+o*(s[1][l]+a*(s[2][l]+o*(s[3][l]+a*(s[4][l]+o*(s[5][l]+a*(s[6][l]+o*s[7][l])))))),l++;return t},n};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.EulerIntervalData={},EJSS_ODE_INTERPOLATION.eulerIntervalData=function(e,t,r){var n,i,o=EJSS_ODE_INTERPOLATION.intervalData(e[e.length-1],r);o.interpolate=function(e,t){var r=e-o.getLeft();return n[t]+r*i[t]},o.interpolateState=function(e,t,r,a){for(var s=e-o.getLeft(),l=r,u=0;u<a;u++)t[u]=n[l]+s*i[l],l++;return t};var a=e.length;n=new Array(a),i=new Array(a);for(var s=0;s<a;s++)n[s]=e[s],i[s]=t[s];return o};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.EulerRichardsonIntervalData={},EJSS_ODE_INTERPOLATION.eulerRichardsonIntervalData=function(e,t,r,n){var i,o,a,s,l,u=EJSS_ODE_INTERPOLATION.intervalData(e[e.length-1],r);u.interpolate=function(e,t){var r=(e-u.getLeft())/o,n=r*r*o,i=o*r-n;return a[t]+i*s[t]+n*l[t]},u.interpolateState=function(e,t,r,n){for(var i=(e-u.getLeft())/o,g=i*i*o,c=o*i-g,S=r,d=0;d<n;d++)t[d]=a[S]+c*s[S]+g*l[S],S++;return t};var g=e.length;a=new Array(g),s=new Array(g),l=new Array(g);for(var c=0;c<g;c++)a[c]=e[c],s[c]=t[c],l[c]=n[c];return i=g-1,o=r-e[i],u};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.ExtraStepsIntervalData={},EJSS_ODE_INTERPOLATION.extraStepsIntervalData=function(e,t,r){var n,i,o,a=EJSS_ODE_INTERPOLATION.intervalData(e[e.length-1],t[t.length-1]);a.getTimeIndex=function(){return n},a.getDeltaTime=function(){return i},a.getCoeffs=function(){return o};var s=e.length;n=s-1,i=t[n]-e[n];var l=r.length;o=new Array(l);for(var u=0;u<l;u++){o[u]=new Array(s);for(var g=0;g<s;g++)o[u][g]=r[u][g]}return a};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.HermiteIntervalData={},EJSS_ODE_INTERPOLATION.hermiteIntervalData=function(e,t,r,n){var i,o,a,s,l,u,g=EJSS_ODE_INTERPOLATION.intervalData(e[e.length-1],r[r.length-1]);g.getTimeIndex=function(){return i},g.getDeltaTime=function(){return o},g.getLeftState=function(){return a},g.getLeftRate=function(){return s},g.interpolate=function(e,t){var r=(e-g.getLeft())/o,n=r-1,i=r*n,c=i*(1-2*r),S=-n-c,d=r+c,f=i*n*o,E=i*r*o;return S*a[t]+d*l[t]+f*s[t]+E*u[t]},g.interpolateState=function(e,t,r,n){return g.hermite((e-g.getLeft())/o,t,r,n),t},g.hermite=function(e,t,r,n){for(var i=e-1,g=e*i,c=g*(1-2*e),S=-i-c,d=e+c,f=g*i*o,E=g*e*o,p=r,h=0;h<n;h++)t[h]=S*a[p]+d*l[p]+f*s[p]+E*u[p],p++};var c=e.length;a=new Array(c),s=new Array(c),l=new Array(c),u=new Array(c);for(var S=0;S<c;S++)a[S]=e[S],s[S]=t[S],l[S]=r[S],u[S]=n[S];return i=c-1,o=r[i]-e[i],g};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.InitialConditionData={},EJSS_ODE_INTERPOLATION.initialConditionData=function(e){var t,r=EJSS_ODE_INTERPOLATION.intervalData(Number.NaN,Number.NaN);r.interpolate=function(r,n){return e.getInitialCondition(r,t),t[n]},r.interpolateState=function(r,n,i,o){e.getInitialCondition(r,t);for(var a=i,s=0;s<o;s++)n[s]=t[a],a++;return n};var n=e.getState(),i=n.length;return t=new Array(i),r};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.IntervalData={},EJSS_ODE_INTERPOLATION.intervalData=function(e,t){var r={};return r.getLeft=function(){return e},r.getRight=function(){return t},r.setRight=function(e){t=e},r.interpolate=function(e,t){return Number.NaN},r.interpolateState=function(e,t,r,n){return t},r};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.Radau5IntervalData={},EJSS_ODE_INTERPOLATION.radau5IntervalData=function(e,t,r){var n=EJSS_ODE_INTERPOLATION.extraStepsIntervalData(e,bState,r),i=bState[bState.length-1];return n.interpolate=function(e,t){var r=(e-i)/n.getDeltaTime(),o=n.getCoeffs(),a=EJSS_ODE_SOLVERS.Radau5.c1m1,s=EJSS_ODE_SOLVERS.Radau5.c2m1;return o[0][t]+r*(o[1][t]+(r-s)*(o[2][t]+(r-a)*o[3][t]))},n.interpolateState=function(e,t,r,o){for(var a=(e-i)/mDeltaTime,s=n.getCoeffs(),l=EJSS_ODE_SOLVERS.Radau5.c1m1,u=EJSS_ODE_SOLVERS.Radau5.c2m1,g=r,c=0;c<o;c++)t[c]=s[0][g]+a*(s[1][g]+(a-u)*(s[2][g]+(a-l)*s[3][g])),g++;return t},n};var EJSS_ODE_INTERPOLATION=EJSS_ODE_INTERPOLATION||{};EJSS_ODE_INTERPOLATION.StateHistory={},EJSS_ODE_INTERPOLATION.stateHistory=function(e){var t,r={},n=[],i=!0,o=0,a=0,s=0;return r.setLength=function(e){a=Math.abs(e),s=Math.max(o,a)},r.setMinimumLength=function(e){o=Math.abs(e),s=Math.max(o,a)},r.addIntervalData=function(e){i=e.getLeft()<=e.getRight();n.length;if(n.length>0){var t=n.length-1,r=n[t],o=0;if(i){for(;null!=r&&r.getLeft()>=e.getLeft();)o++,t--,r=t<0?null:n[t];null!=r&&e.getLeft()<r.getRight()&&r.setRight(e.getLeft())}else{for(;null!=r&&r.getLeft()<=e.getLeft();)o++,t--,r=t<0?null:n[t];null!=r&&e.getLeft()>r.getRight()&&r.setRight(e.getLeft())}o>0&&n.splice(t,o)}n.push(e)},r.toString=function(){for(var e="History has now "+n.length+" intervals: ",t=0,r=n.length;t<r;t++){var i=n[t];t>0&&(e+=", "),e+=" ["+i.getLeft()+","+i.getRight()+")"}return e},r.clearAll=function(){n=[]},r.clean=function(e){if(isFinite(s)){if(0==s)return void clearAll();var t=0,r=n.length;if(i){e-=s;for(var o=0;o<r;o++){var a=n[o];if(a.getRight()>e)break;t++}}else{e+=s;for(var o=0;o<r;o++){var a=n[o];if(a.getRight()<e)break;t++}}t>0&&n.splice(0,t)}},r.findInterval=function(e){var r=n.length;if(i)for(var o=r-1;o>=0;o--){var a=n[o];if(a.getLeft()<=e)return a}else for(var o=r-1;o>=0;o--){var a=n[o];if(a.getLeft()>=e)return a}return t},r.interpolate=function(e,t){var n=r.findInterval(e);return n.interpolate(e,t)},r.interpolateState=function(e,t,n,i){var o=r.findInterval(e);return i||(i=t.length),n||(n=0),o.interpolateState(e,t,n,i)},e.getInitialCondition?(t=EJSS_ODE_INTERPOLATION.initialConditionData(e),e.setStateHistory(r)):t=EJSS_ODE_INTERPOLATION.constantConditionData(e.getState()),r};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.EVENT_TYPE={STATE_EVENT:0,POSITIVE_EVENT:1,CROSSING_EVENT:2},EJSS_ODE_SOLVERS.EVENT_METHOD={BISECTION:0,SECANT:1},EJSS_ODE_SOLVERS.ERROR={NO_ERROR:0,INTERNAL_SOLVER_ERROR:1,EVENT_NOT_FOUND:2,ILLEGAL_EVENT_STATE:3,ZENO_EFFECT:4,TOO_MANY_STEPS_ERROR:5,DISCONTINUITY_PRODUCED_ERROR:6,DID_NOT_CONVERGE:7},EJSS_ODE_SOLVERS.DISCONTINUITY_CODE={DISCONTINUITY_PRODUCED_ERROR:0,NO_DISCONTINUITY_ALONG_STEP:1,DISCONTINUITY_ALONG_STEP:2,DISCONTINUITY_JUST_PASSED:3,DISCONTINUITY_EXACTLY_ON_STEP:4},EJSS_ODE_SOLVERS.InterpolatorEventSolver={},EJSS_ODE_SOLVERS.interpolatorEventSolver=function(e,t){function r(t,r){h?e.bestInterpolate(t,r):e.interpolate(t,r)}function n(){var n=t.getState(),i=e.getCurrentRate(),o=n[S];if(o+i[S]==o)return 0;var a=e.getMaximumTime(!1);return isNaN(a)?E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at "+n[S]):o==a&&(a=e.internalStep(!1),isNaN(a))?E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at max step at "+n[S]):(r(a,n),a-o)}function i(){var n=t.getState(),i=e.getCurrentRate(),o=n[S];if(o+i[S]==o)return 0;var a=n[S]+m,s=e.getMaximumTime(!1);if(isNaN(s))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at "+n[S]);var l=0;if(C)for(;s<a;){if(s=e.internalStep(!1),isNaN(s))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver forwards at "+n[S]);if(++l>_){var u=n[S],g=e.bestInterpolate(a,new Array(c))[S];return E.error(EJSS_ODE_SOLVERS.ERROR.TOO_MANY_STEPS_ERROR,"The solver exceeded the maximum of "+_+" internal steps\nat "+g+", starting from "+u+" for an step of "+m)}}else for(;s>a;){if(s=e.internalStep(!1),isNaN(s))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver backwards at "+n[S]);if(++l>_)return E.error(EJSS_ODE_SOLVERS.ERROR.TOO_MANY_STEPS_ERROR,"The solver exceeded the number of internal steps at "+n[S])}return r(a,n),m}function o(){var n=t.getState();if(P>0&&L>P&&l(n))return 0;var i=n[S],o=e.getCurrentRate();if(i+o[S]==i)return 0;var a=e.getMaximumTime(k);if(isNaN(a))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at "+n[S]);if(i==a&&(a=e.internalStep(k),isNaN(a)))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver forwards at "+n[S]);null!=x&&(isNaN(x.getMaxAdvance())||(a=C?Math.min(a,x.getMaxAdvance()):Math.max(a,x.getMaxAdvance())));for(var u=C?Math.min(i+v,a):Math.max(i-v,a);;){var g=null;if(w=null,r(u,d),g=E.findFirstEvent(n,u,d),null==g&&null!=F&&F.getTime()<=u&&(g=F),null!=g){if(w=g,h)e.bestInterpolate(g.getTime(),n);else for(var f=0;f<c;f++)n[f]=d[f];var p=n[S];return g.action(),E.reinitialize(),n=t.getState(),p!=n[S]?(L=0,x=null,w=null,g.reset(n),g.getTime()-i):(null!=x&&(Math.abs(G-g.getTime())<D?L++:L=0),x=g,G=g.getTime(),g.getTime()-i)}if(u==a){for(var f=0;f<c;f++)n[f]=d[f];return s(n[S]),a-i}u=C?Math.min(u+v,a):Math.max(u-v,a)}}function a(){var n=t.getState();if(P>0&&L>P&&l(n))return 0;var i=n[S],o=e.getCurrentRate();if(i+o[S]==i)return 0;var a=i+m,u=e.getMaximumTime(k);if(isNaN(u))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver at "+n[S]);for(var g=C?Math.min(i+v,a):Math.max(i-v,a),f=0;;){var p=null;w=null;var A=C?u<g:u>g;if(A){if(e.bestInterpolate(u,d),p=E.findFirstEvent(n,u,d),null==p&&(p=F),null==p){for(var y=0;y<c;y++)n[y]=d[y];if(s(n[S]),u=e.internalStep(k),isNaN(u))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver looking for an event at "+n[S]);if(++f>_)return E.error(EJSS_ODE_SOLVERS.ERROR.TOO_MANY_STEPS_ERROR,"The solver exceeded the number of internal steps at "+n[S]);continue}}else if(r(g,d),p=E.findFirstEvent(n,g,d),null==p&&null!=F&&F.time<=g&&(p=F),null==p){if(g==a){for(var y=0;y<c;y++)n[y]=d[y];return s(n[S]),a-i}g=C?Math.min(g+v,a):Math.max(g-v,a);continue}if(w=p,h)e.bestInterpolate(p.getTime(),n);else for(var y=0;y<c;y++)n[y]=d[y];var R=n[S],T=p.action();if(E.reinitialize(),f=0,n=t.getState(),R!=n[S])return L=0,x=null,w=null,p.reset(n),p.getTime()-i;if(null!=x&&(Math.abs(G-p.getTime())<D?(L++,I&&(T=!1)):L=0),x=p,G=p.getTime(),T)return p.getTime()-i;if(P>0&&L>P&&l(n))return p.getTime()-i;if(F=null,u=e.getMaximumTime(k),isNaN(p.getMaxAdvance())||(u=C?Math.min(u,p.getMaxAdvance()):Math.max(u,p.getMaxAdvance())),isNaN(u))return E.error(EJSS_ODE_SOLVERS.ERROR.INTERNAL_SOLVER_ERROR,"Error when stepping the solver after an event at "+n[S])}}function s(e){var t,r;for(r=O.length,t=0;t<r;t++){var n=O[t];n.findPosition(e,n.getH())}for(r=V.length,t=0;t<r;t++){var n=V[t];n.findPosition(e,n.getH())}}function l(e){if(J.length<=0)return E.error(EJSS_ODE_SOLVERS.ERROR.ZENO_EFFECT,"A Zeno-like effect has been detected.\nLast event was "+x.getProblem()+" which took place at "+G),!0;var t,r=!1,n=J.length;for(t=0;t<n;t++){var i=J[t];i.zenoEffectAction(x.getProblem(),e)&&(r=!0)}return L=0,r}function u(e,t,r,n){r.splice(0,r.length);for(var i=O.length,o=0;o<i;o++){var a=O[o];switch(a.setH(a.getEvent().evaluate(t)),a.getCurrentPosition()){default:case EJSS_ODE_SOLVERS.ProblemData.POSITIVE:a.getH()<=0&&r.push(a);break;case EJSS_ODE_SOLVERS.ProblemData.SMALL_POSITIVE:if(a.getH()<=0&&(a.hasPositiveFlag()||a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT))return a;break;case EJSS_ODE_SOLVERS.ProblemData.ZERO:if(a.getH()<0){if(a.hasPositiveFlag()||a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT)return a}else if(a.getH()>0&&a.hasNegativeFlag()&&a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.CROSSING_EVENT)return a;break;case EJSS_ODE_SOLVERS.ProblemData.SMALL_NEGATIVE:if(a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT){if(a.getH()<=-a.getEvent().getTolerance())return a}else if(a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.CROSSING_EVENT&&a.hasNegativeFlag()&&a.getH()>=0)return a;break;case EJSS_ODE_SOLVERS.ProblemData.NEGATIVE:if(a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.CROSSING_EVENT)a.getH()>=0&&r.push(a);else if(a.getEventType()==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT)return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e+" for the state event "+a.getEvent()),a}}return null}function g(e,t,r){var n,i,o=e.length,a=r,s=r-t,l=(t+r)/2;if(C)for(n=0;n<o;n++){var u=e[n];switch(u.getEvent().getRootFindingMethod()){default:case EJSS_ODE_SOLVERS.EVENT_METHOD.BISECTION:a=Math.min(a,l);break;case EJSS_ODE_SOLVERS.EVENT_METHOD.SECANT:i=u.getHBefore(),a=Math.min(a,t-i*s/(u.getHAfter()-i))}}else for(n=0;n<o;n++){var u=e[n];switch(u.getEvent().getRootFindingMethod()){default:case EJSS_ODE_SOLVERS.EVENT_METHOD.BISECTION:a=Math.max(a,l);break;case EJSS_ODE_SOLVERS.EVENT_METHOD.SECANT:i=u.getHBefore(),a=Math.max(a,t-i*s/(u.getHAfter()-i))}}return a}var c,S,d,f,E={},p=!0,h=!1,m=.1,A=Number.NaN,y=Number.NaN,v=Number.POSITIVE_INFINITY,P=500,D=2*Number.MIN_VALUE,I=!0,_=1e4,C=m>0,R=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,T="No error",N=0,O=[],M=[],b=[],G=Number.NaN,x=null,L=0,J=[],w=null,W=!1,k=!1,F=null,V=[],B=null,H=100,z=1e-8,Y=Number.NaN;return E.getEPSILON=function(){if(isNaN(Y)){for(Y=1;Y+1!=1;)Y/=2;Y*=2}return Y},E.setEnableExceptions=function(e){p=e},E.setBestInterpolation=function(e){h=e},E.setHistoryLength=function(t){e.getStateHistory().setLength(t)},E.setStepSize=function(t){m!=t&&(m=t,C=m>0,E.setInternalStepSize(e.getStepSize()))},E.getStepSize=function(){return m},E.setEstimateFirstStep=function(t){e.setEstimateFirstStep(t)},E.setInternalStepSize=function(t){e.setStepSize(C?Math.abs(t):-Math.abs(t))},E.setMaximumInternalStepSize=function(t){e.setMaximumStepSize(t)},E.setMaximumInternalSteps=function(e){_=e},E.setTolerances=function(t,r){e.setTolerances(A=Math.abs(t),y=Math.abs(r))},E.setTolerance=function(e){setTolerances(e,0)},E.getTolerance=function(){return Math.max(A,y)},E.setDDETolerance=function(e){z=e},E.getDDETolerance=function(){return z},E.setDDEIterations=function(e){H=e},E.getDDEIterations=function(){return H},E.addEvent=function(e){O.push(EJSS_ODE_SOLVERS.eventData(E,e,t.getState())),W=!0},E.removeEvent=function(e){for(var t=-1,r=O.length,n=0;n<r;n++){var i=O[n];if(i.getEvent()==e){t=n;break}}if(t>=0){var o=O[t];x==o&&(x=null,L=0),w==o&&(w=null),O.splice(t,1)}W=k||O.length>0},E.addDiscontinuity=function(e){V.push(EJSS_ODE_SOLVERS.discontinuityData(E,e,t.getState())),k=!0,W=!0},E.removeDiscontinuity=function(e){for(var t=-1,r=V.length,n=0;n<r;n++){var i=V[n];if(i.getDiscontinuity()==e){t=n;break}}t>=0&&V.splice(t,1),k=V.length>0,W=k||O.length>0},E.removeAllEvents=function(){O=[],V=[],k=!1,W=!1,null!=B&&E.addDiscontinuity(B)},E.setMaximumEventStep=function(e){v=Math.abs(e)},E.getMaximumEventStep=function(){return v},E.setCoalesceCloseEvents=function(e){I=e},E.isCoalesceCloseEvents=function(){return I},E.setEventProximityThreshold=function(e){D=e},E.getEventProximityThreshold=function(){return D},E.setZenoEffectDetection=function(e){P=e},E.getZenoEffectDetection=function(){return P},E.addZenoEffectListener=function(e){J.push(e)},E.removeZenoEffectListener=function(e){for(var t=J.length,r=0;r<t;r++)if(J[r]==e)return void J.splice(r,1)},E.setZeroZenoCounter=function(){L=0},E.getSolverEngine=function(){return e},E.getODE=function(){return t},E.getStateHistory=function(){return e.getStateHistory()},E.getErrorCode=function(){return R},E.getErrorMessage=function(){return T},E.getCounter=function(){return e.getCounter()},E.getNumberOfAttempts=function(){return N},E.getInternalStepSize=function(){return e.getInternalStepSize()},E.getIndependentVariableValue=function(){return t.getState()[S]},E.getCurrentTime=function(){return t.getState()[S]},E.getRunsForwards=function(){return C},E.getCurrentEventData=function(){return w},E.getLastEventData=function(){return x},E.getLastEventDataTime=function(){return G},E.initialize=function(r){var n,i,o;for(m=r,C=m>0,e.initialize(m),o=t.getState(),c=o.length,S=c-1,d=new Array(c),f=new Array(c),R=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,T="No error",L=0,x=null,w=null,null!==B&&(B.initialize(o),E.removeDiscontinuity(B),E.addDiscontinuity(B)),i=O.length,n=0;n<i;n++)O[n].reset(o);for(i=V.length,n=0;n<i;n++)V[n].reset(o)},E.step=function(){return W?a():i()},E.maxStep=function(){return W?o():n()},E.userReinitialize=function(){w=null,E.reinitialize()},E.reinitialize=function(){var r,n,i=t.getState();for(e.reinitialize(i),R=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,T="No error",null!=B&&B.reset(i),n=O.length,r=0;r<n;r++)O[r].reset(i);for(n=V.length,r=0;r<n;r++)V[r].reset(i);F=null},E.resetDiscontinuities=function(e){if(null!==B){B.reset(e);for(var t=V.length,r=0;r<t;r++)V[r].reset(e)}},E.checkDiscontinuity=function(e,t){for(var r=V.length,n=null,i=0;i<r;i++){var o=V[i],a=o.getDiscontinuity().evaluate(e);switch(o.setH(a),o.getCurrentPosition()){default:case EJSS_ODE_SOLVERS.ProblemData.POSITIVE:if(a<=0)return EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP;a<o.getDiscontinuity().getTolerance()&&(n=o);break;case EJSS_ODE_SOLVERS.ProblemData.SMALL_POSITIVE:if(a<=0&&o.hasPositiveFlag())return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e[S]+" for the discontinuity "+o.getDiscontinuity()),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR;break;case EJSS_ODE_SOLVERS.ProblemData.ZERO:if(a<0&&o.hasPositiveFlag())return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e[S]+" for the discontinuity "+o.getDiscontinuity()),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR;if(a>0&&o.hasNegativeFlag())return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e[S]+" for the discontinuity "+o.getDiscontinuity()),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR;break;case EJSS_ODE_SOLVERS.ProblemData.SMALL_NEGATIVE:if(o.hasNegativeFlag()&&a>=0)return E.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,"The system started from an illegal state at "+e[S]+" for the discontinuity "+o.getDiscontinuity()),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR;break;case EJSS_ODE_SOLVERS.ProblemData.NEGATIVE:if(a>0)return EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP;a>-o.getDiscontinuity().getTolerance()&&(n=o)}}return null!=n?(t&&(F=n,F.setTime(e[S])),EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP):EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP},E.error=function(t,r){if(R=t,T=r,p)throw{name:"ODE Solver exception",solver:e,message:r};return Number.NaN},E.findFirstEvent=function(t,n,i){var o,a;N=0;var s=u(t[S],i,M,"at t1");if(null!=s){for(s.time=t[S],s.maxAdvance=n,o=0;o<c;o++)i[o]=t[o];return s}if(M.length<=0)return null;var l=!0;for(a=O.length,o=0;o<a;o++){var d=O[o];d.setHAfter(d.getH())}for(;l;){N++;var p=g(M,t[S],n);r(p,f);var h=u(t[S],f,b,"short");if(null!=h){for(h.time=t[S],h.maxAdvance=p,o=0;o<c;o++)i[o]=t[o];return h}if(b.length<=0){var m=null;for(a=M.length,o=0;o<a;o++){var d=M[o];if(d.getCurrentPosition()==EJSS_ODE_SOLVERS.ProblemData.POSITIVE){if(d.getH()<d.getEvent().getTolerance()){m=d;break}}else if(d.getH()>-d.getEvent().getTolerance()){m=d;break}}if(null!=m){for(m.time=p,m.maxAdvance=n,o=0;o<c;o++)i[o]=f[o];return m}for(o=0;o<c;o++)t[o]=f[o];for(a=O.length,o=0;o<a;o++){var d=O[o];d.findPosition(t[S],d.getH())}var A=u(t[S],i,M,"at tTest");if(null!=A){for(A.time=t[S],A.maxAdvance=n,o=0;o<c;o++)i[o]=t[o];return A}}else{var y=!0,m=null;for(a=b.length,o=0;o<a;o++){var v=b[o];if(v.getCurrentPosition()==EJSS_ODE_SOLVERS.ProblemData.POSITIVE){if(v.getH()<=-v.getEvent().getTolerance()){y=!1;break}m=v}else{if(v.getH()>=v.getEvent().getTolerance()){y=!1;break}m=v}}if(y&&null!=m){for(m.time=p,m.maxAdvance=n,o=0;o<c;o++)i[o]=f[o];return m}for(n=p,o=0;o<c;o++)i[o]=f[o];for(a=O.length,o=0;o<a;o++){var d=O[o];d.setHAfter(d.getH())}for(M=[],a=b.length,o=0;o<a;o++)M.push(b[o])}for(a=M.length,o=0;o<a;o++){var v=M[o];if(N>v.getEvent().getMaxIterations()){l=!1;break}}}var P=M[0];return E.error(EJSS_ODE_SOLVERS.ERROR.EVENT_NOT_FOUND,"Warning : Event not found after "+N+" attempts at t="+t[S]+" h="+P.getH()+".\nPlease check the code of your event, decrease the initial step size, the tolerance of the solver,\nor the event maximum step, or increase the maximum number of attempts.\nFirst event remaining in the queue: "+P.getEvent()),P.setTime((t[S]+n)/2),P.setMaxAdvance(Number.NaN),e.bestInterpolate(P.time,i),P},t.getDelays&&(B=EJSS_ODE_SOLVERS.ddeDiscontinuity(E,t)),e.setODE(E,t),E};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.BogackiShampine23={B3_1:2/9,B3_2:1/3,B3_3:4/9,B2_1:7/24,B2_2:.25,B2_3:1/3,B2_4:1/8},EJSS_ODE_SOLVERS.bogackiShampine23=function(){var e,t,r,n=EJSS_ODE_SOLVERS.solverEngineDiscreteTimeAdaptive(3),i=n.allocateOtherArrays;return n.getNumberOfEvaluations=function(){return 3},n.allocateOtherArrays=function(){i(),e=new Array(n.getDimension()),t=new Array(n.getDimension()),r=new Array(n.getDimension())},n.computeIntermediateStep=function(r,i){var o,a=r/2,s=n.getODE(),l=n.getInitialState(),u=n.getInitialRate(),g=n.getDimension(),c=g-1,S=(u[c],EJSS_ODE_SOLVERS.BogackiShampine23);for(o=0;o<g;o++)i[o]=l[o]+a*u[o];s.getRate(i,e);var d=.75*r;for(o=0;o<g;o++)i[o]=l[o]+d*e[o];for(s.getRate(i,t),o=0;o<c;o++)i[o]=l[o]+r*(S.B3_1*u[o]+S.B3_2*e[o]+S.B3_3*t[o]);i[c]=n.getInitialTime()+r*u[c]},n.computeCarefulIntermediateStep=function(r,i,o){var a,s=i/2,l=n.getODE(),u=n.getInitialState(),g=n.getInitialRate(),c=n.getDimension(),S=c-1,d=(g[S],EJSS_ODE_SOLVERS.BogackiShampine23),f=EJSS_ODE_SOLVERS.DISCONTINUITY_CODE;for(a=0;a<c;a++)o[a]=u[a]+s*g[a];switch(r.checkDiscontinuity(o,!1)){case f.DISCONTINUITY_PRODUCED_ERROR:return f.DISCONTINUITY_PRODUCED_ERROR;case f.DISCONTINUITY_JUST_PASSED:return f.DISCONTINUITY_JUST_PASSED;case f.DISCONTINUITY_ALONG_STEP:return f.DISCONTINUITY_ALONG_STEP;case f.DISCONTINUITY_EXACTLY_ON_STEP:break;case f.NO_DISCONTINUITY_ALONG_STEP:}l.getRate(o,e);var E=.75*i;for(a=0;a<c;a++)o[a]=u[a]+E*e[a];switch(r.checkDiscontinuity(o,!1)){case f.DISCONTINUITY_PRODUCED_ERROR:return f.DISCONTINUITY_PRODUCED_ERROR;case f.DISCONTINUITY_JUST_PASSED:return f.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED;case f.DISCONTINUITY_ALONG_STEP:return f.DISCONTINUITY_ALONG_STEP;case f.DISCONTINUITY_EXACTLY_ON_STEP:break;case f.NO_DISCONTINUITY_ALONG_STEP:}for(l.getRate(o,t),a=0;a<S;a++)o[a]=u[a]+i*(d.B3_1*g[a]+d.B3_2*e[a]+d.B3_3*t[a]);return o[S]=n.getInitialTime()+i*g[S],
r.checkDiscontinuity(o,!0)},n.computeFinalRateAndCreateIntervalData=function(){var e=(n.getODE(),n.getInitialState()),t=n.getInitialRate(),r=n.getFinalState(),i=n.getFinalRate();return EJSS_ODE_INTERPOLATION.hermiteIntervalData(e,t,r,i)},n.computeApproximation=function(i){var o=n.getODE(),a=n.getTimeIndex(),s=n.getInitialState(),l=n.getInitialRate(),u=n.getFinalState(),g=n.getFinalRate();o.getRate(u,g);for(var c=EJSS_ODE_SOLVERS.BogackiShampine23,S=0;S<a;S++)r[S]=s[S]+i*(c.B2_1*l[S]+c.B2_2*e[S]+c.B2_3*t[S]+c.B2_4*g[S]);return r[a]=n.getInitialTime()+i*l[a],n.computeError(r)},n};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.CashKarp45={A_11:.2,A_21:.075,A_22:.225,A_31:.3,A_32:-.9,A_33:1.2,A_41:-11/54,A_42:2.5,A_43:-70/27,A_44:35/27,A_51:1631/55296,A_52:175/512,A_53:575/13824,A_54:44275/110592,A_55:253/4096,B4_1:2825/27648,B4_2:0,B4_3:18575/48384,B4_4:13525/55296,B4_5:277/14336,B4_6:.25,B5_1:37/378,B5_2:0,B5_3:250/621,B5_4:125/594,B5_5:0,B5_6:512/1771},EJSS_ODE_SOLVERS.cashKarp45=function(){var e,t,r,n,i,o,a=EJSS_ODE_SOLVERS.solverEngineDiscreteTimeAdaptive(5),s=a.allocateOtherArrays;return a.getNumberOfEvaluations=function(){return 6},a.allocateOtherArrays=function(){s(),e=new Array(a.getDimension()),t=new Array(a.getDimension()),r=new Array(a.getDimension()),n=new Array(a.getDimension()),i=new Array(a.getDimension()),o=new Array(a.getDimension())},a.computeIntermediateStep=function(o,s){var l,u=a.getODE(),g=a.getInitialState(),c=a.getInitialRate(),S=a.getDimension(),d=S-1,f=(c[d],EJSS_ODE_SOLVERS.CashKarp45);for(l=0;l<S;l++)s[l]=g[l]+o*f.A_11*c[l];for(u.getRate(s,e),l=0;l<S;l++)s[l]=g[l]+o*(f.A_21*c[l]+f.A_22*e[l]);for(u.getRate(s,t),l=0;l<S;l++)s[l]=g[l]+o*(f.A_31*c[l]+f.A_32*e[l]+f.A_33*t[l]);for(u.getRate(s,r),l=0;l<S;l++)s[l]=g[l]+o*(f.A_41*c[l]+f.A_42*e[l]+f.A_43*t[l]+f.A_44*r[l]);for(u.getRate(s,n),l=0;l<S;l++)s[l]=g[l]+o*(f.A_51*c[l]+f.A_52*e[l]+f.A_53*t[l]+f.A_54*r[l]+f.A_55*n[l]);for(u.getRate(s,i),l=0;l<d;l++)s[l]=g[l]+o*(f.B5_1*c[l]+f.B5_2*e[l]+f.B5_3*t[l]+f.B5_4*r[l]+f.B5_5*n[l]+f.B5_6*i[l]);s[d]=a.getInitialTime()+o*c[d]},a.computeCarefulIntermediateStep=function(o,s,l){var u,g=a.getODE(),c=a.getInitialState(),S=a.getInitialRate(),d=a.getDimension(),f=d-1,E=(S[f],EJSS_ODE_SOLVERS.CashKarp45),p=EJSS_ODE_SOLVERS.DISCONTINUITY_CODE;for(u=0;u<d;u++)l[u]=c[u]+s*E.A_11*S[u];switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:break;case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,e),u=0;u<d;u++)l[u]=c[u]+s*(E.A_21*S[u]+E.A_22*e[u]);switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:break;case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,t),u=0;u<d;u++)l[u]=c[u]+s*(E.A_31*S[u]+E.A_32*e[u]+E.A_33*t[u]);switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:break;case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,r),u=0;u<d;u++)l[u]=c[u]+s*(E.A_41*S[u]+E.A_42*e[u]+E.A_43*t[u]+E.A_44*r[u]);switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:break;case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,n),u=0;u<d;u++)l[u]=c[u]+s*(E.A_51*S[u]+E.A_52*e[u]+E.A_53*t[u]+E.A_54*r[u]+E.A_55*n[u]);switch(o.checkDiscontinuity(l,!1)){case p.DISCONTINUITY_PRODUCED_ERROR:return p.DISCONTINUITY_PRODUCED_ERROR;case p.DISCONTINUITY_JUST_PASSED:return p.DISCONTINUITY_JUST_PASSED;case p.DISCONTINUITY_ALONG_STEP:return p.DISCONTINUITY_ALONG_STEP;case p.DISCONTINUITY_EXACTLY_ON_STEP:break;case p.NO_DISCONTINUITY_ALONG_STEP:}for(g.getRate(l,i),u=0;u<f;u++)l[u]=c[u]+s*(E.B5_1*S[u]+E.B5_2*e[u]+E.B5_3*t[u]+E.B5_4*r[u]+E.B5_5*n[u]+E.B5_6*i[u]);return l[f]=a.getInitialTime()+s*S[f],o.checkDiscontinuity(l,!0)},a.computeFinalRateAndCreateIntervalData=function(){var e=a.getODE(),t=a.getInitialState(),r=a.getInitialRate(),n=a.getFinalState(),i=a.getFinalRate();return e.getRate(n,i),EJSS_ODE_INTERPOLATION.bootstrap2IntervalData(t,r,n,i,e)},a.computeApproximation=function(s){for(var l=a.getTimeIndex(),u=a.getInitialState(),g=a.getInitialRate(),c=EJSS_ODE_SOLVERS.CashKarp45,S=0;S<l;S++)o[S]=u[S]+s*(c.B4_1*g[S]+c.B4_2*e[S]+c.B4_3*t[S]+c.B4_4*r[S]+c.B4_5*n[S]+c.B4_6*i[S]);return o[l]=a.getInitialTime()+s*g[l],a.computeError(o)},a};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.Euler={},EJSS_ODE_SOLVERS.euler=function(){var e=EJSS_ODE_SOLVERS.solverEngineDiscreteTime();return e.getNumberOfEvaluations=function(){return 1},e.computeIntermediateStep=function(t,r){for(var n=e.getDimension(),i=e.getInitialState(),o=e.getInitialRate(),a=0;a<n;a++)r[a]=i[a]+t*o[a]},e.computeCarefulIntermediateStep=function(t,r,n){return e.computeIntermediateStep(r,n),t.checkDiscontinuity(n,!0)},e.computeFinalRateAndCreateIntervalData=function(){var t=e.getODE(),r=e.getInitialState(),n=e.getInitialRate(),i=e.getFinalState(),o=e.getFinalRate();return t.getRate(i,o),EJSS_ODE_INTERPOLATION.eulerIntervalData(r,n,i[e.getTimeIndex()])},e};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.Radau5={c1:(4-Math.sqrt(6))/10,c2:(4+Math.sqrt(6))/10,c1m1:(4-Math.sqrt(6))/10-1,c2m1:(4+Math.sqrt(6))/10-1,c1mc2:(4-Math.sqrt(6))/10-(4+Math.sqrt(6))/10};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.RungeKutta4={},EJSS_ODE_SOLVERS.rungeKutta4=function(){var e,t,r,n=EJSS_ODE_SOLVERS.solverEngineDiscreteTime();return n.getNumberOfEvaluations=function(){return 4},n.allocateOtherArrays=function(){e=new Array(n.getDimension()),t=new Array(n.getDimension()),r=new Array(n.getDimension())},n.computeIntermediateStep=function(i,o){var a,s=i/2,l=n.getODE(),u=n.getInitialState(),g=n.getInitialRate(),c=n.getDimension(),S=c-1,d=g[S];for(a=0;a<c;a++)o[a]=u[a]+s*g[a];for(l.getRate(o,e),a=0;a<c;a++)o[a]=u[a]+s*e[a];for(l.getRate(o,t),a=0;a<c;a++)o[a]=u[a]+i*t[a];for(l.getRate(o,r),a=0;a<S;a++)o[a]=u[a]+i*(g[a]+2*e[a]+2*t[a]+r[a])/6;o[S]=n.getInitialTime()+i*d},n.computeCarefulIntermediateStep=function(i,o,a){var s,l=o/2,u=n.getODE(),g=n.getInitialState(),c=n.getInitialRate(),S=n.getDimension(),d=S-1,f=c[d],E=EJSS_ODE_SOLVERS.DISCONTINUITY_CODE;for(s=0;s<S;s++)a[s]=g[s]+l*c[s];switch(i.checkDiscontinuity(a,!1)){case E.DISCONTINUITY_PRODUCED_ERROR:return E.DISCONTINUITY_PRODUCED_ERROR;case E.DISCONTINUITY_JUST_PASSED:return E.DISCONTINUITY_JUST_PASSED;case E.DISCONTINUITY_ALONG_STEP:return E.DISCONTINUITY_ALONG_STEP;case E.DISCONTINUITY_EXACTLY_ON_STEP:break;case E.NO_DISCONTINUITY_ALONG_STEP:}for(u.getRate(a,e),s=0;s<S;s++)a[s]=g[s]+l*e[s];switch(i.checkDiscontinuity(a,!1)){case E.DISCONTINUITY_PRODUCED_ERROR:return E.DISCONTINUITY_PRODUCED_ERROR;case E.DISCONTINUITY_JUST_PASSED:return E.DISCONTINUITY_JUST_PASSED;case E.DISCONTINUITY_ALONG_STEP:return E.DISCONTINUITY_ALONG_STEP;case E.DISCONTINUITY_EXACTLY_ON_STEP:break;case E.NO_DISCONTINUITY_ALONG_STEP:}for(u.getRate(a,t),s=0;s<S;s++)a[s]=g[s]+o*t[s];switch(i.checkDiscontinuity(a,!1)){case E.DISCONTINUITY_PRODUCED_ERROR:return E.DISCONTINUITY_PRODUCED_ERROR;case E.DISCONTINUITY_JUST_PASSED:return E.DISCONTINUITY_JUST_PASSED;case E.DISCONTINUITY_ALONG_STEP:return E.DISCONTINUITY_ALONG_STEP;case E.DISCONTINUITY_EXACTLY_ON_STEP:break;case E.NO_DISCONTINUITY_ALONG_STEP:}for(u.getRate(a,r),s=0;s<d;s++)a[s]=g[s]+o*(c[s]+2*e[s]+2*t[s]+r[s])/6;return a[d]=n.getInitialTime()+o*f,i.checkDiscontinuity(a,!0)},n.computeFinalRateAndCreateIntervalData=function(){var e=n.getODE(),t=n.getInitialState(),r=n.getInitialRate(),i=n.getFinalState(),o=n.getFinalRate();return e.getRate(i,o),EJSS_ODE_INTERPOLATION.bootstrapIntervalData(t,r,i,o,e)},n};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.SolverEngineDiscreteTime={},EJSS_ODE_SOLVERS.solverEngineDiscreteTime=function(){var e,t,r,n,i,o,a,s,l,u={},g=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,c=0,S=.1,d=Number.POSITIVE_INFINITY,f=0,E=0;return u.getNumberOfEvaluations=function(){return 0},u.allocateOtherArrays=function(){},u.computeIntermediateStep=function(e,t){return null},u.computeCarefulIntermediateStep=function(e,t,r){return EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP},u.computeFinalRateAndCreateIntervalData=function(){return null},u.getODE=function(){return a},u.getEventSolver=function(){return s},u.getDimension=function(){return e},u.getTimeIndex=function(){return t},u.getInitialTime=function(){return f},u.getInitialState=function(){return r},u.getInitialRate=function(){return n},u.getFinalState=function(){return i},u.getFinalRate=function(){return o},u.setFinalTime=function(e){E=e},u.getFinalTime=function(){return E},u.setErrorCode=function(e){g=e},u.addToEvaluations=function(e){c+=e},u.setODE=function(r,n){s=r,a=n;var i=a.getState();e=i.length,t=e-1,l=EJSS_ODE_INTERPOLATION.stateHistory(n),a.getMaximumDelay&&l.setMinimumLength(a.getMaximumDelay())},u.initialize=function(s){S=s;var g=a.getState();null!=r&&r.length==g.length||(e=g.length,t=e-1,r=new Array(e),n=new Array(e),i=new Array(e),o=new Array(e),u.allocateOtherArrays()),c=0,l.clearAll(),a.getMaximumDelay?l.setMinimumLength(Math.max(Math.abs(a.getMaximumDelay()),Math.abs(s))):l.setMinimumLength(s),u.reinitialize(g)},u.reinitialize=function(i){f=i[t];for(var o=0;o<e;o++)r[o]=i[o];a.getRate(r,n),E=Number.NaN,g=EJSS_ODE_SOLVERS.ERROR.NO_ERROR},u.getCurrentRate=function(){return n},u.setStepSize=function(e){S=e,a.getMaximumDelay?l.setMinimumLength(Math.max(Math.abs(a.getMaximumDelay()),Math.abs(e))):l.setMinimumLength(e)},u.setMaximumStepSize=function(e){d=Math.abs(e)},u.getMaximumStepSize=function(){return d},u.getStepSize=function(){return S},u.getInternalStepSize=function(){return E-f},u.setEstimateFirstStep=function(e){},u.setTolerances=function(e,t){},u.getMaximumTime=function(e){return g!=EJSS_ODE_SOLVERS.ERROR.NO_ERROR?Number.NaN:(isNaN(E)&&u.computeOneStep(e),E)},u.internalStep=function(t){var a;for(f=E,g=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,a=0;a<e;a++)r[a]=i[a];for(a=0;a<e;a++)n[a]=o[a];return u.computeOneStep(t),E},u.getCounter=function(){return c},u.getStateHistory=function(){return l},u.interpolate=function(e,t){return l.interpolateState(e,t)},u.bestInterpolate=function(t,n){var o;if(isNaN(E))return null;if(t==E){for(o=0;o<e;o++)n[o]=i[o];return n}if(t==f){for(o=0;o<e;o++)n[o]=r[o];return n}return u.computeIntermediateStep(t-f,n),n},u.getActualStepSize=function(){return S},u.findTheDiscontinuity=function(e){for(var r=0,n=0,o=e,a=0,l=s.getDDEIterations(),g=s.getEPSILON();r<l&&!(Math.abs(n-o)<g);){var c=(n+o)/2;switch(u.computeCarefulIntermediateStep(s,c,i)){default:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR:return Number.NaN;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP:a=i[t],n=c;break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP:return i[t];case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED:o-=(o-n)/4;break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP:o=c}r++}return u.computeCarefulIntermediateStep(s,a,i),a},u.computeOneStep=function(e){var r=S;if(e){switch(u.computeCarefulIntermediateStep(s,r,i)){case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR:return void(E=Number.NaN);case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP:E=i[t];break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP:E=u.findTheDiscontinuity(r)}if(isNaN(E))return void(g=EJSS_ODE_SOLVERS.ERROR.DISCONTINUITY_PRODUCED_ERROR)}else u.computeIntermediateStep(r,i),E=i[t];c+=u.getNumberOfEvaluations(),l.clean(f),l.addIntervalData(u.computeFinalRateAndCreateIntervalData())},u};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive={FAC1:.33,FAC2:6,BETA:0,SAFE:.9},EJSS_ODE_SOLVERS.solverEngineDiscreteTimeAdaptive=function(e){function t(e){var t=0;return 0!=e?(t=Math.pow(e,l),g=t/Math.exp(EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.BETA*Math.log(u)),g=Math.max(1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC2,Math.min(1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC1,g/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.SAFE))):(t=1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC1,g=1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC2),e<=1?(u=Math.max(e,1e-4),i/g):i/Math.min(1/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.FAC1,t/EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.SAFE)}function r(e){var t,r,n,i=s.getODE();if(e>=0){if(i.getDelays)for(t=i.getDelays(s.getInitialState()),n=t.length,r=0;r<n;r++)e=Math.min(e,t[r]/2);return Math.min(e,s.getMaximumStepSize())}if(i.getDelays)for(t=i.getDelays(s.getInitialState()),n=t.length,r=0;r<n;r++)e=Math.max(e,t[r]/2);return Math.max(e,-s.getMaximumStepSize())}function n(t){var r,n=s.getDimension(),i=s.getInitialState(),l=s.getInitialRate(),u=s.getODE(),g=t<0?-1:1;t=Math.abs(t);var c=0,S=0;for(r=0;r<n;r++){var d=o[r]+a[r]*Math.abs(i[r]),f=l[r]/d;c+=f*f,f=i[r]/d,S+=f*f}var E;if(E=c<=1e-10||S<=1e-10?1e-6:.01*Math.sqrt(S/c),E=g*Math.min(E,t),u.getDelays){var p=s.getEventSolver();p.resetDiscontinuities(i);for(var h=0,m=!1;!m;){for(r=0;r<n;r++)finalState[r]=i[r]+E*l[r];switch(p.checkDiscontinuity(finalState,!1)){case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR:return Number.NaN;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP:E/=2;break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP:m=!0;break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP:m=!0}if(++h>100)return Number.NaN}}else for(r=0;r<n;r++)finalState[r]=i[r]+E*l[r];u.getRate(finalState,finalRate);var A=0;for(r=0;r<n;r++){var d=o[r]+a[r]*Math.abs(i[r]),f=(finalRate[r]-l[r])/d;A+=f*f}A=Math.sqrt(A)/E;var y,v=Math.max(Math.abs(A),Math.sqrt(c));return y=v<=1e-15?Math.max(1e-6,.001*Math.abs(E)):Math.exp(1/e*Math.log(.01/v)),E=g*Math.min(100*E,y),0!=t&&(E=g*Math.min(Math.abs(E),t)),E}var i,o,a,s=EJSS_ODE_SOLVERS.solverEngineDiscreteTime(),l=1/e-.75*EJSS_ODE_SOLVERS.SolverEngineDiscreteTimeAdaptive.BETA,u=1e-4,g=0,c=!1,S=Number.NaN,d=Number.NaN,f=s.reinitialize,E=s.setMaximumStepSize;return s.computeApproximation=function(e){},s.getAbsTol=function(){return o},s.getRelTol=function(){return a},s.allocateOtherArrays=function(){var e=s.getDimension();o=new Array(e),a=new Array(e),s.setTolerances(1e-6,1e-6)},s.reinitialize=function(e){f(e),i=r(c?n(s.getStepSize()):s.getStepSize())},s.setEstimateFirstStep=function(e){c=e},s.setMaximumStepSize=function(e){E(e),i=r(i)},s.setTolerances=function(e,t){var l,u=s.getDimension();if(e instanceof Array)for(S=d=Number.NaN,l=0;l<u;l++)o[l]=e[l],a[l]=t[l];else{if(S==e&&d==t)return;for(S=e,d=t,l=0;l<u;l++)o[l]=e,a[l]=t}mFinalTime=Number.NaN,mErrorCode=EJSS_ODE_SOLVERS.ERROR.NO_ERROR,i=r(c?n(s.getStepSize()):s.getStepSize())},s.computeOneStep=function(e){var n=s.getEventSolver(),o=s.getFinalState();mErrorCode=EJSS_ODE_SOLVERS.ERROR.NO_ERROR;for(var a=0;a<500;a++){if(e){switch(s.computeCarefulIntermediateStep(n,i,o)){case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_PRODUCED_ERROR:return void s.setFinalTime(Number.NaN);case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.NO_DISCONTINUITY_ALONG_STEP:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_EXACTLY_ON_STEP:s.setFinalTime(o[s.getTimeIndex()]);break;case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_JUST_PASSED:case EJSS_ODE_SOLVERS.DISCONTINUITY_CODE.DISCONTINUITY_ALONG_STEP:var l=s.findTheDiscontinuity(i);s.setFinalTime(l),i=l-s.getInitialTime()}if(isNaN(s.getFinalTime()))return void s.setErrorCode(EJSS_ODE_SOLVERS.ERROR.DISCONTINUITY_PRODUCED_ERROR)}else s.computeIntermediateStep(i,o),s.setFinalTime(o[s.getTimeIndex()]);var u=s.computeApproximation(i);if(s.addToEvaluations(s.getNumberOfEvaluations()),u<=1)return s.getStateHistory().clean(s.getInitialTime()),s.getStateHistory().addIntervalData(s.computeFinalRateAndCreateIntervalData()),void(i=r(a>0?i>0?Math.min(i,t(u)):Math.max(i,t(u)):t(u)));i=r(i>0?Math.min(i,t(u)):Math.max(i,t(u)))}s.setFinalTime(Number.NaN),s.setErrorCode(EJSS_ODE_SOLVERS.ERROR.DID_NOT_CONVERGE)},s.getActualStepSize=function(){return i},s.computeError=function(e){for(var t=0,r=s.getDimension(),n=s.getInitialState(),i=s.getFinalState(),l=0;l<r;l++){var u=o[l]+a[l]*Math.max(Math.abs(i[l]),Math.abs(n[l])),g=(i[l]-e[l])/u;t+=g*g}return Math.sqrt(t/r)},s};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.DDEDiscontinuity={},EJSS_ODE_SOLVERS.ddeDiscontinuity=function(e,t){function r(r){var n,s=t.getDelays(r),l=s.length,u=o.length,g=r.length-1;if(e.getRunsForwards())for(n=0;n<l;n++)for(var c=r[g]-s[n]+i.getTolerance(),S=a[n];S<u;S++){var d=o[S];if(d>c){a[n]=S;break}}else for(n=0;n<l;n++)for(var c=r[g]-s[n]-i.getTolerance(),S=a[n];S<u;S++){var d=o[S];if(d<c){a[n]=S;break}}}function n(r){var n,o=r.length,a=o-1,l=i.getTolerance()/20,u=e.getDDEIterations(),g=e.getStateHistory(),c=0;if(e.getRunsForwards())for(;++c<u;){for(t.getRate(r,s),g.addIntervalData(EJSS_ODE_INTERPOLATION.eulerIntervalData(r,s,r[a]+l)),n=0;n<o;n++)r[n]+=l*s[n];var S=i.evaluate(r);if(S<0)return r[a]}else for(;++c<u;){for(t.getRate(r,s),g.addIntervalData(EJSS_ODE_INTERPOLATION.eulerIntervalData(r,s,r[a]-l)),n=0;n<o;n++)r[n]-=l*s[n];var S=evaluate(r);if(S>0)return r[a]}return Number.NaN}var i={},o=[],a=[],s=[];return i.initialize=function(r){e.getRunsForwards()?o.push(Number.NEGATIVE_INFINITY):o.push(Number.POSITIVE_INFINITY);var n=t.getInitialConditionDiscontinuities();if(null!=n)for(var l=n.length,u=0;u<l;u++)o.push(n[u]);o.push(r[r.length-1]);var g=t.getDelays(r);a=new Array(g.length),i.reset(r),s=new Array(r.length)},i.reset=function(e){for(var t=a.length,n=0;n<t;n++)a[n]=0;r(e)},i.evaluate=function(r){var n,i=r[r.length-1],s=t.getDelays(r),l=s.length;if(e.getRunsForwards()){var u=Number.POSITIVE_INFINITY;for(n=0;n<l;n++){var g=o[a[n]];u=Math.min(u,s[n]+g-i)}return u}var c=Number.NEGATIVE_INFINITY;for(n=0;n<l;n++){var g=o[a[n]];c=Math.max(c,s[n]+g-i)}return c},i.action=function(){var r=t.getState(),i=n(r);o.push(i);var a=e.findFirstEvent(r,i,r);return null!=a&&(mCurrentEventData=a,a.action()),!0},i.getTolerance=function(){return e.getDDETolerance()},i};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.ProblemData={POSITIVE:2,SMALL_POSITIVE:1,ZERO:0,SMALL_NEGATIVE:-1,NEGATIVE:-2},EJSS_ODE_SOLVERS.eventData=function(e,t,r){var n,i,o,a,s,l,u,g,c={},S=t.getTypeOfEvent(),d=r.length-1;return c.getEvent=function(){return t},c.getEventType=function(){return S},c.setH=function(e){l=e},c.getH=function(){return l},c.getTime=function(){return u},c.setTime=function(e){u=e},c.hasPositiveFlag=function(){return n},c.hasNegativeFlag=function(){return i},c.getHBefore=function(){return a},c.setHAfter=function(e){s=e},c.getHAfter=function(){return s},c.getCurrentPosition=function(){return o},c.getMaxAdvance=function(){return g},c.setMaxAdvance=function(e){g=e},c.action=function(){return t.action()},c.getProblem=function(){return t},c.reset=function(r){n=!1,i=!1;var o=t.evaluate(r);c.findPosition(r[d],o),e.getCurrentEventData()!=c&&(S==EJSS_ODE_SOLVERS.EVENT_TYPE.CROSSING_EVENT?o>0?n=!0:o<0&&(i=!0):S==EJSS_ODE_SOLVERS.EVENT_TYPE.POSITIVE_EVENT&&o>0&&(n=!0))},c.findPosition=function(r,s){if(a=s,a>=t.getTolerance()?(o=EJSS_ODE_SOLVERS.ProblemData.POSITIVE,n=!0):a>0?o=EJSS_ODE_SOLVERS.ProblemData.SMALL_POSITIVE:0==a?o=EJSS_ODE_SOLVERS.ProblemData.ZERO:a>-t.getTolerance()?o=EJSS_ODE_SOLVERS.ProblemData.SMALL_NEGATIVE:(o=EJSS_ODE_SOLVERS.ProblemData.NEGATIVE,i=!0),S==EJSS_ODE_SOLVERS.EVENT_TYPE.STATE_EVENT&&o==EJSS_ODE_SOLVERS.ProblemData.NEGATIVE){var l="The state event "+t+" is in an illegal state: "+a+" at "+r;l+=null==e.getLastEventData()?"\nThere was no previous event":"\nLast previous event was "+e.getLastEventData().getProblem()+", which took place at "+e.getLastEventDataTime(),e.error(EJSS_ODE_SOLVERS.ERROR.ILLEGAL_EVENT_STATE,l)}},c.reset(r),c},EJSS_ODE_SOLVERS.discontinuityData=function(e,t,r){var n,i,o,a,s,l,u={},g=r.length-1;return u.getDiscontinuity=function(){return t},u.setH=function(e){s=e},u.getH=function(){return s},u.setTime=function(e){l=e},u.getTime=function(){return l},u.hasPositiveFlag=function(){return n},u.hasNegativeFlag=function(){return i},u.getHBefore=function(){return a},u.setHAfter=function(e){mHAfter=e},u.getHAfter=function(){return mHAfter},u.getCurrentPosition=function(){return o},u.getMaxAdvance=function(){return Number.NaN},u.action=function(){return t.action()},u.getProblem=function(){return t},u.reset=function(r){n=!1,i=!1;var o=t.evaluate(r);u.findPosition(r[g],o),e.getCurrentEventData()!=u&&(o>0?n=!0:o<0&&(i=!0))},u.findPosition=function(e,r){a=r,a>=t.getTolerance()?(o=EJSS_ODE_SOLVERS.ProblemData.POSITIVE,n=!0):a>0?o=EJSS_ODE_SOLVERS.ProblemData.SMALL_POSITIVE:0==a?o=EJSS_ODE_SOLVERS.ProblemData.ZERO:a>-t.getTolerance()?o=EJSS_ODE_SOLVERS.ProblemData.SMALL_NEGATIVE:(o=EJSS_ODE_SOLVERS.ProblemData.NEGATIVE,i=!0)},u.reset(r),u};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.ODEMultistepSolver={NO_ERROR:0,DID_NOT_CONVERGE:1},EJSS_ODE_SOLVERS.createODEMultistepSolver=function(e){function t(){var e=g.getTolerance(),t=l;(g.getStepSize()<=0||g.getStepSize()>l||l-g.getStepSize()==l)&&g.setStepSize(l);for(var r=0;t>e*l;){r++;var n=t;if(t<g.getStepSize()){var u=g.getStepSize();g.setStepSize(t);var c=g.step();t-=c,g.setStepSize(u)}else t-=g.step();if(g.getErrorCode()!=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR||Math.abs(n-t)<=Number.MIN_VALUE||e*l/10>g.getStepSize()||r>o){if(s="ODEMultiStep did not converge. Remainder="+t,i=EJSS_ODE_SOLVERS.ODEMultistepSolver.DID_NOT_CONVERGE,a)throw s;mMaxMessages>0&&(mMaxMessages--,console.log(s));break}}return t}function r(){var e=g.getTolerance(),t=l;(g.getStepSize()>=0||g.getStepSize()<l||l-g.getStepSize()==l)&&g.setStepSize(l);for(var r=0;t<e*l;){r++;var n=t;if(t>g.getStepSize()){var a=g.getStepSize();g.setStepSize(t);var u=g.step();t-=u,g.setStepSize(a)}else t-=g.step();if(g.getErrorCode()!=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR||Math.abs(n-t)<=Number.MIN_VALUE||e*l/10<g.getStepSize()||r>o){if(s="ODEMultiStep did not converge. Remainder="+t,i=EJSS_ODE_SOLVERS.ODEMultistepSolver.DID_NOT_CONVERGE,enableExceptions)throw s;mMaxMessages>0&&(mMaxMessages--,console.log(s))}}return t}var n={},i=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,o=200,a=!1,s="",l=.1,u=EJSS_ODE_SOLVERS.createODEMultistepSolverInternalODE(e),g=EJSS_ODE_SOLVERS.createCashKarp45(u);return n.enableRuntimeExceptions=function(e){a=e},n.setMaxIterations=function(e){o=Math.max(1,e)},n.setTolerance=function(e){e=Math.abs(e),g.setTolerance(e)},n.getTolerance=function(){return g.getTolerance()},n.getErrorCode=function(){return i},n.initialize=function(e){mMaxMessages=4,s="",i=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,l=e,u.setInitialConditions(),g.initialize(e)},n.setStepSize=function(e){mMaxMessages=4,l=e,e<0?g.setStepSize(Math.max(-Math.abs(g.getStepSize()),e)):g.setStepSize(Math.min(g.getStepSize(),e))},n.setMaximumNumberOfErrorMessages=function(e){mMaxMessages=e},n.getStepSize=function(){return l},n.step=function(){i=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,u.setInitialConditions();var e=0;return e=l>0?t():r(),u.update(),l-e},n},EJSS_ODE_SOLVERS.createODEMultistepSolverInternalODE=function(e){var t={},r=[];return t.getRate=function(t,r){e.getRate(t,r)},t.getState=function(){return r},t.setInitialConditions=function(){var t=e.getState();if(null!=t){null!=r&&r.length==t.length||(r=new Array(t.length));for(var n=0,i=t.length;n<i;n++)r[n]=t[n]}},t.update=function(){for(var t=e.getState(),n=0,i=t.length;n<i;n++)t[n]=r[n]},t.setInitialConditions(),t},EJSS_ODE_SOLVERS.createCashKarp45=function(e){var t,r={},n=[[.2],[.075,.225],[.3,-.9,1.2],[-11/54,2.5,-70/27,35/27],[1631/55296,175/512,575/13824,44275/110592,253/4096]],i=[37/378,0,250/621,125/594,0,512/1771],o=[277/64512,0,-6925/370944,6925/202752,277/14336,-277/7084],a=6,s=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,l=.01,u=0,g=[],c=[],S=1e-6,d=!1;return r.enableRuntimeExpecptions=function(e){d=e},r.setStepSize=function(e){l=e},r.getStepSize=function(){return l},r.setTolerance=function(e){if(S=Math.abs(e),S<1e-12){var t="Error: Cash-Karp ODE solver tolerance cannot be smaller than 1.0e-12.";if(d)throw t;console.log(t),S=1e-12}},r.getTolerance=function(){return S},r.getErrorCode=function(){return s},r.initialize=function(t){l=t;var r=e.getState();if(null!=r&&u!=r.length){u=r.length,g=new Array(u),c=new Array(a);for(var n=0;n<a;n++)c[n]=new Array(u)}},r.step=function(){var r,f,E,p=10,h=l,m=0,A=e.getState();s=EJSS_ODE_SOLVERS.ODEMultistepSolver.NO_ERROR,e.getRate(A,c[0]);do{for(p--,h=l,E=1;E<a;E++){for(r=0;r<u;r++)for(g[r]=A[r],f=0;f<E;f++)g[r]=g[r]+l*n[E-1][f]*c[f][r];e.getRate(g,c[E])}for(m=0,r=0;r<u;r++){for(t=0,E=0;E<a;E++)t+=l*o[E]*c[E][r];m=Math.max(m,Math.abs(t))}if(m<=Number.MIN_VALUE&&(m=S/1e5),m>S){var y=.9*Math.pow(m/S,-.25);l*=Math.max(y,.1)}else if(m<S/10){var y=.9*Math.pow(m/S,-.2);y>1&&(l*=Math.min(y,10))}}while(m>S&&p>0);for(r=0;r<u;r++)for(E=0;E<a;E++)A[r]+=h*i[E]*c[E][r];if(0==p&&(s=EJSS_ODE_SOLVERS.ODEMultistepSolver.DID_NOT_CONVERGE,d))throw"DormanPrince45 ODE solver did not converge.";return h},r.initialize(l),r};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.createEulerODESolver=function(e){var t,r=EJSS_ODE_SOLVERS.createSolverInterpolatorDiscreteTime(e),n=r.initialize;return r.initialize=function(e){n(e),t=new Array(r.getDimension())},r.computeIntermediateStep=function(r,n){e.getRate(n,t);for(var i=0,o=n.length;i<o;i++)n[i]=n[i]+r*t[i];return n},r};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.createRungeKutta4ODESolver=function(e){var t,r,n,i,o,a=EJSS_ODE_SOLVERS.createSolverInterpolatorDiscreteTime(e),s=a.initialize;return a.initialize=function(e){s(e),t=new Array(a.getDimension()),r=new Array(a.getDimension()),n=new Array(a.getDimension()),i=new Array(a.getDimension()),o=new Array(a.getDimension())},a.computeIntermediateStep=function(a,s){e.getRate(s,r);for(var l=0,u=s.length;l<u;l++)t[l]=s[l],s[l]=t[l]+a*r[l]/2;e.getRate(s,n);for(var l=0,u=s.length;l<u;l++)s[l]=t[l]+a*n[l]/2;e.getRate(s,i);for(var l=0,u=s.length;l<u;l++)s[l]=t[l]+a*i[l];e.getRate(s,o);for(var l=0,u=s.length;l<u;l++)s[l]=t[l]+a*(r[l]+2*n[l]+2*i[l]+o[l])/6;return s},a};var EJSS_ODE_SOLVERS=EJSS_ODE_SOLVERS||{};EJSS_ODE_SOLVERS.SolverInterpolatorDiscreteTime={},EJSS_ODE_SOLVERS.createSolverInterpolatorDiscreteTime=function(e){var t,r={},n=.1,i=(Number.POSITIVE_INFINITY,0);return r.getNumberOfEvaluations=function(){return 0},r.allocateOtherArrays=function(){},r.computeIntermediateStep=function(e,t){return null},r.computeCarefulIntermediateStep=function(e,t,r){return 0},r.setTolerance=function(e){i=Math.abs(e)},r.getDimension=function(){return t},r.initialize=function(r){n=r;var i=e.getState();t=i.length},r.step=function(){var t=e.getState();return r.computeIntermediateStep(n,t),0},r.setStepSize=function(e){n=e},r.getStepSize=function(){return n},r};var EJSS_CORE=EJSS_CORE||{};EJSS_CORE.createRemoteView=function(e,t,r,n){function i(e,t){if(c){void 0!==t?s.send(e+JSON.stringify(t)):s.send(e);var r=s.onmessage;s.onmessage=null,s.onmessage=r}}function o(e){var t;switch(e.charAt(0)){case"R":l._reset();break;case"I":l._initialize();break;case"U":d=JSON.parse(e.substring(1)),a(l._update);break;case"C":d=JSON.parse(e.substring(1)),a(l._collectData);break;case"M":t=JSON.parse(e.substring(1)),l[t.method]&&console.log("View function: <"+t.method+"> with data: <"+t.data+"> ignored. View function does not exist."),l[t.method](t.data);break;case"P":t=JSON.parse(e.substring(1)),l[t.element]?l[t.element].setProperty(t.property,t.value):console.log("setProperty<"+t.property+"> with value: <"+t.value+"> to element <"+t.element+"> ignored. Element does not exist!");break;case"E":t=JSON.parse(e.substring(1)),l[t.element]?l[t.element][t.method](t.data):console.log("Message <"+t.method+"> to element <"+t.element+"> ignored. Element does not exist!");break;case"F":t=JSON.parse(e.substring(1)),l[t.element]?l[t.element][t.method](t.data):console.log("Message with object <"+t.method+"> to element <"+t.element+"> ignored. Element does not exist!");break;default:console.log("view process input error : Unrecognised command: "+e)}}function a(e){e(),l._render(),i("O")}var s,l=EJSS_CORE.createView(e),u=10,g=500,c=!1,S=0,d={},f=[],E=[],p=[],h=[],m="",A=!0,y=0,v="";if(l._23=function(){return"ConnectionWS"},l._connectToServer=function(){try{s=new WebSocket(v),console.log("Connecting... (readyState "+s.readyState+")"),s.onopen=function(e){c=!0,S=0,console.log("Openhd Event: "+e.type+" - Message: "+e.data),i("A",{variables:f,actions:E})},s.onclose=function(e){S<u&&(window.setTimeout(function(){l._connectToServer()},g),S++),c=!1,console.log("Closehd Event: "+e.type+" - Message: "+e.data+" - Reopen: "+S)},s.onerror=function(e){c=!1,console.log("Errorhd Event: "+e.type+" - Message: "+e.data)},s.onmessage=function(e){o(e.data)}}catch(e){console.log(e)}l._update(),l._render()},l._getValue=function(e){return c?d[e]:l._10(e)},super_registerVariable=l._5,super_registerAction=l._7,super_startUp=l._11,l._11=function(){super_startUp(),l._connectToServer()},l._5=function(e,t,r){super_registerVariable(e,t),r?l._13(e,function(){return l._getValue(e)},null,t):(f.push(e),l._13(e,function(){return l._getValue(e)},function(t){p.push({name:e,value:t})},t))},l._7=function(e){super_registerAction(e),E.push(e),l._setAction(e,function(t){h.push({name:e,argument:t})})},l._18=function(){l._16(),i("I",{properties:p,actions:h}),p=[],h=[]},l._17=function(){return h.length},l.getLinkingURL=function(){return m},l.createLinkingButtons=function(){l._9(EJSS_INTERFACE.button,"_linkingButton_").setAction("OnClick",function(){var e=l.getLinkingURL();window.alert(e.toString())}).setProperties({Text:"@",FontSize:"8px"}),l._9(EJSS_INTERFACE.button,"_qrButton_").setAction("OnClick",function(){var e=encodeURIComponent(l.getLinkingURL()),t="https://chart.googleapis.com/chart?cht=qr&chl="+e+"&chs=400";window.open(t,"_blank")}).setProperties({Text:"QR",FontSize:"8px"})},l.hiddenLinkingButtons=function(){_view._linkingButton_.setVisibility("hidden"),_view._qrButton_.setVisibility("hidden")},l.showLinkingButtons=function(){_view._linkingButton_.setVisibility("visible"),_view._qrButton_.setVisibility("visible")},window.location.protocol.indexOf("file")!=-1)"undefined"!=typeof t&&null!==t&&0!=t||(t=8800),v="ws://localhost:"+t,A=!1;else{if(history.state&&(y=history.state.mServerModelPort,A=!1),"undefined"==typeof r||null===r||""==r){var P=window.location.host,D=window.location.protocol;r=D+"//"+P+"/ejsS_library/models"}if("undefined"==typeof n||null===n||""==n){var I=window.location.href.lastIndexOf("/_view");n=window.location.href.slice(r.length,I)}var _=new XMLHttpRequest;y>0?_.open("GET",r+"/broker.php?model="+n+"&port="+y,!0):_.open("GET",r+"/broker.php?model="+n,!0),_.onreadystatechange=function(){if(4==_.readyState&&200==_.status){var e=JSON.parse(_.responseText);v=e.webserver,m=r+"/linking.php?model="+n+"&port="+e.port,A&&l.createLinkingButtons(),
l._11()}else console.log("WARNING: server no response!")},_.send()}return l};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.addToArray=function(e,t,r){EJSS_TOOLS.removeFromArray(e,t),r>=0?e.splice(r,0,t):e.push(t)},EJSS_TOOLS.arrayObjectIndexOf=function(e,t){return e.indexOf(t)},EJSS_TOOLS.removeFromArray=function(e,t){var r=e.indexOf(t);r>=0&&e.splice(r,1)},EJSS_TOOLS.compareArrays=function(e,t){if(!e||!t)return!1;if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]instanceof Array&&t[r]instanceof Array){if(!EJSS_TOOLS.compareArrays(e[r],t[r]))return!1}else if(e[r]!=t[r])return!1;return!0};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.ConnectionWS={},EJSS_TOOLS.connectionWS=function(e){function t(){try{s=new WebSocket(e),console.log("Connecting... (readyState "+s.readyState+")")}catch(e){console.log(e)}}function r(e,t){switch(e){case"onopen":s.onopen=function(e){t(e)};break;case"onmessage":s.onmessage=function(e){t(e)};break;case"onclose":s.onclose=function(e){t(e)};break;case"onerror":s.onerror=function(e){t(e)}}}function n(e){var t=e.data.split(" ");g[t[0]]=e.data.substring(t[0].length+1)}function i(e){l=!0,console.log("Openhd Event: "+e.type+" - Message: "+e.data)}function o(e){l=!1,console.log("Closehd Event: "+e.type+" - Message: "+e.data)}function a(e){l=!1,console.log("Errorhd Event: "+e.type+" - Message: "+e.data)}var s,l,u={},g={};return u._23=function(){return"ConnectionWS"},u.get=function(e){var t=g[e];if("undefined"!=typeof t||null==t)return t},u.set=function(e,t){if(console.log("set:"+e+":"+t.toString()),console.log("set:is open="+l),l){var r=e+" "+t.toString();s.send(r),u.reset()}},u.reset=function(){var e=s.onmessage;s.onmessage=null,s.onmessage=e},t(),r("onopen",i),r("onclose",o),r("onerror",a),r("onmessage",n),u};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.DisplayColors={phaseColors:{},lineColors:["rgb(255,0,0)","rgb(0,240,0)","rgb(0,0,255)","rgb(240,240,0)","rgb(0,240,240)","rgb(255,0,255)"],markerColors:["rgb(255,0,0)","rgb(0,240,0)","rgb(0,0,255)","rgb(240,240,0)","rgb(0,240,240)","rgb(255,0,255)"],arrayColors:{black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,160],darkcyan:[0,240,240],darkgray:[64,64,64],darkgreen:[0,240,0],darkgrey:[64,64,64],darkyellow:[240,240,0],gray:[125,125,125],green:[0,255,0],grey:[125,125,125],lightblue:[173,216,230],lightgray:[192,192,192],lightgrey:[192,192,192],magenta:[255,0,255],maroon:[128,0,0],olive:[128,128,0],orange:[255,165,0],pink:[255,175,175],purple:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]},getLineColor:function(e){var t=EJSS_TOOLS.DisplayColors.lineColors[e];if(void 0===t){var r=360*e/12%360;t="hsl("+r+",100%,50%)",EJSS_TOOLS.DisplayColors.lineColors[e]=t}return t},getMarkerColor:function(e){var t=EJSS_TOOLS.DisplayColors.markerColors[e];if(void 0===t){var r=360*e/12%360;t="hsl("+r+",100%,100%)",EJSS_TOOLS.DisplayColors.markerColors[e]=t}return t},getArrayColor:function(e){if(e=e.toLowerCase(),0==e.indexOf("rgb"))var t=e.substring(4,e.length-1).replace(/ /g,"").split(",");else if(0==e.indexOf("#")){e=e.slice(1),e=e.toUpperCase();for(var r,n,i="0123456789ABCDEF",t=new Array(3),o=0,a=0;a<6;a+=2)r=i.indexOf(e.charAt(a)),n=i.indexOf(e.charAt(a+1)),t[o]=16*r+n,o++}else{var t=EJSS_TOOLS.DisplayColors.arrayColors[e];void 0===t&&(t=EJSS_TOOLS.DisplayColors.arrayColors.black)}return[t[0]/255,t[1]/255,t[2]/255]}};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.Worker=function(){function e(e,t){if(e){var r=new XMLHttpRequest;r.open("GET",e),r.onreadystatechange=function(){4==r.readyState&&200==r.status?t(r.responseText):console.log("Warning: impossible to read "+e)},r.send()}else t("")}var t={};if("undefined"==typeof Worker)return t;if(!window.Worker)return t;if(!window.URL)return t;if(window.navigator.userAgent.indexOf("MSIE ")>0||window.navigator.userAgent.indexOf("Trident")>0)return t;t.dummy=function(e){var e=e.data.params;t.postMessage({result:"dummy"})};var r=new Blob(['onmessage=function (oEvent) { \t\tpostMessage({ \t\t\t"id": oEvent.data.id, \t\t\t"evaluated": eval(oEvent.data.code) \t\t}); \t}   '],{type:"text/javascript"}),n=window.URL.createObjectURL(r),i=[],o=new Worker(n);o.onmessage=function(e){i[e.data.id]&&i[e.data.id](e.data.evaluated),delete i[e.data.id]},t.runCode=function(e,t){i.push(t||null),o.postMessage({id:i.length-1,code:e})};var a={};return t.runFunction=function(t,r,n,i,o){if("function"==typeof r)if("undefined"==typeof a[t])e(o,function(e){var o=e;o+=";onmessage="+r.toString();var s=new Blob([o],{type:"text/javascript"}),l=window.URL.createObjectURL(s);a[t]=l;var u=new Worker(l);u.postMessage({id:t,params:n}),u.onmessage=function(e){i&&i(e.data)}});else{var s=a[t],l=new Worker(s);l.postMessage({id:t,params:n})}},t.runMultipleFunction=function(t,r,n,i,o,s){if("function"==typeof n&&i instanceof Array&&i.length>=r)if("undefined"==typeof a[t])e(s,function(e){var s=e;s+=";onmessage="+n.toString();var l=new Blob([s],{type:"text/javascript"}),u=window.URL.createObjectURL(l);a[t]=u;for(var g=0;g<r;g++){var c=new Worker(u),e=[];c.onmessage=function(t){e.push(t.data),e.length==r&&o&&o(e)},c.postMessage({id:t,params:i[g]})}});else for(var l=a[t],u=0;u<r;u++){var g=new Worker(l),c=[];g.onmessage=function(e){c.push(e.data),c.length==r&&o&&o(c)},g.postMessage({id:t,params:i[u]})}},t}();var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.enumeration=function(e){var t=function(){throw"Can't Instantiate Enumerations"},r=t.prototype={constructor:t,toString:function(){return this.name},valueOf:function(){return this.value},toJSON:function(){return this.name}};t.values=[];for(var n in e){var i=inherit(r);i.name=n,i.value=e[n],t[n]=i,t.values.push(i)}return t.foreach=function(e,t){for(var r=0;r<this.values.length;r++)e.call(t,this.values[r])},t};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.File={JSLoaded:"",loadJSfile:function(e,t){if(EJSS_TOOLS.File.JSLoaded.indexOf("["+e+"]")!=-1)return console.log("File already loaded "+e),void t();EJSS_TOOLS.File.JSLoaded+="["+e+"]";var r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",e),"undefined"!=typeof t&&(r.onload=t),document.getElementsByTagName("head")[0].appendChild(r)},plainName:function(e){var t=e.lastIndexOf("/");return t>=0&&(e=e.substring(t+1)),t=e.indexOf("."),t>0&&(e=e.substring(0,t)),e},download:function(e,t){var r=document.createElement("a");r.setAttribute("href","data:application/ejss;charset=utf-8,"+encodeURIComponent(t)),r.setAttribute("download",e),r.click()},loadScript:function(e){var t=document.createElement("script");t.type="text/javascript",t.src=e,document.getElementsByTagName("head")[0].appendChild(t)},loadJSONFile:function(e,t){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState&&200==r.status){var e=JSON.parse(r.responseText);t(e)}},r.open("GET",e,!0),r.send()},requestShortUrl:function(e,t){var r=escape("http://urlecho.appspot.com/echo?status=200&Content-Type=text/plain&body="+e);if(EJSS_TOOLS.File.CALLBACK=t,EJSS_TOOLS.File.callFunction=function(e){EJSS_TOOLS.File.CALLBACK(e.shortUrl)},null==document.getElementById("__rtShortUrl")){var n=document.createElement("script");n.type="text/javascript",n.id="__rtShortUrl",n.innerHTML="function rtShortUrl(data) { EJSS_TOOLS.File.callFunction(data); }",document.getElementsByTagName("head")[0].appendChild(n)}var i=document.getElementById("_requestShortUrl");null!=i&&document.getElementsByTagName("head")[0].removeChild(i),i=document.createElement("script"),i.id="_requestShortUrl",i.type="text/javascript",i.src="http://b1t.co/Site/api/External/MakeUrlWithGet?callback=rtShortUrl&url="+r,document.getElementsByTagName("head")[0].appendChild(i)}};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.JsonrpcBuilder={template:{METHOD:"${METHOD}",PARAMS:"${PARAMS}",ID:"${ID}",REQUEST:'{jsonrpc: "2.0", method: ${METHOD}, params: ${PARAMS}, id: ${ID}}',RESPONSE_OK:'{jsonrpc: "2.0", result: ${RESULT}, params: ${PARAMS}, id: ${ID}}',RESPONSE_ERROR:'{jsonrpc: "2.0", method: ${METHOD}, params: ${PARAMS}, id: ${ID}}',ERROR:'{code: "2.0", message: ${MESSAGE}, data: ${DATA}}'},request:function(e,t,r){if(t&&!(t instanceof Array))throw new InvalidParamsException;var n={jsonrpc:"2.0",method:e};return t&&(n.params=t),r&&(n.id=r),n},response:function(e,t){return{jsonrpc:"2.0",result:e,id:t}},responseWithError:function(e,t){return{jsonrpc:"2.0",error:e,id:t}},error:function(e,t,r){return{code:e,message:t,data:r}},parseResponse:function(e){var t=null;try{t=JSON.parse(e)}catch(e){console.log(e)}return null!=t?t.result:null}};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.JsonrpcClient={methods:{connect:"connect",open:"open",getMetadata:"getMetadata",getValue:"getValue",setValue:"setValue",close:"close",disconnect:"disconnect"}},EJSS_TOOLS.jsonrpcClient=function(e,t){function r(e){for(var t="",r="abcdefghijklmnopqrstuvwxyz",n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}function n(e,t,n,i){var a=i?i:r(12);n&&(d[a]=n);var s=S.request(e,t,a);o.send(JSON.stringify(s))}function i(){o.onopen=function(e){a&&a(e),console.log("Openhd Event: "+e.type+" - Message: "+e.data)},o.onmessage=function(e){var t=JSON.parse(e.data);u&&u(d),t.id&&d[t.id]&&d[t.id](t.result)},o.onclose=function(e){s&&s(message),console.log("Closehd Event: "+message.type+" - Message: "+message.data)},o.onerror=function(e){l&&l(e),console.log("Errorhd Event: "+e.type+" - Message: "+e.data)}}var o,a,s,l,u,g={},c=EJSS_TOOLS.JsonrpcClient,S=EJSS_TOOLS.JsonrpcBuilder,d={};return g.connect=function(e){return n(c.methods.connect,null,e)},g.open=function(e){return n(c.methods.open,null,e)},g.getValue=function(e,t){return n(c.methods.getValue,[e],t)},g.setValue=function(e,t){return n(c.methods.setValue,e,t)},g.getMetadata=function(e){return n(c.methods.getMetadata,null,e)},g.disconnect=function(e){return n(c.methods.disconnect,null,e)},g.close=function(e){return n(c.methods.close,null,e)},g.init=function(r,n,g,c){try{a=r,l=g,s=c,u=n;var S="ws://"+e;t&&(S+=":"+t),o=new WebSocket(S),i(),console.log("Connecting... (readyState "+o.readyState+")")}catch(e){console.log(e)}},g.finish=function(){try{o.close()}catch(e){console.log(e)}},g};var EJSS_TOOLS=EJSS_TOOLS||{};EJSS_TOOLS.Mathematics={TWO_PI:6.2831852,TO_RADIANS:Math.PI/180,LOG10SCALE:1/Math.log(10),cosineAndSine:[],cosineAndSineForDegrees:function(e){e%=360,e<0&&(e+=360);var t=this.cosineAndSine[e];if(void 0===t){var r=e*this.TO_RADIANS;t=[Math.cos(r),Math.sin(r)]}return t},radians:function(e){return e*Math.PI/180},degrees:function(e){var t=180*e/Math.PI,r=t%360;return t=360*r<0?r+360:r},norm:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r]*e[r];return Math.sqrt(t)},crossProduct:function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},normalize:function(e){var t=EJSS_TOOLS.Mathematics.norm(e);return 0==t?e:[e[0]/t,e[1]/t,e[2]/t]},normalTo:function(e){if(0==e[0])return[1,0,0];if(0==e[1])return[0,1,0];if(0==e[2])return[0,0,1];var t=EJSS_TOOLS.Mathematics.norm(e);return[-e[1]/t,e[0]/t,0]}},sensors={iOS_accelerometer:{x:0,y:0,z:0},iOS_gyroscope:{x:0,y:0,z:0},setAccelerometer:function(accvalue){var value=JSON.parse(accvalue),accelerometer=eval(value.result);window.innerWidth>window.innerHeight?sensors.iOS_accelerometer={x:accelerometer.y,y:-accelerometer.x,z:accelerometer.z}:sensors.iOS_accelerometer=accelerometer},setGyroscope:function(gyrvalue){var value=JSON.parse(gyrvalue),gyroscope=eval(value.result);window.innerWidth>window.innerHeight?sensors.iOS_gyroscope={x:gyroscope.y,y:-gyroscope.x,z:gyroscope.z}:sensors.iOS_gyroscope=gyroscope},iOS_staccelerometer:{x:0,y:0,z:0},iOS_stgyroscope:{x:0,y:0,z:0},iOS_stmagnetometer:{x:0,y:0,z:0},iOS_sthumidity:0,iOS_sttempamb:0,iOS_sttempir:0,iOS_stpressure:0,setSensorTag:function(stvalue){var value=JSON.parse(stvalue),results=eval(value.result);sensors.iOS_staccelerometer={x:results.accx,y:results.accy,z:results.accz},sensors.iOS_stgyroscope={x:results.gyrox,y:results.gyroy,z:results.gyroz},sensors.iOS_stmagnetometer={x:results.magx,y:results.magy,z:results.magz},sensors.iOS_sthumidity=results.hum,sensors.iOS_sttempamb=results.tamb,sensors.iOS_sttempir=results.tir,sensors.iOS_stpressure=results.press},calliOSFunction:function(e,t,r,n){var i="ejss://",o={};o.functionname=e,r&&(o.success=r),n&&(o.error=n),t&&(o.args=t),i+=JSON.stringify(o),window.location=i},isSupportedSensorTag:function(){var e=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);return e},runSensorTag:function(e,t){var r=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);if(r){var n=[];n[0]=e,n[1]=t,sensors.calliOSFunction("runSensorTag",n,"sensors.setSensorTag")}},stopSensorTag:function(){var e=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);e&&sensors.calliOSFunction("stopSensorTag")},getSensorTagAccelerometer:function(){return sensors.iOS_staccelerometer},getSensorTagGyroscope:function(){return sensors.iOS_stgyroscope},getSensorTagMagnetometer:function(){return sensors.iOS_stmagnetometer},getSensorTagTempAmb:function(){return sensors.iOS_sttempamb},getSensorTagTempIR:function(){return sensors.iOS_sttempir},getSensorTagPressure:function(){return sensors.iOS_stpressure},getSensorTagHumidity:function(){return sensors.iOS_sthumidity},isAccelerometer:function(){var e=window.android&&window.android.isAccelerometer(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);return e||t},runAccelerometer:function(){var e=window.android&&window.android.isAccelerometer(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);e?window.android.runAccelerometer():t&&sensors.calliOSFunction("runAccelerometer","","sensors.setAccelerometer")},stopAccelerometer:function(){var e=window.android&&window.android.isAccelerometer(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);e?window.android.stopAccelerometer():t&&sensors.calliOSFunction("stopAccelerometer")},getAccelerometer:function(){var is_Androidwebview=window.android&&window.android.isAccelerometer(),is_iOSwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);if(is_Androidwebview){var value=eval(window.android.getAccelerometer());return window.innerWidth>window.innerHeight?value:{x:value.y,y:-value.x,z:value.z}}return is_iOSwebview?sensors.iOS_accelerometer:{x:0,y:0,z:0}},isGyroscope:function(){var e=window.android&&window.android.isGyroscope(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);return e||t},runGyroscope:function(){var e=window.android&&window.android.isGyroscope(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);e?window.android.runGyroscope():t&&sensors.calliOSFunction("runGyroscope","","sensors.setGyroscope")},stopGyroscope:function(){var e=window.android&&window.android.isGyroscope(),t=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);e?window.android.stopGyroscope():t&&sensors.calliOSFunction("stopGyroscope")},getGyroscope:function(){var is_Androidwebview=window.android&&window.android.isGyroscope(),is_iOSwebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent);if(is_Androidwebview){var value=eval(window.android.getGyroscope());return window.innerWidth>window.innerHeight?value:{x:value.y,y:-value.x,z:value.z}}return is_iOSwebview?sensors.iOS_gyroscope:{x:0,y:0,z:0}},isGravity:function(){var e=window.android&&window.android.isGravity();return e},runGravity:function(){var e=window.android&&window.android.isGravity();e&&window.android.runGravity()},stopGravity:function(){var e=window.android&&window.android.isGravity();e&&window.android.stopGravity()},getGravity:function(){var e=window.android&&window.android.isGravity();return e?window.android.getGravity():{x:0,y:0,z:0}},isLinearAcceleration:function(){var e=window.android&&window.android.isLinearAcceleration();return e},runLinearAcceleration:function(){var e=window.android&&window.android.isLinearAcceleration();e&&window.android.runLinearAcceleration()},stopLinearAcceleration:function(){var e=window.android&&window.android.isLinearAcceleration();e&&window.android.stopLinearAcceleration()},getLinearAcceleration:function(){var e=window.android&&window.android.isLinearAcceleration();return e?window.android.getLinearAcceleration():{x:0,y:0,z:0}},isRotationVector:function(){var e=window.android&&window.android.isRotationVector();return e},runRotationVector:function(){var e=window.android&&window.android.isRotationVector();e&&window.android.runRotationVector()},stopRotationVector:function(){var e=window.android&&window.android.isRotationVector();e&&window.android.stopRotationVector()},getRotationVector:function(){var e=window.android&&window.android.isRotationVector();return e?window.android.getRotationVector():{x:0,y:0,z:0}},isMagneticField:function(){var e=window.android&&window.android.isMagneticField();return e},runMagneticField:function(){var e=window.android&&window.android.isMagneticField();e&&window.android.runMagneticField()},stopMagneticField:function(){var e=window.android&&window.android.isMagneticField();e&&window.android.stopMagneticField()},getMagneticField:function(){var e=window.android&&window.android.isMagneticField();return e?window.android.getMagneticField():{x:0,y:0,z:0}},isAmbientTemperature:function(){var e=window.android&&window.android.isAmbientTemperature();return e},runAmbientTemperature:function(){var e=window.android&&window.android.isAmbientTemperature();e&&window.android.runAmbientTemperature()},stopAmbientTemperature:function(){var e=window.android&&window.android.isAmbientTemperature();e&&window.android.stopAmbientTemperature()},getAmbientTemperature:function(){var e=window.android&&window.android.isAmbientTemperature();return e?window.android.getAmbientTemperature():0},isLight:function(){var e=window.android&&window.android.isLight();return e},runLight:function(){var e=window.android&&window.android.isLight();e&&window.android.runLight()},stopLight:function(){var e=window.android&&window.android.isLight();e&&window.android.stopLight()},getLight:function(){var e=window.android&&window.android.isLight();return e?window.android.getLight():0},isPressure:function(){var e=window.android&&window.android.isPressure();return e},runPressure:function(){var e=window.android&&window.android.isPressure();e&&window.android.runPressure()},stopPressure:function(){var e=window.android&&window.android.isPressure();e&&window.android.stopPressure()},getPressure:function(){var e=window.android&&window.android.isPressure();return e?window.android.getPressure():0},isHumidity:function(){var e=window.android&&window.android.isHumidity();return e},runHumidity:function(){var e=window.android&&window.android.isHumidity();e&&window.android.runHumidity()},stopHumidity:function(){var e=window.android&&window.android.isHumidity();e&&window.android.stopHumidity()},getHumidity:function(){var e=window.android&&window.android.isHumidity();return e?window.android.getHumidity():0}};var EJSS_CORE=EJSS_CORE||{};EJSS_CORE.createView=function(e){function t(e,t){return e.match("^"+t)==t}var r,n,i,o,a={},s={},l={},u=[],g=[],c=[],S=[],d=[],f=[],E=[],p=[],h=[],m=[],A=[],y=[],v=!1,P=!0,D=[],I=[],_=!1,C=[];return a._1=function(){a[e].innerHTML="",s={},l={},u=[],g=[],D=[],c=[],S=[],d=[],f=[],E=[],h=[],m=[],A=[],y=[],p=[],v=!1,P=!0},a._2=function(e){n=e},a._3=function(e){if(null==e||e.length<=0)return e;if(t(e,"local:"))return e;if(t(e,"data:"))return e;if(t(e,"http:")||t(e,"https:")||t(e,"ws:"))return e;if("undefined"!=typeof __base64Images){var r=__base64Images[e];if(r)return r}if(i&&!t(e,i)&&"/"==e.charAt(0)?e=i+"images"+e:n&&!t(e,n)&&"/"!=e.charAt(0)&&(e=n+e),t(window.location.protocol,"ibooks")){var o=window.location.pathname;o=o.substring(0,o.lastIndexOf("/")),t(e,"./")&&(e=e.substring(2)),e="ibooksimg://"+window.location.host+"/"+o+"/"+e}return e},a._4=function(e){i=e},a._showDocument=function(e){window.open(a._3(e))},a._addDescriptionPage=function(e,t){C[e]=t},a._openDescriptionPage=function(e){var t=C[e];t?window.open(a._3(t)):console.log("Desription page not found: "+e)},a._5=function(e,t){s[e]={getter:null,setter:null,listeners:[],collectors:[],value:t}},a._5s=function(e){for(var t=0;t<e.length;t++)a._5(e[t])},a._7=function(e){l[e]={action:null}},a._7s=function(e){for(var t=0;t<e.length;t++)a._7(e[t])},a._9=function(e,t,r,n){var i=EJSS_CORE.promoteToControlElement(e(t,n),a,t);return i.render&&d.push(i),i.touch&&f.push(i),i.dataCollected&&E.push(i),i.reset&&c.push(i),i.initialize&&S.push(i),i.enableEPub&&h.push(i),i.adjustPosition&&m.push(i),t&&(a[t]=i),r&&i.setProperty("Parent",r),i},a._10=function(e){var t=s[e];if(void 0!==t)return t.value},a._11=function(){a._reset(),a._15(),a._initialize(),a._update(),a._render()},a._12=function(e){r=e},a._13=function(e,t,r,n){var i=s[e];if(i){i.getter=t,i.setter=r,i.value=n;var o=g.indexOf(i);i.getter?i.listeners.length>0&&o<0&&g.push(i):o>=0&&g.splice(o,1),o=D.indexOf(i),i.value?i.listeners.length>0&&o<0&&D.push(i):o>=0&&D.splice(o,1)}else console.log("WARNING: view._setAccessors() - Variable not found : "+e);return i},a._setAction=function(e,t){var r=l[e];return r?r.action=t:console.log("WARNING: view._setAction() - Action not found : "+e),r},a._14=function(e){P=e},a._reset=function(){for(var e=0,t=c.length;e<t;e++)c[e].reset()},a._15=function(){for(var e=0,t=D.length;e<t;e++){var r=D[e],n=r.value;if(n)for(var i=r.listeners,o=0,a=i.length;o<a;o++)i[o](n)}},a._initialize=function(){for(var e=0,t=S.length;e<t;e++)S[e].initialize()},a._update=function(){var e,t;for(e=0,t=g.length;e<t;e++)for(var r=g[e],n=r.listeners,i=r.getter(),o=0,a=n.length;o<a;o++)n[o](i);for(e=0,t=u.length;e<t;e++){var s=u[e];s.propertySetter(s.getter())}},a._collectData=function(){var e,t;for(e=0,t=g.length;e<t;e++)for(var r=g[e],n=r.collectors,i=r.getter(),o=0,a=n.length;o<a;o++)n[o](i);for(e=0,t=u.length;e<t;e++){var s=u[e];s.isCollector&&s.propertySetter(s.getter())}for(e=0,t=E.length;e<t;e++)E[e].dataCollected()},a._render=function(){for(var e=0,t=d.length;e<t;e++)d[e].render()},a._touch=function(){for(var e=0,t=f.length;e<t;e++)f[e].touch()},a._enableEPub=function(){if("undefined"!=typeof _isEPub&&_isEPub)for(var e=0,t=h.length;e<t;e++)h[e].enableEPub()},a._addFontResizeListener=function(e){A.push(e)},a._fontResized=function(e,t,r){for(var n=0,i=m.length;n<i;n++)m[n].adjustPosition();if(e)for(var o=0,a=A.length;o<a;o++)A[o](e,t,r)},a._addResizeListener=function(e){y.push(e)},a._resized=function(e,t){for(var r=0,n=m.length;r<n;r++)m[r].adjustPosition();for(var i=0,o=y.length;i<o;i++)y[i](e,t)},a._16=function(e,t,r){var n=p.length;if(n<=0)return!1;v=!0;for(var i=0;i<n;i++){var o=p[i];if(a.isRegInteractions()){var s=o.interaction;s.data=o.data,s.runCount=e,s.runTime=t,s.isPlaying=r,s.timeStamp=Date.now(),a.pushRegInteractions(s)}o.what(o.data)}return p=[],v=!1,!0},a._17=function(){return p.length},a._18=function(){r&&P&&r()},a._19=function(e,t,r){var n=s[e];return n?(n.listeners.indexOf(t)<0&&(n.listeners.push(t),r&&n.collectors.push(t)),n.getter&&g.indexOf(n)<0&&g.push(n),n.value&&D.indexOf(n)<0&&D.push(n)):console.log("WARNING: view._19() - Variable not found : "+e),n},a._20=function(e,t,r){for(var n=!1,i=0,o=u.length;i<o;i++){var a=u[i];if(a.propertySetter===t){a.getter=e,n=!0;break}}return n||u.push({getter:e,propertySetter:t,isCollector:r}),n},a._21=function(e){var t=l[e];return t||console.log("WARNING: view._21() - Action not found : "+e),t},a._22=function(e,t,n){return r?void(!v&&P&&p.push({what:e,data:t,interaction:n})):void e(t)},a._format=function(e,t){var r=t.indexOf("."),n=0;return r>=0&&(n=Number(t.length-r-1)),parseFloat(e).toFixed(n)},a.print=function(e){var t=document.getElementsByTagName("textarea");t.length?t[0].innerHTML=e:console.log(e)},a._setVisible=function(t){t?document.getElementById(e).style.display="inherit":document.getElementById(e).style.display="none"},a._switchVisibility=function(){a._setVisible("none"==document.getElementById(e).style.display)},a.serialize=function(){var e={};for(key in a)a[key].serialize&&(e[key]=a[key].serialize());return e},a.unserialize=function(e){for(key in e)a[key]&&a[key].unserialize?a[key].unserialize(e[key]):console.log("Impossible unserialize: "+key)},a.registerInteractions=function(e){I=[],o=e,_=!0},a.unregisterInteractions=function(){_=!1},a.getRegInteractions=function(){return I},a.isRegInteractions=function(){return _},a.pushRegInteractions=function(e){"undefined"!=typeof o?o.send(JSON.stringify(e)):I.push(e)},a[e]=document.getElementById(e),a},EJSS_CORE.promoteToControlElement=function(e,t,r){r=r||"unnamed";var n={},i={};return e._0=function(e){r=e},e.getName=function(){return r},e.getResourcePath=function(e){return t._3(e)},e.registerProperty=function(t,r,i){return n[t]={setter:r,getter:i,variable:null,variableSetter:null},e},e.registerAction=function(t,r,n,o){return i[t]={action:null,helper:r,process:n},o&&e.setAction(t,o),e},e.setProperty=function(t,r){var o=i[t];if(o)return e.setAction(t,r);var a=n[t];return a?a.setter(r):console.log("WARNING: ControlElement setProperty() - Property not registered : "+t+" for element : "+e.getName()),e},e.setProperties=function(t){for(var r in t)e.setProperty(r,t[r]);return e},e.linkProperty=function(r,i,o){var a=n[r];if(!a)return console.log("WARNING: ControlElement linkProperty() - Element property not registered : "+r+" for element : "+e.getName()),e;if("string"==typeof i){var s=t._19(i,a.setter,e.dataCollected);if(!s)return console.log("WARNING: ControlElement linkProperty() - element : "+e.getName()+" - property :"+r+" - View variable not registered : "+i),e;"InputOnly"===o||(a.variable=s),a.variableSetter=null}else t._20(i,a.setter,e.dataCollected),a.variableSetter=o,a.variable=null;return e},e.linkProperties=function(t){for(var r in t)e.linkProperty(r,t[r]);return e},e.setAction=function(r,n){var o=i[r];if(!o)return console.log("WARNING: ControlElement setAction() - action not registered : "+r+" for element : "+e.getName),e;if("string"==typeof n){var a=t._21(n);if(!a)return console.log("WARNING: ControlElement setAction() - element : "+e.getName()+" - View action not registered : "+n),e;o.action=a}else o.action={action:n};return e},e.setActions=function(t){for(var r in t)e.setAction(r,t[r]);return e},e.invokeAction=function(r){var n={};t.isRegInteractions()&&(n={action:r,element:e.getName(),timeStamp:Date.now()});var o=i[r];if(o&&(o.process&&t._22(o.process,null,n),o.action)){var a=o.helper?o.helper():null;t._22(o.action.action,a,n)}return e},e.propertiesChanged=function(){for(var t=0,r=arguments.length;t<r;t++)e.propertyChanged(arguments[t]);return e},e.propertyChanged=function(r,i){var o={};t.isRegInteractions()&&(o={property:r,element:e.getName(),timeStamp:Date.now()});var a=n[r];if(a){var s=a.variableSetter;if(s||a.variable&&(s=a.variable.setter),s||a.setter&&(s=a.setter),s){var l="undefined"!=typeof i?i:a.getter();t._22(s,l,o)}}return e},e.reportInteractions=function(r,n){var i,o;if(r)for(i=0,o=r.length;i<o;i++)e.invokeAction(r[i]);if(n)for(i=0,o=n.length;i<o;i++)e.propertiesChanged(n[i]);return t._17()>0&&t._18(),e},e.getProperty=function(e,t){var r=n[e];if(r&&r.getter)return r.getter()},e.getProperties=function(){return n},e.registerProperty("name",e._0,e.getName),e.registerProperties&&e.registerProperties(e),e};

function GroupTransform(_topFrame,_libraryPath,_codebasePath) {
  var _model = EJSS_CORE.createAnimation();
  var _view;
  var _isPlaying = false;
  var _isPaused = true;
  var _isMobile = (navigator===undefined) ? false : navigator.userAgent.match(/iPhone|iPad|iPod|Android|BlackBerry|Opera Mini|IEMobile/i);

var _stringProperties = {};
  var _tools = {
    showInputDialog : EJSS_INTERFACE.BoxPanel.showInputDialog,
    showOkDialog : EJSS_INTERFACE.BoxPanel.showOkDialog,
    showOkCancelDialog : EJSS_INTERFACE.BoxPanel.showOkCancelDialog
  };

  function _play()  { _isPaused = false; _isPlaying = true;  _model.play();  }
  function _pause() { _isPaused = true;  _isPlaying = false; _model.pause(); }
  function _step()  { _pause();  _model.step(); }
  function _reset() { _model.reset();  _isPaused = _model.isPaused(); _isPlaying = _model.isPlaying(); }
  function _update() { _model.update(); }
  function _initialize() { _model.initialize(); }
  function _setFPS(_fps) { _model.setFPS(_fps); }
  function _setDelay(_delay) { _model.setDelay(_delay); }
  function _setStepsPerDisplay(_spd) { _model.setStepsPerDisplay(_spd); }
  function _setUpdateView(_updateView) { _model.setUpdateView(_updateView); }
  function _setAutoplay(_auto) { _model.setAutoplay(_auto); }
  function _println(_message) { console.log(_message); }

  function _breakAfterThisPage() { _model.setShouldBreak(true); }

  function _resetSolvers() { if (_model.resetSolvers) _model.resetSolvers(); }

  function _saveText(name,type,content) { if (_model.saveText) _model.saveText(name,type,content); }

  function _saveState(name) { if (_model.saveState) _model.saveState(name); }

  function _saveImage(name,panelname) { if (_model.saveImage) _model.saveImage(name,panelname); }

  function _readState(url,type) { if (_model.readState) _model.readState(url,type); }

  function _readText(url,type,varname) { if (_model.readText) _model.readText(url,type,varname); }

function _getStringProperty(propertyName) {
  var _value = _stringProperties[propertyName];
  if (_value===undefined) return propertyName;
  else return _value;
}
  var __pagesEnabled = [];
  function _setPageEnabled(pageName,enabled) { __pagesEnabled[pageName] = enabled; }

  var theta; // EjsS Model.Variables.Var Table.theta
  var t; // EjsS Model.Variables.Var Table.t

  var _privateOdesList;
  var _ODEi_evolution1;

  function _serialize() { return _model.serialize(); }

  _model._userSerialize = function() {
    return {
      theta : theta,
      t : t
    };
  };

  function _unserialize(json) { return _model.unserialize(json); }

  _model._userUnserialize = function(json) {
    if(typeof json.theta != "undefined") theta = json.theta;
    if(typeof json.t != "undefined") t = json.t;
   _resetSolvers();
   _model.update();
  };

  _model.addToReset(function() {
    __pagesEnabled["Evol Page"] = true;
  });

  _model.addToReset(function() {
    theta = Math.PI/4.0; // EjsS Model.Variables.Var Table.theta
    t = 0.0; // EjsS Model.Variables.Var Table.t
  });

  _model.addToReset(function() {
    _privateOdesList=[];
    _ODEi_evolution1 = _ODE_evolution1();
    _privateOdesList.push(_ODEi_evolution1);
  });

  _model.addToReset(function() {
    _model.setAutoplay(true);
    _model.setPauseOnPageExit(true);
    _model.setFPS(20);
    _model.setStepsPerDisplay(1);
  });

  _model.addToInitialization(function() {
    _initializeSolvers();
  });

  _model.addToEvolution(function() {
    if (!__pagesEnabled["Evol Page"]) return;
    _ODEi_evolution1.step();
  });

  _model.addToFixedRelations(function() { _isPaused = _model.isPaused(); _isPlaying = _model.isPlaying(); });

  _model.addToFixedRelations(function() { _isPaused = _model.isPaused(); _isPlaying = _model.isPlaying(); });

  function _initializeSolvers() {
    for (var i=0,n=_privateOdesList.length; i<n; i++) _privateOdesList[i].initializeSolver();
  }

  function _automaticResetSolvers() {
    for (var i=0,n=_privateOdesList.length; i<n; i++) _privateOdesList[i].automaticResetSolver();
  }

  _model.resetSolvers = function() {
    for (var i=0,n=_privateOdesList.length; i<n; i++) _privateOdesList[i].resetSolver();
  };

  function _getODE(_odeName) {
    if (_odeName=="Evol Page") return _ODEi_evolution1;
    return null;
  }

  function _getEventSolver(_odeName) {
    var ode = _getODE(_odeName);
    if (ode===null) return null;
    return ode.getEventSolver();
  }

  function _setSolverClass(_odeName, _engine) {
    var ode = _getODE(_odeName);
    if (ode===null) return;
    if (!_engine.setODE) {
      var classname = _engine.toLowerCase();
      if      (classname.indexOf("boga")>=0)   _engine = EJSS_ODE_SOLVERS.bogackiShampine23;
      else if (classname.indexOf("cash")>=0)   _engine = EJSS_ODE_SOLVERS.cashKarp45;
      else if (classname.indexOf("dopri5")>=0) _engine = EJSS_ODE_SOLVERS.dopri5;
      else if (classname.indexOf("dopri8")>=0) _engine = EJSS_ODE_SOLVERS.dopri853;
      else if (classname.indexOf("richa")>=0)  _engine = EJSS_ODE_SOLVERS.eulerRichardson;
      else if (classname.indexOf("euler")>=0)  _engine = EJSS_ODE_SOLVERS.euler;
      else if (classname.indexOf("fehlberg87")>=0) _engine = EJSS_ODE_SOLVERS.fehlberg87;
      else if (classname.indexOf("fehlberg8")>=0)  _engine = EJSS_ODE_SOLVERS.fehlberg8;
      else if (classname.indexOf("radau")>=0)   _engine = EJSS_ODE_SOLVERS.radau5;
      else if (classname.indexOf("runge")>=0)  _engine = EJSS_ODE_SOLVERS.rungeKutta4;
      else if (classname.indexOf("rk4")>=0)    _engine = EJSS_ODE_SOLVERS.rungeKutta4;
      else if (classname.indexOf("verlet")>=0) _engine = EJSS_ODE_SOLVERS.velocityVerlet;
    }
    if (_engine) ode.setSolverClass(_engine);
  }

  function _ODE_evolution1() {
    var __odeSelf = {};
    var __eventSolver;
    var __solverClass = EJSS_ODE_SOLVERS.rungeKutta4;
    var __state=[];
    var __ignoreErrors=false;
    var __mustInitialize=true;
    var __isEnabled=true;
    var __mustUserReinitialize=false;
    var __mustReinitialize=true;


    __odeSelf.setSolverClass = function(__aSolverClass) {
      __solverClass = __aSolverClass;
      __instantiateSolver();
    };

    function __instantiateSolver() {
      __state=[];
      __pushState();
      __eventSolver = EJSS_ODE_SOLVERS.interpolatorEventSolver(__solverClass(),__odeSelf);
      __mustInitialize = true;
    }

    __odeSelf.setEnabled = function(_enabled) { __isEnabled = _enabled; };

    __odeSelf.getIndependentVariableValue = function() { return __eventSolver.getIndependentVariableValue(); };

    __odeSelf.getInternalStepSize = function() { return __eventSolver.getInternalStepSize(); };

    __odeSelf.isAccelerationIndependentOfVelocity = function() { return false; };

    __odeSelf.initializeSolver = function() {
      if (__arraysChanged()) { __instantiateSolver(); __odeSelf.initializeSolver(); return; }
      __pushState();
      __eventSolver.initialize(0.05);
      __eventSolver.setBestInterpolation(false);
      __eventSolver.setMaximumInternalSteps(10000);
      __eventSolver.removeAllEvents();
      __eventSolver.setEstimateFirstStep(false);
      __eventSolver.setEnableExceptions(false);
      __eventSolver.setTolerances(0.00001,0.00001);
      __mustReinitialize = true;
      __mustInitialize = false;
    };

    function __pushState() {
      // Copy our variables to __state[] 
        var __j=0;
        var __n=0;
        var __cIn=0;
        if (__state[__cIn]!=theta) __mustReinitialize = true;
        __state[__cIn++] = theta;
        if (__state[__cIn]!=t) __mustReinitialize = true;
        __state[__cIn++] = t;
    }

    function __arraysChanged () {
      return false;
    }

    __odeSelf.getEventSolver = function() {
      return __eventSolver;
    };

    __odeSelf.resetSolver = function() {
      __mustUserReinitialize = true;
    };

    __odeSelf.automaticResetSolver = function() {
      __mustReinitialize = true;
    };

    function __errorAction () {
      if (__ignoreErrors) return;
      console.log (__eventSolver.getErrorMessage());
      _pause();
      // Make sure the solver is reinitialized;
      __mustReinitialize = true;
    }

    __odeSelf.step = function() { return __privateStep(false); };

    __odeSelf.solverStep = function() { return __privateStep(true); };

    function __privateStep(__takeMaximumStep) {
      if (!__isEnabled) return 0;
      if (0.05===0) return 0;
      if (__mustInitialize) __odeSelf.initializeSolver();
      if (__arraysChanged()) { __instantiateSolver(); __odeSelf.initializeSolver(); }
      __eventSolver.setStepSize(0.05);
      __eventSolver.setInternalStepSize(0.05);
      __eventSolver.setMaximumInternalSteps(10000);
      __eventSolver.setTolerances(0.00001,0.00001);
      __pushState();
      if (__mustUserReinitialize) { 
        __eventSolver.userReinitialize();
        __mustUserReinitialize = false;
        __mustReinitialize = false;
        if (__eventSolver.getErrorCode()!=EJSS_ODE_SOLVERS.ERROR.NO_ERROR) __errorAction();
      }
      else if (__mustReinitialize) { 
        __eventSolver.reinitialize();
        __mustReinitialize = false;
        if (__eventSolver.getErrorCode()!=EJSS_ODE_SOLVERS.ERROR.NO_ERROR) __errorAction();
      }
      var __stepTaken = __takeMaximumStep ? __eventSolver.maxStep() : __eventSolver.step();
      // Extract our variables from __state
        var __i=0;
        var __cOut=0;
        theta = __state[__cOut++];
        t = __state[__cOut++];
      // Check for error
      if (__eventSolver.getErrorCode()!=EJSS_ODE_SOLVERS.ERROR.NO_ERROR) __errorAction();
      return __stepTaken;
    }

    __odeSelf.getState = function() { return __state; };

    __odeSelf.getRate = function(_aState,_aRate) {
      // Extract our variables from _aState
        var __i=0;
        var __cOut=0;
        var theta = _aState[__cOut++];
        var t = _aState[__cOut++];
      // Compute the rate
        var __cRate=0;
        _aRate[__cRate++] = 0.1; // Rate for ODE: Evol Page:theta
        _aRate[__cRate++] = 1; // independent variable
        return _aRate;
    }; //end of getRate

    __instantiateSolver();

    return __odeSelf;
  }

  function _historic_theta(__time) {
    var __index = 0;
    return _ODEi_evolution1.getEventSolver().getStateHistory().interpolate(__time,__index);
  }

    _model._resized = function(_width,_height) {
      _view._resized(_width,_height);
  }; // end of _resized
    _model._fontResized = function(iBase,iSize,iDelta) {
      _view._fontResized(iBase,iSize,iDelta);
  }; // end of _fontResized

  function _getViews() {
    var _viewsInfo = [];
    var _counter = 0;
    _viewsInfo[_counter++] = { name : "HtmlView Page", width : 800, height : 600 };
    return _viewsInfo;
  } // end of _getViews

  function _selectView(_viewNumber) {
    _view = null;
    _view = new GroupTransform_View(_topFrame,_viewNumber,_libraryPath,_codebasePath);
    var _view_super_reset = _view._reset;
    _view._reset = function() {
      _view_super_reset();
      switch(_viewNumber) {
        case -10 : break; // make Lint happy
        default :
        case 0:
          _view.group.linkProperty("Transformation",  function() { return theta; }, function(_v) { theta = _v; } ); // HtmlView Page linking property 'Transformation' for element 'group'
          break;
      } // end of switch
    }; // end of new reset

    _model.setView(_view);
    _model.reset();
    _view._enableEPub();
  } // end of _selectView

  _model.setAutoplay(true);
  _model.setFPS(20);
  _model.setStepsPerDisplay(1);
  _selectView(_model._autoSelectView(_getViews())); // this includes _model.reset()
  return _model;
}

function GroupTransform_View (_topFrame,_viewNumber,_libraryPath,_codebasePath) {
  var _view;
  switch(_viewNumber) {
    case -10 : break; // make Lint happy
    default :
    case 0: _view = GroupTransform_View_0 (_topFrame); break;
  } // end of switch

  if (_codebasePath) _view._2(_codebasePath);

  if (_libraryPath) _view._4(_libraryPath);


  return _view;
} // end of main function

function GroupTransform_View_0 (_topFrame) {
  var _view = EJSS_CORE.createView(_topFrame);

  _view._reset = function() {
    _view._1();
    _view._9(EJSS_INTERFACE.panel,"panel", _view._topFrame) // EJsS HtmlView.HtmlView Page: declaration of element 'panel'
      ;

    _view._9(EJSS_DRAWING2D.plottingPanel,"plottingPanel", _view.panel) // EJsS HtmlView.HtmlView Page: declaration of element 'plottingPanel'
      .setProperty("MinimumX",-10.0) // EJsS HtmlView.HtmlView Page: setting property 'MinimumX' for element 'plottingPanel'
      .setProperty("MinimumY",-10.0) // EJsS HtmlView.HtmlView Page: setting property 'MinimumY' for element 'plottingPanel'
      .setProperty("AutoScaleY",true) // EJsS HtmlView.HtmlView Page: setting property 'AutoScaleY' for element 'plottingPanel'
      .setProperty("AutoScaleX",true) // EJsS HtmlView.HtmlView Page: setting property 'AutoScaleX' for element 'plottingPanel'
      .setProperty("MaximumY",10.0) // EJsS HtmlView.HtmlView Page: setting property 'MaximumY' for element 'plottingPanel'
      .setProperty("MaximumX",10.0) // EJsS HtmlView.HtmlView Page: setting property 'MaximumX' for element 'plottingPanel'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"arrowX", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'arrowX'
      .setProperty("SizeX",5.0) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'arrowX'
      .setProperty("X",0.0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'arrowX'
      .setProperty("Y",0.0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'arrowX'
      .setProperty("SizeY",0.0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'arrowX'
      .setProperty("LineWidth",5) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'arrowX'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"arrowY", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'arrowY'
      .setProperty("SizeX",0.0) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'arrowY'
      .setProperty("X",0.0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'arrowY'
      .setProperty("Y",0.0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'arrowY'
      .setProperty("SizeY",5.0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'arrowY'
      .setProperty("LineWidth",2) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'arrowY'
      ;

    _view._9(EJSS_DRAWING2D.shape,"shape", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'shape'
      .setProperty("SizeX",0.5) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'shape'
      .setProperty("X",2.5) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'shape'
      .setProperty("Y",0.0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'shape'
      .setProperty("SizeY",0.5) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'shape'
      ;

    _view._9(EJSS_DRAWING2D.group,"group", _view.plottingPanel) // EJsS HtmlView.HtmlView Page: declaration of element 'group'
      .setProperty("X",0.0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'group'
      .setProperty("Y",0.0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'group'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"arrowGx", _view.group) // EJsS HtmlView.HtmlView Page: declaration of element 'arrowGx'
      .setProperty("SizeX",5.0) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'arrowGx'
      .setProperty("X",0.0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'arrowGx'
      .setProperty("LineColor","Red") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'arrowGx'
      .setProperty("Y",0.0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'arrowGx'
      .setProperty("SizeY",0.0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'arrowGx'
      .setProperty("LineWidth",5) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'arrowGx'
      ;

    _view._9(EJSS_DRAWING2D.arrow,"arrowGy", _view.group) // EJsS HtmlView.HtmlView Page: declaration of element 'arrowGy'
      .setProperty("SizeX",0.0) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'arrowGy'
      .setProperty("X",0.0) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'arrowGy'
      .setProperty("LineColor","Red") // EJsS HtmlView.HtmlView Page: setting property 'LineColor' for element 'arrowGy'
      .setProperty("Y",0.0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'arrowGy'
      .setProperty("SizeY",5.0) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'arrowGy'
      .setProperty("LineWidth",2) // EJsS HtmlView.HtmlView Page: setting property 'LineWidth' for element 'arrowGy'
      ;

    _view._9(EJSS_DRAWING2D.shape,"shape2", _view.group) // EJsS HtmlView.HtmlView Page: declaration of element 'shape2'
      .setProperty("FillColor","Black") // EJsS HtmlView.HtmlView Page: setting property 'FillColor' for element 'shape2'
      .setProperty("SizeX",0.5) // EJsS HtmlView.HtmlView Page: setting property 'SizeX' for element 'shape2'
      .setProperty("X",2.5) // EJsS HtmlView.HtmlView Page: setting property 'X' for element 'shape2'
      .setProperty("Y",0) // EJsS HtmlView.HtmlView Page: setting property 'Y' for element 'shape2'
      .setProperty("SizeY",0.5) // EJsS HtmlView.HtmlView Page: setting property 'SizeY' for element 'shape2'
      ;

  };

  return _view;
}


//--><!]]></script>
  </head>
  <body>
    <div role="button" id="_topFrame" style="text-align:center"></div>
  <div id="metadata" class="metadata">
    <br />
    <div id="title_author">
      <hr />
      <b>Title and author:</b>
      <p>
      </p>
      <p>
 Author name
      </p>
    </div>
    <hr />
    <p></p>
    <div id="copyright_message">
      <div class="cc_left"  style="float:left">&#169; 2016, Author name.</div>
      <div class="cc_right" style="float:right">    Released under a <a rel="license" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/deed.en_US"> <img alt="Creative Commons Attribution-NonCommercial-ShareAlike" src="_ejs_library/images/cc_icon.png" /> </a> license.</div>
    </div>
  </div>
    <script type="text/javascript"><!--//--><![CDATA[//><!--
      var _model;
      window.addEventListener('load',
        function () { 
          _model =  new GroupTransform("_topFrame","_ejs_library/",null);
          if (typeof _isApp !== "undefined") _model.setRunAlways(true);
          TextResizeDetector.TARGET_ELEMENT_ID = '_topFrame';
          TextResizeDetector.USER_INIT_FUNC = function () {
            var iBase = TextResizeDetector.addEventListener(function(e,args) {
              _model._fontResized(args[0].iBase,args[0].iSize,args[0].iDelta);
              },null);
            _model._fontResized(iBase);
          };
          _model.onload();
        }, false);
      var interval = setInterval(function() {
         if(document.readyState === 'complete') {
           window.addEventListener('resize', function () { if (_model._resized) _model._resized(window.innerWidth,window.innerHeight); }, false);
           window.addEventListener('scroll', function () { if (_model._resized) _model._resized(window.innerWidth,window.innerHeight); }, false);
           var startCaptureBut = document.getElementById('startCaptureBut'); 
           var stopCaptureBut = document.getElementById('stopCaptureBut'); 
           var resetCaptureBut = document.getElementById('resetCaptureBut'); 
           var playCaptureBut = document.getElementById('playCaptureBut'); 
           var stepCaptureBut = document.getElementById('stepCaptureBut'); 
           if (startCaptureBut) {
             startCaptureBut.onclick = function() {
               _model.startCapture();
             };
             stopCaptureBut.onclick = function() {
               _model.saveText('recording','rec',JSON.stringify(_model.stopCapture()));
             };
             resetCaptureBut.onclick = function() {
               _model.resetCapture();
             };
             playCaptureBut.onclick = function() {
               _model.readText(null,'.rec',function(content){
               _model.playCapture(JSON.parse(content),function(){startCaptureBut.disabled=false; playCaptureBut.disabled=false; stepCaptureBut.disabled=false; window.alert(end_reproduction_message);});               });
             };
             stepCaptureBut.onchange= function() {
               var stepCapt;
               if (stepCaptureBut.value >= 0) stepCapt =  stepCaptureBut.value + 1;
               else stepCapt = 1 + 1.8*stepCaptureBut.value/8;
               _model.changeCaptureStep(stepCapt);
             };
           }
           clearInterval(interval);
         };
      }, 200)
    //--><!]]></script>
  </body>
</html>
